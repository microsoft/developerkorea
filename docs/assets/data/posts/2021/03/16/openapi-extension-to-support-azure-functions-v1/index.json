{"hash":"5d8b13f4aab7386c81b63726bc5adf05aa6fe02c","data":{"blog":{"title":"애저 펑션 프록시 기능을 이용한 Open API 확장 기능 하위 호환성 유지하기","path":"/posts/2021/03/16/openapi-extension-to-support-azure-functions-v1/","image":"https://sa0blogs.blob.core.windows.net/aliencube/2020/11/openapi-extension-to-support-azure-functions-v1-00.png","image_caption":"애저 펑션 v1 런타임과 Open API","description":"이 포스트에서는 애저 펑션의 Open API 확장 기능이 직접 지원하지 않는 v1 런타임을 애저 펑션의 프록시 기능을 이용해서 지원할 수 있는 방법에 대해 알아봅니다.","content":"<p><a href=\"/developerkorea/posts/2021/03/09/enabling-openapi-on-azure-functions/\">지난 포스트</a>에서 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-20715-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>에 데코레이터를 추가해서 Open API 문서를 자동으로 생성하는 Open API 확장 기능과 관련한 <a href=\"https://github.com/Azure/azure-functions-openapi-extension\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">오픈 소스</a> 프로젝트와 <a href=\"https://www.nuget.org/packages/Microsoft.Azure.WebJobs.Extensions.OpenApi/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NuGet 라이브러리</a>를 소개했습니다. 이 라이브러리는 현재 애저 펑션 런타임 버전 v2 부터 지원합니다. 하지만, 실제 현업에서는 여전히 여러 이유로 v1 런타임을 사용하는 곳도 많습니다. 그렇다면 이런 경우에는 이 확장 기능을 사용할 수 없는 걸까요? 그럴 수도 있고 아닐 수도 있습니다. Open API 확장 기능을 직접 v1 런타임에 적용시킬 수는 없지만, <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-proxies?WT.mc_id=dotnet-20715-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션 프록시 기능</a>을 이용하면 가능한데요, 이 포스트에서는 이 트릭에 대해 알아보기로 하겠습니다.</p>\n<h2 id=\"레거시-애저-펑션\"><a href=\"#%EB%A0%88%EA%B1%B0%EC%8B%9C-%EC%95%A0%EC%A0%80-%ED%8E%91%EC%85%98\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>레거시 애저 펑션</h2>\n<p>레거시 엔터프라이즈 애플리케이션의 경우에는 참조 라이브러리 의존성 때문에 v1 런타임으로만 애저 펑션을 구성해야 하는 경우가 왕왕 있습니다. 여기 레거시 애저 펑션 엔드포인트가 아래와 같은 형태로 구성되어 있다고 가정하겠습니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist106359313\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-01-v1-legacy-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">namespace</span> <span class=\"pl-en\">MyV1LegacyFunctionApp</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">LoremIpsumHttpTrigger</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">        [<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>LoremIpsumHttpTrigger<span class=\"pl-pds\">&quot;</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">HttpResponseMessage</span>&gt; <span class=\"pl-en\">Run</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">            [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Function</span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>GET<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>lorem/ipsum<span class=\"pl-pds\">&quot;</span></span>)] <span class=\"pl-k\">HttpRequestMessage</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">var</span> <span class=\"pl-en\">content</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">MyReturnObject</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">var</span> <span class=\"pl-en\">result</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">req</span>.<span class=\"pl-en\">CreateResponse</span>(<span class=\"pl-smi\">HttpStatusCode</span>.<span class=\"pl-smi\">OK</span>, <span class=\"pl-smi\">content</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">return</span> <span class=\"pl-k\">await</span> <span class=\"pl-smi\">Task</span>.<span class=\"pl-en\">FromResult</span>(<span class=\"pl-smi\">result</span>).<span class=\"pl-en\">ConfigureAwait</span>(<span class=\"pl-c1\">false</span>);        }</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC15\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-v1-legacy-cs-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-01-v1-legacy-cs-LC16\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2b0b286bbe3e727e17423047cd97f86e/raw/d11ea6564f2ca25c055ffdb6f329688b8502c961/01-v1-legacy.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2b0b286bbe3e727e17423047cd97f86e#file-01-v1-legacy-cs\">01-v1-legacy.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>애저 펑션 런타임 v1의 경우, <a href=\"https://www.nuget.org/packages/Newtonsoft.Json/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Newtonsoft.Json</a> 버전 9.0.1에 고정되어 있고, 이를 변경하기가 굉장히 어렵습니다. 그런데, 예를 들어 이 <code class=\"language-text\">MyReturnObject</code> 클라스가 Newtonsoft.Json 버전 10.0.1 이상에 대한 의존성을 갖고 있다면, 이 경우에는 이 <a href=\"https://github.com/Azure/azure-functions-openapi-extension\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Open API 확장 기능 라이브러리</a>를 사용할 수 없겠지요?</p>\n<h2 id=\"open-api-문서-정의용-애저-펑션-만들기\"><a href=\"#open-api-%EB%AC%B8%EC%84%9C-%EC%A0%95%EC%9D%98%EC%9A%A9-%EC%95%A0%EC%A0%80-%ED%8E%91%EC%85%98-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Open API 문서 정의용 애저 펑션 만들기</h2>\n<p>이런 경우에는 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-proxies?WT.mc_id=dotnet-20715-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션 프록시 기능</a>으로 한 번 감싸주면 완벽하지는 않더라도 동일한 개발자 경험을 제공함으로써 문제를 해결할 수 있습니다. 먼저 Open API 정의용 애저 펑션을 v3 런타임으로 아래와 같이 만들어 보겠습니다. 펑션 앱 이름은 <code class=\"language-text\">MyV1ProxyFunctionApp</code>으로 두고 (line #1), 기본적으로 모든 펑션 기능은 레거시 v1 앱과 동일하게 작성합니다 (line #3-7). 하지만, 이 펑션은 그저 프록시 용도이므로 실제 펑션이 하는 일은 없으니 간단하게 OK 결과만 반환하게끔 설정합니다 (line #10).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist106359313\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-v1-proxy-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-02-v1-proxy-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-v1-proxy-cs-LC1\" class=\"blob-code blob-code-inner js-file-line highlighted\"><span class=\"pl-k\">namespace</span> <span class=\"pl-en\">MyV1ProxyFunctionApp</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-02-v1-proxy-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-02-v1-proxy-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-v1-proxy-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-02-v1-proxy-cs-LC3\" class=\"blob-code blob-code-inner js-file-line highlighted\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">LoremIpsumHttpTrigger</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-02-v1-proxy-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-02-v1-proxy-cs-LC4\" class=\"blob-code blob-code-inner js-file-line highlighted\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-v1-proxy-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-02-v1-proxy-cs-LC5\" class=\"blob-code blob-code-inner js-file-line highlighted\">        [<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>LoremIpsumHttpTrigger<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-v1-proxy-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-02-v1-proxy-cs-LC6\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">Run</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-v1-proxy-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-02-v1-proxy-cs-LC7\" class=\"blob-code blob-code-inner js-file-line highlighted\">            [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Function</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>GET<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>lorem/ipsum<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-v1-proxy-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-02-v1-proxy-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-v1-proxy-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-02-v1-proxy-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-v1-proxy-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-02-v1-proxy-cs-LC10\" class=\"blob-code blob-code-inner js-file-line highlighted\">            <span class=\"pl-k\">return</span> <span class=\"pl-k\">await</span> <span class=\"pl-smi\">Task</span>.<span class=\"pl-en\">FromResult</span>(<span class=\"pl-k\">new</span> <span class=\"pl-k\">OkResult</span>()).<span class=\"pl-en\">ConfigureAwait</span>(<span class=\"pl-c1\">false</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-v1-proxy-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-02-v1-proxy-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-v1-proxy-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-02-v1-proxy-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-v1-proxy-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-02-v1-proxy-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2b0b286bbe3e727e17423047cd97f86e/raw/d11ea6564f2ca25c055ffdb6f329688b8502c961/02-v1-proxy.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2b0b286bbe3e727e17423047cd97f86e#file-02-v1-proxy-cs\">02-v1-proxy.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>이제 Open API 확장 기능 라이브러리를 설치했다면, 데코레이터를 추가할 차례입니다. 아래와 같이 <code class=\"language-text\">FunctionName(...)</code> 데코레이터 위에 Open API 메타데이터 관련 데코레이터를 추가합니다 (line #5-9).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist106359313\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-03-v1-proxy-openapi-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">namespace</span> <span class=\"pl-en\">MyV1ProxyFunctionApp</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">LoremIpsumHttpTrigger</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC5\" class=\"blob-code blob-code-inner js-file-line highlighted\">        [<span class=\"pl-k\">OpenApiOperation</span>(<span class=\"pl-smi\">operationId</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>getIpsum<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">tags</span>: <span class=\"pl-k\">new</span>[] { <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>ipsum<span class=\"pl-pds\">\"</span></span> }, <span class=\"pl-en\">Summary</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Gets Ipsum from Lorem<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>This gets Ipsum from Lorem.<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Visibility</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">OpenApiVisibilityType</span>.<span class=\"pl-smi\">Important</span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC6\" class=\"blob-code blob-code-inner js-file-line highlighted\">        [<span class=\"pl-k\">OpenApiParameter</span>(<span class=\"pl-smi\">name</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">In</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">ParameterLocation</span>.<span class=\"pl-smi\">Query</span>, <span class=\"pl-en\">Required</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">true</span>, <span class=\"pl-en\">Type</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">typeof</span>(<span class=\"pl-k\">string</span>), <span class=\"pl-en\">Summary</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Lorem name<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Lorem name<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Visibility</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">OpenApiVisibilityType</span>.<span class=\"pl-smi\">Important</span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC7\" class=\"blob-code blob-code-inner js-file-line highlighted\">        [<span class=\"pl-k\">OpenApiResponseWithBody</span>(<span class=\"pl-smi\">statusCode</span>: <span class=\"pl-smi\">HttpStatusCode</span>.<span class=\"pl-smi\">OK</span>, <span class=\"pl-smi\">contentType</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>application/json<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">bodyType</span>: <span class=\"pl-k\">typeof</span>(<span class=\"pl-k\">MyReturnObject</span>), <span class=\"pl-en\">Summary</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>The Ipsum response<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>This returns the Ipsum response<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC8\" class=\"blob-code blob-code-inner js-file-line highlighted\">        [<span class=\"pl-k\">OpenApiResponseWithoutBody</span>(<span class=\"pl-smi\">statusCode</span>: <span class=\"pl-smi\">HttpStatusCode</span>.<span class=\"pl-smi\">NotFound</span>, <span class=\"pl-en\">Summary</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Name not found<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Name parameter is not found<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC9\" class=\"blob-code blob-code-inner js-file-line highlighted\">        [<span class=\"pl-k\">OpenApiResponseWithoutBody</span>(<span class=\"pl-smi\">statusCode</span>: <span class=\"pl-smi\">HttpStatusCode</span>.<span class=\"pl-smi\">BadRequest</span>, <span class=\"pl-en\">Summary</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Invalid Lorem<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Lorem is not valid<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">        [<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>LoremIpsumHttpTrigger<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">Run</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">            [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Function</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>GET<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>lorem/ipsum<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC15\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC16\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">return</span> <span class=\"pl-k\">await</span> <span class=\"pl-smi\">Task</span>.<span class=\"pl-en\">FromResult</span>(<span class=\"pl-k\">new</span> <span class=\"pl-k\">OkResult</span>()).<span class=\"pl-en\">ConfigureAwait</span>(<span class=\"pl-c1\">false</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC17\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC18\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-v1-proxy-openapi-cs-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-03-v1-proxy-openapi-cs-LC19\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2b0b286bbe3e727e17423047cd97f86e/raw/d11ea6564f2ca25c055ffdb6f329688b8502c961/03-v1-proxy-openapi.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2b0b286bbe3e727e17423047cd97f86e#file-03-v1-proxy-openapi-cs\">03-v1-proxy-openapi.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>여기까지 하고 이 프록시 애저 펑션 앱을 실행시키면 성공적으로 Swagger UI 화면을 볼 수 있습니다. 하지만, 이 앱은 Swagger UI 화면만 보여줄 뿐 실제로 동작하는 화면은 아니므로 추가로 작업을 해 줄 것이 있습니다. 바로 프록시 기능이죠.</p>\n<h2 id=\"레거시-애저-펑션-프록시-추가하기\"><a href=\"#%EB%A0%88%EA%B1%B0%EC%8B%9C-%EC%95%A0%EC%A0%80-%ED%8E%91%EC%85%98-%ED%94%84%EB%A1%9D%EC%8B%9C-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>레거시 애저 펑션 프록시 추가하기</h2>\n<p>아래와 같이 <code class=\"language-text\">proxies.json</code> 파일을 프로젝트 루트 폴더에 만듭니다. 레거시 펑션과 프록시 펑션은 동일한 엔드포인트를 갖게끔 만들어 놨기 때문에 (line #6, 11) 사용자 입장에서는 마치 웹서버가 바뀌는 정도의 차이만 느낄 뿐 개발 경험은 동일하게 유지할 수 있습니다. 또한 쿼리스트링과 요청 헤더 역시도 동일하게 레거시 펑션 앱으로 전달합니다 (line #13-14).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist106359313\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-04-proxies-json\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-json  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-04-proxies-json-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-04-proxies-json-LC1\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-04-proxies-json-LC2\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>$schema<span class=\"pl-pds\">\"</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>http://json.schemastore.org/proxies<span class=\"pl-pds\">\"</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-04-proxies-json-LC3\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>proxies<span class=\"pl-pds\">\"</span></span>: {</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-04-proxies-json-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>LoremIpsumHttpTriggerProxy<span class=\"pl-pds\">\"</span></span>: {</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-04-proxies-json-LC5\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>matchCondition<span class=\"pl-pds\">\"</span></span>: {</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-04-proxies-json-LC6\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>route<span class=\"pl-pds\">\"</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/api/lorem/ipsum<span class=\"pl-pds\">\"</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-04-proxies-json-LC7\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>methods<span class=\"pl-pds\">\"</span></span>: [</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-04-proxies-json-LC8\" class=\"blob-code blob-code-inner js-file-line\">          <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>GET<span class=\"pl-pds\">\"</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-04-proxies-json-LC9\" class=\"blob-code blob-code-inner js-file-line\">        ]</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-04-proxies-json-LC10\" class=\"blob-code blob-code-inner js-file-line\">      },</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-04-proxies-json-LC11\" class=\"blob-code blob-code-inner js-file-line highlighted\">      <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>backendUri<span class=\"pl-pds\">\"</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>https://mylegacyfunctionapp.azurewebsites.net/api/lorem/ipsum<span class=\"pl-pds\">\"</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-04-proxies-json-LC12\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>requestOverrides<span class=\"pl-pds\">\"</span></span>: {</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-04-proxies-json-LC13\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>backend.request.headers<span class=\"pl-pds\">\"</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>{request.headers}<span class=\"pl-pds\">\"</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-04-proxies-json-LC14\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>backend.request.querystring<span class=\"pl-pds\">\"</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>{request.querystring}<span class=\"pl-pds\">\"</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-04-proxies-json-LC15\" class=\"blob-code blob-code-inner js-file-line\">      }</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-04-proxies-json-LC16\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-04-proxies-json-LC17\" class=\"blob-code blob-code-inner js-file-line\">  }</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-proxies-json-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-04-proxies-json-LC18\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2b0b286bbe3e727e17423047cd97f86e/raw/d11ea6564f2ca25c055ffdb6f329688b8502c961/04-proxies.json\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2b0b286bbe3e727e17423047cd97f86e#file-04-proxies-json\">04-proxies.json</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>프록시 펑션을 배포할 때 이 <code class=\"language-text\">proxies.json</code> 파일도 함께 배포해야 하므로 아래와 같이 <code class=\"language-text\">.csproj</code> 파일을 수정해 줍니다 (line #10-12).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist106359313\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-v1-proxy-csproj\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-xml  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-05-v1-proxy-csproj-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC1\" class=\"blob-code blob-code-inner js-file-line\">&lt;<span class=\"pl-ent\">Project</span> <span class=\"pl-e\">Sdk</span>=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Microsoft.NET.Sdk<span class=\"pl-pds\">\"</span></span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC2\" class=\"blob-code blob-code-inner js-file-line\">  &lt;<span class=\"pl-ent\">PropertyGroup</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC3\" class=\"blob-code blob-code-inner js-file-line\">    &lt;<span class=\"pl-ent\">TargetFramework</span>&gt;netcoreapp3.1&lt;/<span class=\"pl-ent\">TargetFramework</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC4\" class=\"blob-code blob-code-inner js-file-line\">    &lt;<span class=\"pl-ent\">AzureFunctionsVersion</span>&gt;v3&lt;/<span class=\"pl-ent\">AzureFunctionsVersion</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC5\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC6\" class=\"blob-code blob-code-inner js-file-line\">  &lt;/<span class=\"pl-ent\">PropertyGroup</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC7\" class=\"blob-code blob-code-inner js-file-line\">  ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC8\" class=\"blob-code blob-code-inner js-file-line\">  &lt;<span class=\"pl-ent\">ItemGroup</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC9\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC10\" class=\"blob-code blob-code-inner js-file-line highlighted\">    &lt;<span class=\"pl-ent\">None</span> <span class=\"pl-e\">Update</span>=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>proxies.json<span class=\"pl-pds\">\"</span></span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC11\" class=\"blob-code blob-code-inner js-file-line highlighted\">      &lt;<span class=\"pl-ent\">CopyToOutputDirectory</span>&gt;PreserveNewest&lt;/<span class=\"pl-ent\">CopyToOutputDirectory</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC12\" class=\"blob-code blob-code-inner js-file-line highlighted\">    &lt;/<span class=\"pl-ent\">None</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC13\" class=\"blob-code blob-code-inner js-file-line\">  &lt;/<span class=\"pl-ent\">ItemGroup</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC14\" class=\"blob-code blob-code-inner js-file-line\">  ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-v1-proxy-csproj-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-05-v1-proxy-csproj-LC15\" class=\"blob-code blob-code-inner js-file-line\">&lt;/<span class=\"pl-ent\">Project</span>&gt;</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2b0b286bbe3e727e17423047cd97f86e/raw/d11ea6564f2ca25c055ffdb6f329688b8502c961/05-v1-proxy.csproj\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2b0b286bbe3e727e17423047cd97f86e#file-05-v1-proxy-csproj\">05-v1-proxy.csproj</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>이렇게 한 후 이 프록시 펑션을 로컬에서 실행시켜 보거나 애저로 배포한 후 프록시 API 엔드포인트로 접속해 볼까요? 이제 원하는 Open API 문서도 생성할 수도 있고, 실제 레거시 API도 프록시를 통해 실행시킬 수도 있습니다.</p>\n<br/>\n<hr>\n<p>지금까지 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-proxies?WT.mc_id=dotnet-20715-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션 프록시</a> 기능을 이용해서 v1 런타임으로만 구성 가능한 레거시 애저 펑션에 <a href=\"https://github.com/Azure/azure-functions-openapi-extension\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Open API 확장 기능</a>을 구현하는 방법에 대해 알아 보았습니다. 이 방법의 단점이라면 레거시 API를 한 번 호출할 때 프록시를 거쳐가므로 비용이 두 배로 들어간다는 것인데, 이 부분은 실제 엔터프라이즈 애플리케이션 아키텍팅의 관점에서 신중히 결정해서 결정하시면 됩니다.</p>\n<h2 id=\"더-궁금하다면\"><a href=\"#%EB%8D%94-%EA%B6%81%EA%B8%88%ED%95%98%EB%8B%A4%EB%A9%B4\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>더 궁금하다면...</h2>\n<ul>\n<li>애저 클라우드에 관심이 있으신가요? ➡️ <a href=\"https://azure.microsoft.com/ko-kr/free/?WT.mc_id=dotnet-20715-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">무료 애저 계정 생성하기</a></li>\n<li>애저 클라우드 무료 온라인 강의 코스를 들어 보세요! ➡️ <a href=\"https://docs.microsoft.com/ko-kr/learn/?WT.mc_id=dotnet-20715-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Learn</a></li>\n<li>마이크로소프트 개발자 유튜브 채널 ➡️ <a href=\"https://www.youtube.com/channel/UCdgR-b2t7Byu_UGrHnu-T0g\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Developer Korea</a></li>\n</ul>\n","humanTime":"16 March 2021","datetime":"Tue Mar 16 2021 12:00:00 UTC+00:00","canonical_url":"https://blog.aliencube.org/ko/2020/11/11/openapi-extension-to-support-azure-functions-v1/","timeToRead":7,"tags":[{"id":"azure-functions","title":"azure-functions","path":"/tags/azure-functions/"},{"id":"azure-functions-proxy","title":"azure-functions-proxy","path":"/tags/azure-functions-proxy/"},{"id":"openapi","title":"openapi","path":"/tags/openapi/"},{"id":"backward-compatibility","title":"backward-compatibility","path":"/tags/backward-compatibility/"}],"category":{"id":"Azure","title":"Azure","path":"/categories/azure/","belongsTo":{"totalCount":11,"edges":[{"node":{"title":"애저 Bicep 되짚어보기","path":"/posts/2021/04/27/bicep-refreshed/"}},{"node":{"title":"애저 펑션 프록시 기능을 이용한 Open API 확장 기능 하위 호환성 유지하기","path":"/posts/2021/03/16/openapi-extension-to-support-azure-functions-v1/"}},{"node":{"title":"애저 펑션에 Open API 활성화 시키기","path":"/posts/2021/03/09/enabling-openapi-on-azure-functions/"}},{"node":{"title":"이벤트 기반 애저 키 저장소 시크릿 로테이션 관리","path":"/posts/2021/03/02/event-driven-keyvault-secrets-rotation-management/"}}]}},"author":[{"id":"justin-yoo","name":"유저스틴","image":{"type":"image","mimeType":"image/png","src":"/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png","size":{"width":500,"height":500},"sizes":"(max-width: 500px) 100vw, 500px","srcset":["/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png 500w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 500 500' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-6a0325b746fa0b3948747e4a6f689de9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-6a0325b746fa0b3948747e4a6f689de9)' width='500' height='500' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC%2baJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVRo3pWZd1RT67b2ueccy7YgHQKE0HsvYkdFsaFYEKUI0nsnlPSEhBI6offeISgdpPeQ0JFi3%2bfse84Yt/x3v7%2b/udaCiLq3d9893rH2Soz4/J75zPm%2bK0jMz68sLq4tLa0LhVvLy9srK7tra%2b/Ea339/fr6h0Pr459Za2sfflyrq%2b/R9W5lZW95eVck2hGJtoWwlt4Kl7YEgk3B4oZgYWNxfm1hfm1%2bbmVudnl2RjgzvTQ9JZiaXJwYnx8fmxsbnR59M/VmZHJ4aHxocGyg/43E7KxoYWFtEf6yYFMofLu8vLO6undIPQKwsYGtTxsbH9H1CVugFbv%2bEcNhmAOA9ysr%2bwzLwm0RLATg7ZJga2lxEwVYX5j7HYDJiYWJcQCYAYCR4QkAGBwYRQBmZoTz86sLC%2bvAAADgCgBg0lHR2FWs%2b8NhgMMkf6YO3wCIdpdFCAD8o0tLW8hCAUAJCrA6PwcAIgCYmRYDzI%2bNzmIVAIb9CgDAHHx6HgGAnwIAWIpQ48WW/47oP2L4Qes7uPnxTQRAiKYIAxBsIgCLKMB%2bhEQ/VAADmP4mQtPTwtnZFWCAvwk/CH4cBnBY9%2bbmZ/T6M4ADie/gw7u7v%2b3t/fv29j/evfsn3Ozs/AZgIF0kgujvIgDLSAWQNhAiPXAAsLEIFYAegArMrs7NrmAV%2bBZgDgP4WoHx8YWpKYRhfn4N2kBcASz0IBpdn7HrH6kHcTs7/4C1t/fPmZnVzs7%2bxERaRHhMZERscFB4R0cvqAS58Ke7u/8OACLE%2b10hLAAQHDQx0gAYwCoCMLPyuxWANvimAqOjc5OTSwAAFTgE8B6z/xDA55%2bE5/Pn/%2bofmLK/ftPN1cPh5m0pyVOy0lLysjLSZ87ISksrKSiYGJmctbF95uKal1O4urK3ufVFKNwRLu3nRyhAABaRCiANcNDEfxQhAIA%2bPgAYn1iYmRGB/Yd7AG2Aj/%2bremwKra19rK5uuXL56i/HjkqePIFIl5ORg/9JSkqePi156uSpEyeP/O1vf/nLv0lISMhISz9%2b5NzSzN/Z/vvmxuclGEECFGBxc2FxHRtBUAHU/p/1wFcArInF6rExinUwqv5/wXi3908ul6evoycvI62moqyGV1FTVVFSkMMpKSgpIjVQVJBXUkTupM5ISkvB5fQvx49rENSfI9UogmqA90uo/Wj7rs8jHbyKzlCsAZamJg/vA1gFJr%2bOUdjFBIKv3qObwOH8fDxg%2bHx4YfZDpqOjE1SUFPE4JXW8ihZBTVdLw0BHSwOvoqmmqqmmoq6KwysrAg9ccYoKCvKysIDqxC/Hjx7566kTv2SkZ29ufATFSAMsiNVDBZZnp0UzU1/tB/UHANPYPrBfAWz/Ent/aIB%2bB/ANA0wbaMem5ld6unog10BXRx90q6nqa6pdtja%2bYWty46zR3QtmD%2b0s7cx17cx1zhtpauNxyggJDhjOSJ6CjP1y7Mjtm7dGhqfWoA6Lm0h%2b9gFW5iA/06LpKaE4PBjAQQMgIwgq0N83IoGdIA7UY/vux9%2brwKfD9m9tfREt7121u66BV9XX1jLS0bA21HK5aUv2f5gW4VJAdK2keFWRX1QnuWUF3MsLvMvxvuVlb37ZmKBPUFaSl4UmgTqcPnnizOmTgESMjYdBhPTu/BqqHhpgeWZaiNovENuPqv86Q/cjBOoPjH9/kOyPh8z%2bPjzIgui/%2b1dMTCJeWUlbg2Brqh/j6sAjutaz/GZqSXM1CbPlsbOlMeO80MEMPz7dvTXRpSXBpSz4Dv2JrccVAzMNJVVFOXlZGFGAcPzUyROmJiaTE4uwCczNYvavzCD2L00j6vfTP4ocImZGhsX5QdQjFTh0avi6bf1kwQd2d36LjCTiVZS11NVNdQgcP8e%2bzOCxkti5OspaR8pmV6qonjJTGD6ZHzIMALTnnTRXPtWtOfZR4ctrDCcrzwtaVurymorS8lKSp0%2bdgAUDi0ljra2%2bm5leRuyfXp6ZQgCmJgTi/GD2Q96Gh77ajwAcHNSwufn55wDQuLC58rtHFOTkVJUUYeyEPrwynBW0WJe4wU/b7c//MFLyYaRs61WWsJY0XRA%2bnhPYz3nZx3k5kObbRXWrCXVkP7SKvKb3yAx3QUNWT0laRvIk/Hf0yN9winItzZ2w34F0dP5A%2bpfE9ovH//DQ1y0M1Pf1DiEAm5sf0Ov%2bYeEnAHBY%2bPT5P5nMdGnJU1oa6udNdcuIz0YLI9Y6OO%2bGC98PFX8YKf80Vv32dZ6wjjpdHDmRHzKWGzyaEzTE9eNTXGtD7qU8sk64Zex7XuO%2bsdI1HUVteaQIUlJSsEU43b%2b/ItqZnoThA0v43fA5sH9c3L6wenv2AT4ebFuff74QgE//ERwcKS8jpaul%2beT62epEt4mS%2bJ3%2bvHeDRR9Hyj6%2bqfgwUrnawp3ixUzyIt9kBY7lBI3nhw2kercSHxd5XmU6msc7GEZc03M2V7ljqHSOIIOTkTxzRvKvf/k3C3Mz5PwzvYzaD%2bERHLYf1I8MTw4Nfk1/X%2b9wz%2btBiR%2bPDD9JP3wYpqez83MAMDMy8HS0q6F6CZtT3o%2bUQ3I%2bjVa8Gyxea09bqqdPFccOpgcNpAUOZwSM5YWOZAZ0JroUelxhOprF2utHXtd/bom/a6h4UUNWXf6MtLTU8WPHYK/jd/QIFjYhPOL2PQgPZv/k4IA4PMNg/%2btXAxIHTypfw/Pd/WGAt29/nV/YsLSwUlaUP29t4XHnYh3Lf42fvdtfvDdUujtQsMHPWO/K3uDnLbekjuaE93P8Bzg%2bQ9yACV5kf6pvbdh9jpN1zHV9v4uartZqd4wUoRM0FaRkzpw%2bdeokHDXYTM7K8g54P4XYv392EKsH%2bwf69%2b0H9WIA8Vn/o/jkfHgd7mA4J3e/GlFVweNVcBesLV7cvdyREbHGz1zryhI0ssfLSXMNKW%2bHanfH27aH67f6yuer6RO8qMki4mwlZao0qZvlVxbygP7knNcFbSdTFQd9pfPqMuoKUrCxnT55EtrA7bkbbKkT44tTB/kZfbMPMDQ48aP9r7r7JX58WPmO4TDA%2b/f/amrqxquqahLULE0MA584TFSQ1zvT5moZVWTf3ES/FKI/O9q3hBHekh4z15q3O1Inaslcak6fr%2bc0swJpnne875xzuWjkaK11SRd3RVvhIkFGTfY0jNMzp08DwDNnF9jREO%2bR9kUADoVn/Dv1sLr5fRJ/5mlLfPiB/au%2boVNZSRFmqK6aCsvHca2VtdTArE3yzIv2KGVF8mjBmfFeVazA5rTQN1WsD%2bPNi3XcocyI/uzItID7L25anTfSstAlWOuqWGspWRIULqnL6cufQrZkSQTgsdNDOFBg4Tk8fLDw9Pe9wdRD72L287t6v%2bmBny8YQfB41dk5gFeB85vSbRuDfo7XWkPSXEkMn%2b03Uc0WdBSI2nNmyknD2RHCZs7eUPHOQOlsOb2N%2bKw%2b5klxqGNJ6P02lncT1Yvz4prbeW1rgqytuoINTlLu9C8AAKftB46OS4INUC9u34OdCwP4JjxgPwJwcPj59Geeerff/n1yUmRqbKKqpEBztx9M8elIDapPi%2bFRgkqZoU3ZCUW0QLKXY%2bT9i0muN3lEj4lyyigvttDbnnjLNOK2RaqvYz7RnRv4MOG%2bjaMZ/qy6rA1e9gpBVl/u1LGjR6ECZ62t4IELdgDx9MR6F0s/NjcPq%2b/q7JEQnz3/DABMoZmZFUsrG2sr67iIKJdHD8lkMinUtZbhPt5A6SwnpjKC7lw/63JOn%2bV8sY7sXptHD/d/qa0ko6Uk8%2bCKsf8TO1tTQx2crIOZxh1jVRsNBRtdvJmmsh5OTk9LE4dT1lQndHW8hscAkH5gP5b%2b0R%2b9B/WdHa//DwBooT4vi3Zi3V1unLPKjg%2bK9XMtzM/IjXtcS3rUkh3UWhjdUUSLe37L/5Jh2rPLizXxbEq03w3bR2d1jLXwvi5XWZHOSe73Aq%2bbudho2mvLPjHHXdZSvH/HQVlV%2bemjx1cv2cXFJmC77%2bHhM9A/hs1NsB9T381H1MPqaH%2bFHeY%2b/lmAzS%2bby9vtRN%2bYl8/aqd4zuaEtueT6jLDenMCBwoiZGnIfN6wm4nGe142BrJCewthAt3uThbF1sU/PWxi%2beHCH/sIh2%2btGuutl8j3zoKu6z6zwDgbKMaFBRjrqevD0Iy/d0dwBz2Lf2d/fN9rbsx8eTD2/C9S/7ux41dHevQ8gXoe/4fkRYB15Evj8piCd4vu8Ls59Ni%2b8IyOmkB6w1Zu68TpjujC2j%2bU7xA2eLYl735PZW5CYHeP%2b6wivIc7ZUlP5qZV26mObQp8bPG/7TNdL6c5nI67pP7HWJYYF2hmoEc6ceHDdbnpiYWx0Htt6xer7ekd6Xg%2bJxw6WHPC%2bva27rZUvgX0B%2bLvr9763%2brCx/dvqYF9ugDMv6NFcQbSwMaWCFd5dQBR05k1Xs0aLk0Z48T2ZkV1ZUTBS5%2bqZv46WvKJ5XNaQdzDC5b%2b8Wh/u1BDq1BjxsMTnZuxNk9D7l72fPzqLl9eSOc2IjV0UbMKR880I1rvIzgWjE7P/sHrM%2b/Y2fmtLl4T4S8yfYHzzcvPXLdHGQk16M8V3pjBmqzP9w0jNSHVWRy61jh1ZQfKrogZUkXzqGMHTVWQo1peJqvGccD9bdQcDpYcWmmF3banP7CnOVxMeX/G/ddb5hu0lXeXrBoSzSlLF6dy5%2bfU3w1Ni%2byH9qP374QGAw%2brbWrtamjskfvwG8%2bckG3AmXdnbbM4dSQ%2bf4EWvNjHfD5X818rgfy4Pfhqq3mhOncgMmcqJ2ONnrzeytruz/jHTNF%2baFH/DmHzP4oUZ/pmJckOSVx3Rg%2bd9l/LA9omZqp2GrJ2ump2mcldzx9SUCIn%2b/sFhP/2vX%2b3bjyUH1ENywPvWls7mpvb/A8Chbz8/rtRnD6WFjOVHCuuS3nZnfh5r%2bm2h7%2bObhn6aT4nndVFz5l5vycehmo/Ddf8SdK%2b1pFDvWXrZaDjpyvvZELrInvNlpCGWT5GnvbsV4SJB9rK2spOlwfDA6PjowuHe7et9A%2bnHJg8WHsg9mpxOTH1TY5sE9oXrjwx/TPJhbePLRl/LXAV5gBu4WB632sx611v4abxpoYJR7HFtror%2bZaJxg18yVZM2Us4Z4hGro12czVWvass4GePCLuvme9j3p4b00l%2bmPbZ5ZIw7T5C5gJcJcLwBp%2biDU%2bcEGh5Qj9iPqT/oWsR4SA6mvqG%2bFQDe/QjwY0EO7j%2bsw83W3zdHh%2baLk7rZvnOlUYtVCauN9M2u3PqopwO5sWs9JaKuomV%2b0UIHb6YxvSMlqCzejeNxJdHJOuquBZxDo29bcN2v8Ske7IeWt3TlzqvL2SidDna6PTUjGtrvXSw8I69fDXXzB7DwYDMHNR5R39jQ1tjQWl/XLCH%2bvYN4/QQGWavv1ze/rM4uzZcyu5kvp4oiFmsThXXk2UpySfC9ifqUxbac7aGa3ZH6vdHmrd6q2VLmeD7pFellzvOrjEfnwm4YBdobh9obt5FcYZje0pO3xUvbG2qU5/ImJgSYerAf1IP9r7q/2o/lHrxvakTUN9S3gPq62iaJ1ZX3PzL8iLH6LcPa5hfR%2bFh3sv9YXthSA2WllTFdEtdO9x4sSqhJcO/NS1xqylmozVqsyZkvy3ydFMJ7cYf51M7rnO49feW4u9apntd70oKyXtg56MlbKhxnxMbMzW8MDkwM7u%2b7o2h4EPu7OvftR9V3HqhvxdTX1jRKLKO/bsB%2bDfFHACvwzg91WNv8e28RG556RY2MxbqkmZLY0fwoflpgpudtXtSLjaHq91NNnwT8X9dHREM19Rkx6ZHPbxjinxhplAY4tbF8BnMiom%2bZ2evKnsefqS6pmJgUDgyg4enHehexn9/V39mB2I%2bph/B8p76muv4bABC6jF7FDMh19QP2R9/%2bsujd5vZvo%2b1Nrznewkb6YiNtqoI4xosYK4pZaUvf7Sldayna6ajba2neaa5dyE9rDvAkXzIPO6eX5nyp2Mehg/GyPObJMxu1W/pyjrYmQ4OTI8MzaO%2bOH/Tuvv1o7/J/X31VfXVFrYRoeW//dz6H1o8F%2ba4yq2uA9GFhWtiZGjZZEiNsZszUJE1VJMw3MDb4Oe8GS36dbv401rbdXjOfzx5ixbSHv8h8coX2wCbH7UqR982i4HvhDiZPrPC2uON0InFmdnWgH%2bvd/fSjvYvYj02e/fCA%2btoWkF5b3QDqqyrrKstrJITLe8sog%2bhgrfwQqh95AHJr69fVjS81GQw%2bx3u8OHqsMHKiLH6xhb0GAAMlX8Zq/zHXudVfMVqe3JES2ckIqAx9WOp/p9TXIe/ldfLjs/dMcBfVTj%2b9fnF4eHp4eGZgYLL/d%2bx/Db0rtr%2b%2brqWupglTX42qryirlhCKdkUogwhdy8v7FTh83V8H6VpB1H%2bByD54%2bMTK3LQg%2bmkbw4vP8e3JCJptYKzys/cGCt8PFH0cqXo/WLfcWjjGI/fS/FojHtcG3eF5XeU8PedsTbAhSJvhTl%2b2tenpeTM0NN3fB%2bqhd5HRCenv6uzraO9ta%2b3%2bRn1t8773FbWgvry0qqykAgVA1zKKAQURruyBbgTmW4BlrETLexCh2dmVG/Y3ZGXkFHCqNJ/7dWSPGrL764zAwYLI5U7udh9vr7/gLT9rvS1P0Jg9nBUDB7hKv1sFL67QH1gEXtU/rylnhpe10cQdQb9KmZwU9va8QY894t7txUYnFh6IPqq%2bEYw/pL6ypKhcYkm0u4QCLGG/dTtEAnKxdO1f0QUf23r797KyKmVlnKKCkqqmXmtJ7nB2cEnss8pE1%2bZkn9HyxLWevPVXucL2rPnGzJm6jO7U8MrwJ/neNxMf2Phc0r5piDPFy1kR5G0I8vAY%2bfTx4/EJwevXbzD7QT1qfw9qfxe2Z4H9WNd%2bp76ooFRCINyBtQTrAGB/YQwojHihb%2b6urH2sb2q5c/c2/PO3HrrPvxlfqiGOlhBrSe7FUc5l8c/7CuNE/Jz51qyxShao56eGVsW4MFyv%2btub3DHDm6nJm%2bDlz6nJWCifgZ%2bgr6MFWe/rmxCHB%2bxvb3vd2oLkRxyemqoGLPegvrS4AlNfyCvaBxAzLB2UYgllQBoDfYl1CLyzBACr70sqKtMyODpa6m4BpLmFvaUG2tuerLlack96QE3C8/yIx/Usv56COH56UBvDp4Xuw3S76nPD/JaFlrkGzgyvYIU8y0ub4s787chRGWnJnKw8aGXwHnoXDc%2b%2b/U2NHVh4atDwVJbXHva%2bkFfMyyuQWFzaxtQLDi1QLzioydIBAKIefbm8%2bqGqpp6dlkymJDx44t00sDPbUfm2O3XzVdZcDXk4L7yF9iI32JHtfYv64maCm33A3bN3bXQvG6nbaKlYayhZ4eUuqsteVz9jpKogI6984pdjQYFBsAmAbnTywOh83dLc3dyE2d9aW9NUXVVfWYHMHEx9cWFZIa8E1Ofl5EsIAABdGMl3GN/VBAXbXl3/1NDcwU5lpnA54REhYaS81wMr4yXxG/xUUSt7pipxKCekg%2bFZFfckw%2b9WjNNZ14t6T85qO5/VvmeOv6Apf5Ygd01b3o4gaaypYWxpd/z4sWvX7MDsEShCZ39bK%2by7oJ6P2t%2bGqm%2borKirKK8pQ8ODqS/IL8rP5eVm50kIBG/FANgS/B6JEK0J/ClSB%2bFOUWlRKpedmc3lpLOJCTGMnKaGmu7elABBDWmxjjoPm1pp3Agvsj8ruI3qVhTgkOlhR3909sV5rUtaCpc15G7ryl1UlTTS1rn7NOTYseMXLtj6eHsz6GxQ/Kp7CBgaGzrq69qw8FRV1leg4cHUF/FKC/KLMfXZmTkSC4tbC4K3sBYPMSweFGRxaUewf7MNGOD99Nx6bUMjYn86m5udlpaZmsrlUKjxiawsekR4cZhTX7LPeF74dClxpjJppoY0VhjVlx7QFO9S6H/T57LeZW3cdR2F2waK51TP2JhZ%2bsdlHzl23NLSwt3D1cRY38TYIDQkrLK8DlIEGHW1Laj3teVlNaUlmPelqPcQnrycrNysjGyJ%2bcWt%2bQMG8RIc4kFeQmzWPiwKthuauxLIZBqTwmBRGWxaamZKWlZKakZqGjclOib0hZe7m9szTpR3npd9fbgjn%2bbRkxrwKtW/NyOkLy2I53fHyVLbXk/VwUDlngneWunkLfu75MxWANDV1fH197l//66M1CkFeSlrK3M3Nzc6jQXSoYmBoaS4EvG%2bAPO%2bEKKPqc9Iz5SYW9jEGMQLqQa65gXIS6FoTyDcbe/qpzGTw6PDwmPCiYmx6RkpLDYd%2bhhmEZPDgGrExEW99PHy8PKgJDOo5DiKrzPH7Xq%2b17XSkHulYQ%2byvG56nte7a0K4a6J%2bx5jgaK5hJn88LJzELuo5euwEgUAICPILCPS9fPm8vJyUkqKsJkHFyEDX/trV8LCIvJxCmJ4AwMsrQtXzxOq5aVwEAGXYPAwAC24gOaKV9/1DU9ys3KiYqMjYyERKQgKZGBYRkpaRAtKTU5ip3JTkVCY9mUahkzxfenh5v0jmMBgcFjMlmcEgF9Cj6S5XYm4aedioO5mqOJmr3zJSv22icctA5YKmYkXTGDO34%2bjx03iCZkhYUCwxsrKm%2bvad26dOHiOoKRvqaRnp6xgb6dlduRQcEASxKSmqyM1Goo%2bqz%2bKmZaSlpErMzm/AOsBAALAbaNbRcUFeYWlkTBQYT6IkJNESKQwylU4KiwimMEgZ2Wmp3GR2GgsAklMYrBRGVEyEy3NnTiorK5fLSUsGts3t7YGBfleHi/f0ZJ3MVG8b4a/pqt4yVr%2buKf3o6uWhhX%2bGkfN/OSVD0DLy9PYMjQgpKSvhFZecOX1CXl5WU13VUF/LyEAblqGBjv01u7iYuHzUfpCenoqoT2VzJGbm1jEGZC0gVzB%2bfvFtbUMbMSkBfmgCOZ5ETyLREhnJ1GQOHa7xSbGJ5HgWhw51SM1gQ5DoLAokChg8vTxiiFGZOenQ2XQWrbyyrLCs2DcwwFoHb6sqdUFd4ZoO7qa%2bsq3S0Qg//%2bmt/%2bfsFXNaGqdtdPahs3NweGhcfGx334CegY6k5ElVFSVtTTVDPU3AMDHWMzbWMzU1cHrgmMxkZ2fmprIR9SmsZAQAY8CuS8Ldnv5xTjoXAkNMiiNRE6lMMqxEajyNRU5OAQAKmZFEoiZQmSQmh5aRlZqRlQZZojHJEKrI6LCgEH%2bwH%2bpAppJoLJqX70vbc2cv29lZqCufV5W%2bpC5/TlXqmpZMfWNfIKX2%2bsNAvJbJOXvnh0%2bfhUdH%2bgb49g4O3nNyPHb0ryo4eYIaTleLAFky0NcyNdG3tDABkvO2VnExMRAhDpPNZjAlpmfXYE3NrM4tbAFARXVDbGJcFDEqkQqBIZHpiRR6EkiHGxI9kcGmMtlUeAmJpzPJcAOzKD0rlZuVAmCcNBYSsMhgOovKTmUxWJSCkmImJ%2bX2nRvefj4Xz9mYKUraqMpYyx0JdXmYWzdhae9jfe3pldvuj72T7O8%2bCokM8w3ya%2bvo8A8OOvo3CUUFWQJeSQ2P09fTMDDQMjbSNTMzsLIyRW5MDSLDwricVCaVJoGph8y8GVvMyMkF6fFIZkgUVB/YnEghUgCDmYQAJFNZHBoNqQm4S6YjHyAz2TR2CgMsh80BGBKS4pIoCXQ2HSFn0uqa2109nkVEhTk%2beGCqqmCFk7yqLpWdV%2bvgEnvJweXKHfdQcrFfXJaXf4h3gH9weEhZZUVMfPzxo3%2bRk5UiqCqpKCtqQZCgE1AAC3MjU2M9IwMtczNDfx8fDpMlgXnfwR%2bgMulxSXFUJpXKotCTYdJT6CwS%2bEqixiMA9EQqPQleQgVQZYAHH6BgVyryEopDh06A1JGpiVABeCckPKixtTMiOtLP39v5%2bTNrA10jqSMPzls9D6CbnX943z3WLzYrs%2bpNLKskr6CQSCYHhQfn8PKoLOaJX47ISkuqqSiqKMsTCMp6uppGhjpgvIWFkZGhtqGeBrw0NzcKCwyUGJ8UllXWJlKTYMIkoy6y0KAj7jISqQzQCmkhUWgJMIjgfSrkipZIPQBAC0Uh05LAeLgyktH6MCBjUB9qZHQor6iYnc718HR95vbcxtZW7eSR2zYW956G2j8M9orMTCnpKe9coGTU1DU01re0%2b4eGcDO5KRlcydO/wKaGV1ZQUVbA43Ha2upQBGhiSwtj0K2rhTc20DIxM7h43loiPTsTLGenJ6dw2SncZE46C4IOKkmgGOYNhQiiaSwShZFEpiZAbKB9YSJRkAih3jNIGEAcZC8pDjYK%2bAlAmJBETKIkxhCjo%2bNi84pKn7k9dXV3vXbTQVla%2bp7j87vPol0CGMSUutpXoobedTavqa2zc3J2oaiikkwnZ%2bXny8mekT5zCo%2bTx6soqqoqaWkRDAy0TZAKGFtbmRroaepoqsJLCJJEchqTm5OemceFQwE7ncVOY1JZZBiUCaQ4WEkUZPhgC5IDCwYowgD34D0sBuI3YETFhMcSoyKiQulMAKPCywQSEaIfFhFa09Dy9LlzYHDA46dPrjs4PfaK9wxPC6GUcsv7%2beMfmge2uCVtA0PDY1PT0/MLWfl5%2bcUlOJy81JmTqjh5NVUlANDUUtOHYWqib2FpAgDmZgaaBJwh%2bo5ERk56Rh6Xm5OWkZsOFYDJCA1KTIyJjgtPJMclUePBTqRfkfAg9scDGJkIliPeI9KRGygFDNDQ8KDwqJC4%2bGiYqvGJseGRIZA6eL%2bqtvGF9wu48fb1eu7p/9A9Ni6lIS6ltqhpamTxn00Dm7kVHRPTUxMzc7MLizWNja1d3SoqigAAk1Qdj4NBBBUAAGOYpFamMIiAQUdLTVNDFfY4iZyCLG5uelp2alZ%2bBuxKIBTiQaLDFhYUHRcBIwgWEmukUymJ1AQisosRESomCToBblBCSlRshI%2bfF6iEIgAeHChgw4aahEUE1dQ3hkaGh4QFwBnkicuzGw986PmvqNkt1XzB9Np/1x9InTcAAADfSURBVLxaKahqFwgW5hYFEzOzBaXF/N5%2bPF5ZWuoUVEBDTZlAUNHWUcciZGVtBsvGxgyaGK%2bioK2lJpFTmJ2WyeFmp2YXZKWksyDroJKWTCYmRPsH%2bsTFR0H0kVaGCkC0SHFx6DaMRIuBRAhqkoRudmC550v34NAAYID8wGyFYQoMgcG%2bLW3tJDrNzcMlOi7K0/vFrQcenNJBFq%2brZXBjaed/yjoWKxr5omXhkmi5Z2iIV1w48GYMIiQnI6mqrKCprqKpideB/dhI19TM0NrG/KytpTUcxC1N4E9VVRT%2bPzbiUw29GeqqAAAAAElFTkSuQmCC' /%3e%3c/svg%3e"},"path":"/authors/justin-yoo/","bio":"마이크로소프트 클라우드 🥑 | 서버리스 덕후 | DevOps/SRE | 엔터프라이즈 통합 솔루션","github":"https://github.com/justinyoo","linkedin":"https://linked.in.com/in/justinyoo","twitter":"https://twitter.com/justinchronicle","facebook":"https://facebook.com/aliencube.community","instagram":""}]},"related":{"edges":[{"node":{"title":"애저 펑션에 Open API 활성화 시키기","path":"/posts/2021/03/09/enabling-openapi-on-azure-functions/","image":"https://sa0blogs.blob.core.windows.net/msdevkr/2021/03/enabling-openapi-on-azure-functions-00.png","image_caption":"애저 펑션과 Open API","description":"이 포스트에서는 애저 펑션에서 Open API 기능을 활성화 시키는 방법에 대해 알아 봅니다.","content":"<p><a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-19697-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>에서는 현재 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-openapi-definition?WT.mc_id=dotnet-19697-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">v1 런타임에 대해서만 프리뷰 형태로 Open API 지원</a>을 하고 있습니다. 하지만, 애저 펑션의 현재 런타임 버전은 v3인데, 아직까지 v2 버전 이후로 공식적으로 Open API 기능을 지원하지 않습니다. 다행히도 <a href=\"https://github.com/Azure/azure-functions-openapi-extension\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">이 확장 기능</a>을 사용하면 애저 펑션에 <a href=\"https://www.openapis.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Open API</a> 기능을 활성화 시킬 수 있는데, 이 포스트에서는 이 확장 기능을 사용하는 방법에 대해 알아보기로 하겠습니다.</p>\n<blockquote>\n<p><strong>NOTE</strong>: 현재 이 <a href=\"https://github.com/Azure/azure-functions-openapi-extension\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">확장 기능</a>은 프리뷰 상태로, 정식 출시되기 전입니다. 미리 사용해 보시고, 피드백을 <a href=\"https://github.com/Azure/azure-functions-openapi-extension/issues\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">깃헙 이슈</a>에 남겨주세요!</p>\n</blockquote>\n<h2 id=\"애저-펑션-앱-생성하기\"><a href=\"#%EC%95%A0%EC%A0%80-%ED%8E%91%EC%85%98-%EC%95%B1-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>애저 펑션 앱 생성하기</h2>\n<p>가장 먼저 애저 펑션 프로젝트를 생성합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist108340972\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-01-func-init-sh\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-shell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-01-func-init-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-01-func-init-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\">func init MyFunctionApp --worker-runtime dotnet</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea/raw/f0510dff47d36f48ebc200fa72178e2ef33deeb8/01-func-init.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea#file-01-func-init-sh\">01-func-init.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>그 다음에 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-bindings-http-webhook-trigger?tabs=csharp&#x26;WT.mc_id=dotnet-19697-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">HTTP 트리거 펑션</a>을 하나 생성합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist108340972\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-func-new-sh\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-shell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-02-func-new-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-func-new-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\">func new --name DefaultHttpTrigger --language C#  --template <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>HTTP trigger<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea/raw/f0510dff47d36f48ebc200fa72178e2ef33deeb8/02-func-new.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea#file-02-func-new-sh\">02-func-new.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>그러면 아래와 같이 기본 HTTP 트리거 펑션 코드가 만들어 집니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist108340972\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-03-default-http-trigger-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-03-default-http-trigger-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-03-default-http-trigger-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">DefaultHttpTrigger</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-03-default-http-trigger-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-03-default-http-trigger-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-default-http-trigger-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-03-default-http-trigger-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>DefaultHttpTrigger<span class=\"pl-pds\">&quot;</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-default-http-trigger-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-03-default-http-trigger-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">Run</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-default-http-trigger-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-03-default-http-trigger-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">        [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Function</span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>get<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>post<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">null</span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-default-http-trigger-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-03-default-http-trigger-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-default-http-trigger-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-03-default-http-trigger-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-default-http-trigger-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-03-default-http-trigger-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">        ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-default-http-trigger-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-03-default-http-trigger-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-default-http-trigger-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-03-default-http-trigger-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea/raw/f0510dff47d36f48ebc200fa72178e2ef33deeb8/03-default-http-trigger.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea#file-03-default-http-trigger-cs\">03-default-http-trigger.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>이제 아래 명령어를 통해 이 애저 펑션 앱을 한 번 실행시켜 보겠습니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist108340972\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-04-func-start-sh\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-shell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-04-func-start-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-04-func-start-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\">func host start</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea/raw/f0510dff47d36f48ebc200fa72178e2ef33deeb8/04-func-start.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea#file-04-func-start-sh\">04-func-start.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>예상한 바와 같이 애저 펑션의 엔드포인트는 <code class=\"language-text\">/api/DefaultHttpTrigger</code> 하나만 보입니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/msdevkr/2021/03/enabling-openapi-on-azure-functions-01.png\" alt=\"애저 펑션 엔드포인트\"></p>\n<h2 id=\"open-api-기본-기능-추가하기\"><a href=\"#open-api-%EA%B8%B0%EB%B3%B8-%EA%B8%B0%EB%8A%A5-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Open API 기본 기능 추가하기</h2>\n<p>이제 Open API 기능을 활성화 시키기 위해 NuGet 패키지를 설치할 차례입니다. 아래 명령어를 통해 <a href=\"https://www.nuget.org/packages/Microsoft.Azure.WebJobs.Extensions.OpenApi/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">확장 기능 패키지 라이브러리</a>를 설치합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist108340972\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-dotnet-add-package-sh\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-shell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-05-dotnet-add-package-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-dotnet-add-package-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\">dotnet add package Microsoft.Azure.WebJobs.Extensions.OpenApi \\</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-dotnet-add-package-sh-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-dotnet-add-package-sh-LC2\" class=\"blob-code blob-code-inner js-file-line\">                   --version 0.5.1-preview</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea/raw/f0510dff47d36f48ebc200fa72178e2ef33deeb8/05-dotnet-add-package.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea#file-05-dotnet-add-package-sh\">05-dotnet-add-package.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<blockquote>\n<p><strong>NOTE</strong>: 이 포스트를 작성하는 시점에서 이 확장 기능 패키지 라이브러리의 버전은 <code class=\"language-text\">0.5.1-preview</code> 입니다.</p>\n</blockquote>\n<p>이제 다시 한 번 애저 펑션 앱을 실행시켜 보겠습니다. 그러면 추가적인 엔드포인트가 보입니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/msdevkr/2021/03/enabling-openapi-on-azure-functions-02.png\" alt=\"애저 펑션 Open API용 추가 엔드포인트\"></p>\n<p>이 추가 엔드포인트를 통해 Open API 기능을 확인할 수 있습니다. 웹 브라우저를 통해 맨 아래에 있는 <code class=\"language-text\">http://localhost:7071/api/swagger/ui</code> 주소로 접속해 보겠습니다. 아래와 같이 Swagger UI 페이지를 볼 수 있습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/msdevkr/2021/03/enabling-openapi-on-azure-functions-03.png\" alt=\"Swagger UI 페이지 - 엔드포인트 안보임\"></p>\n<p>그런데, 위 페이지를 보면 분명히 이 앱에서는 <code class=\"language-text\">/api/DefaultHttpTrigger</code>라는 엔드포인트가 있는데, 이 UI에서는 없다고 나옵니다. 어떻게 된 일일까요? 아직 해당 엔드포인트에 설정을 하지 않은 상태라서 그렇습니다. 이제 아래와 같이 Open API 관련 설정을 엔드포인트에 추가해 보도록 하겠습니다 (line #3-5).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist108340972\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-06-default-http-trigger-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-06-default-http-trigger-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">DefaultHttpTrigger</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-06-default-http-trigger-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-default-http-trigger-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC3\" class=\"blob-code blob-code-inner js-file-line highlighted\">    [<span class=\"pl-k\">OpenApiOperation</span>(<span class=\"pl-smi\">operationId</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Run<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">tags</span>: <span class=\"pl-k\">new</span>[] { <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span> })]</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-default-http-trigger-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC4\" class=\"blob-code blob-code-inner js-file-line highlighted\">    [<span class=\"pl-k\">OpenApiParameter</span>(<span class=\"pl-smi\">name</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">In</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">ParameterLocation</span>.<span class=\"pl-smi\">Query</span>, <span class=\"pl-en\">Required</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">true</span>, <span class=\"pl-en\">Type</span> <span class=\"pl-k\">=</span> <span class=\"pl-en\">of</span>(<span class=\"pl-smi\">string</span>), <span class=\"pl-en\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>The **Name** parameter<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-default-http-trigger-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC5\" class=\"blob-code blob-code-inner js-file-line highlighted\">    [<span class=\"pl-k\">OpenApiResponseWithBody</span>(<span class=\"pl-smi\">statusCode</span>: <span class=\"pl-smi\">HttpStatusCode</span>.<span class=\"pl-smi\">OK</span>, <span class=\"pl-smi\">contentType</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>text/plain<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">bodyType</span>: <span class=\"pl-k\">typeof</span>(<span class=\"pl-k\">string</span>), <span class=\"pl-en\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>The OK response<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-default-http-trigger-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-default-http-trigger-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>DefaultHttpTrigger<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-default-http-trigger-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">Run</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-default-http-trigger-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">        [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Function</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>get<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">null</span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-default-http-trigger-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-default-http-trigger-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-default-http-trigger-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">        ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-default-http-trigger-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-default-http-trigger-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-06-default-http-trigger-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea/raw/f0510dff47d36f48ebc200fa72178e2ef33deeb8/06-default-http-trigger.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea#file-06-default-http-trigger-cs\">06-default-http-trigger.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<ul>\n<li><code class=\"language-text\">OpenApiOperation</code>: Open API 스펙에 따르면 모든 엔드포인트는 고유의 Operation ID 값을 갖고 있어야 합니다. 이를 정의하는 데코레이터입니다.</li>\n<li><code class=\"language-text\">OpenApiParameter</code>: 이 엔드포인트로 파라미터를 보내는 방법에 대해 정의합니다. 여기서는 쿼리스트링으로 <code class=\"language-text\">name</code>이라는 파라미터를 통해 값을 전송합니다.</li>\n<li><code class=\"language-text\">OpenApiResponseWithBody</code>: 이 엔드포인트로 HTTP 요청을 보낼 때 받을 수 있는 응답 개체의 형식을 정의합니다. 여기서는 <code class=\"language-text\">text/plain</code> 형식으로 문자열을 반환합니다.</li>\n</ul>\n<p>위와 같이 설정한 후 다시 펑션 앱을 실행시켜 보면 아래와 같이 UI 페이지에서 엔드포인트가 보입니다!</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/msdevkr/2021/03/enabling-openapi-on-azure-functions-04.png\" alt=\"Swagger UI 페이지 - 엔드포인트 보임\"></p>\n<h2 id=\"open-api-보안-기능-추가하기\"><a href=\"#open-api-%EB%B3%B4%EC%95%88-%EA%B8%B0%EB%8A%A5-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Open API 보안 기능 추가하기</h2>\n<p>일반적으로 API는 부정한 방법으로 접근하는 것을 방지하기 위해 보안 설정을 하죠. 그렇다면, 이 확장 기능으로는 어떻게 이 보안 설정을 정의할까요? 아래 코드를 한 번 보겠습니다 (line #7).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist108340972\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-07-default-http-trigger-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-07-default-http-trigger-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">DefaultHttpTrigger</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">OpenApiOperation</span>(<span class=\"pl-smi\">operationId</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Run<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">tags</span>: <span class=\"pl-k\">new</span>[] { <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span> })]</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">OpenApiParameter</span>(<span class=\"pl-smi\">name</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">In</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">ParameterLocation</span>.<span class=\"pl-smi\">Query</span>, <span class=\"pl-en\">Required</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">true</span>, <span class=\"pl-en\">Type</span> <span class=\"pl-k\">=</span> <span class=\"pl-en\">of</span>(<span class=\"pl-smi\">string</span>), <span class=\"pl-en\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>The **Name** parameter<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">OpenApiResponseWithBody</span>(<span class=\"pl-smi\">statusCode</span>: <span class=\"pl-smi\">HttpStatusCode</span>.<span class=\"pl-smi\">OK</span>, <span class=\"pl-smi\">contentType</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>text/plain<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">bodyType</span>: <span class=\"pl-k\">typeof</span>(<span class=\"pl-k\">string</span>), <span class=\"pl-en\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>The OK response<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC7\" class=\"blob-code blob-code-inner js-file-line highlighted\">    [<span class=\"pl-k\">OpenApiSecurity</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>function_key<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">SecuritySchemeType</span>.<span class=\"pl-smi\">ApiKey</span>, <span class=\"pl-en\">Name</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>code<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">In</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">OpenApiSecurityLocationType</span>.<span class=\"pl-smi\">Query</span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>DefaultHttpTrigger<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">Run</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">        [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Function</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>get<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">null</span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">        ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC15\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-default-http-trigger-cs-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-07-default-http-trigger-cs-LC16\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea/raw/f0510dff47d36f48ebc200fa72178e2ef33deeb8/07-default-http-trigger.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2516ec59b204e2bbf85181620f1d0aea#file-07-default-http-trigger-cs\">07-default-http-trigger.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<ul>\n<li><code class=\"language-text\">OpenApiSecurity</code>: 애저 펑션은 기본적으로 API Key 값을 통해 보안을 설정할 수 있습니다. 이 키 값을 쿼리스트링으로 보낼 때는 <code class=\"language-text\">code</code>라는 파라미터로, 요청 헤더를 통해 보낼 때는 <code class=\"language-text\">x-functions-key</code>를 통해 보내는데요, 여기서는 쿼리스트링으로 보내는 것으로 정의합니다.</li>\n</ul>\n<p>이렇게 한 후, 다시 펑션 앱을 실행시켜 보겠습니다. 아래 그림에 보면 전에 보이지 않던 <code class=\"language-text\">Authorize 🔓</code> 버튼이 보입니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/msdevkr/2021/03/enabling-openapi-on-azure-functions-05.png\" alt=\"Swagger UI 페이지 - 자물쇠 열림\"></p>\n<p>이 버튼을 클릭해 보면 아래와 같은 팝업 창이 생기는데요, 여기에 애저 펑션의 API Key 값을 입력합니다. 현재는 로컬 개발 환경에서 실행시키고 있으니, 아무 값이나 넣어도 상관 없습니다. 쿼리스트링에 <code class=\"language-text\">code</code>라는 파라미터로 추가하는 것이 보이시나요?</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/msdevkr/2021/03/enabling-openapi-on-azure-functions-06.png\" alt=\"Swagger UI 페이지 - 인증 팝업\"></p>\n<p>인증을 하고 나면 아래와 같이 자물쇠 모양이 잠긴 것을 확인합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/msdevkr/2021/03/enabling-openapi-on-azure-functions-07.png\" alt=\"Swagger UI 페이지 - 자물쇠 닫힘\"></p>\n<p>그리고, UI 상에서 이 엔드포인트를 실행시켜 볼까요? <code class=\"language-text\">name</code> 필드에 아무 값이나 넣고 실행시켜 보면 아래와 같습니다. 쿼리스트링에 <code class=\"language-text\">code=abcde</code> 값이 포함된 것을 볼 수 있습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/msdevkr/2021/03/enabling-openapi-on-azure-functions-08.png\" alt=\"Swagger UI 페이지 - API 실행\"></p>\n<br />\n<hr>\n<p>이렇게 해서 애저 펑션에 Open API 기능을 활성화 시키는 방법에 대해 알아 봤습니다. 한 가지 문제가 있다면, 이 확장 기능은 런타임 버전 v2 이상만을 지원한다는 건데요, 여러 가지 이유로 v1 런타임을 사용해야 하는 경우에는 어떻게 해야 할까요? <a href=\"/developerkorea/posts/2021/03/16/openapi-extension-to-support-azure-functions-v1/\">다음 포스트</a>에서는 애저 펑션 런타임 v1을 지원하는 방법에 대해 알아보도록 하겠습니다.</p>\n<h2 id=\"더-궁금하다면\"><a href=\"#%EB%8D%94-%EA%B6%81%EA%B8%88%ED%95%98%EB%8B%A4%EB%A9%B4\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>더 궁금하다면...</h2>\n<ul>\n<li>애저 클라우드에 관심이 있으신가요? ➡️ <a href=\"https://azure.microsoft.com/ko-kr/free/?WT.mc_id=dotnet-19697-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">무료 애저 계정 생성하기</a></li>\n<li>애저 클라우드 무료 온라인 강의 코스를 들어 보세요! ➡️ <a href=\"https://docs.microsoft.com/ko-kr/learn/?WT.mc_id=dotnet-19697-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Learn</a></li>\n<li>마이크로소프트 개발자 유튜브 채널 ➡️ <a href=\"https://www.youtube.com/channel/UCdgR-b2t7Byu_UGrHnu-T0g\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Developer Korea</a></li>\n</ul>\n","humanTime":"09 March 2021","datetime":"Tue Mar 09 2021 12:00:00 UTC+00:00","canonical_url":"","timeToRead":7,"tags":[{"id":"azure-functions","title":"azure-functions","path":"/tags/azure-functions/"},{"id":"openapi","title":"openapi","path":"/tags/openapi/"}],"category":{"id":"Azure","title":"Azure","path":"/categories/azure/","belongsTo":{"totalCount":11,"edges":[{"node":{"title":"애저 Bicep 되짚어보기","path":"/posts/2021/04/27/bicep-refreshed/"}},{"node":{"title":"애저 펑션 프록시 기능을 이용한 Open API 확장 기능 하위 호환성 유지하기","path":"/posts/2021/03/16/openapi-extension-to-support-azure-functions-v1/"}},{"node":{"title":"애저 펑션에 Open API 활성화 시키기","path":"/posts/2021/03/09/enabling-openapi-on-azure-functions/"}},{"node":{"title":"이벤트 기반 애저 키 저장소 시크릿 로테이션 관리","path":"/posts/2021/03/02/event-driven-keyvault-secrets-rotation-management/"}}]}},"author":[{"id":"justin-yoo","name":"유저스틴","image":{"type":"image","mimeType":"image/png","src":"/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png","size":{"width":500,"height":500},"sizes":"(max-width: 500px) 100vw, 500px","srcset":["/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png 500w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 500 500' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-6a0325b746fa0b3948747e4a6f689de9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-6a0325b746fa0b3948747e4a6f689de9)' width='500' height='500' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC%2baJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVRo3pWZd1RT67b2ueccy7YgHQKE0HsvYkdFsaFYEKUI0nsnlPSEhBI6offeISgdpPeQ0JFi3%2bfse84Yt/x3v7%2b/udaCiLq3d9893rH2Soz4/J75zPm%2bK0jMz68sLq4tLa0LhVvLy9srK7tra%2b/Ea339/fr6h0Pr459Za2sfflyrq%2b/R9W5lZW95eVck2hGJtoWwlt4Kl7YEgk3B4oZgYWNxfm1hfm1%2bbmVudnl2RjgzvTQ9JZiaXJwYnx8fmxsbnR59M/VmZHJ4aHxocGyg/43E7KxoYWFtEf6yYFMofLu8vLO6undIPQKwsYGtTxsbH9H1CVugFbv%2bEcNhmAOA9ysr%2bwzLwm0RLATg7ZJga2lxEwVYX5j7HYDJiYWJcQCYAYCR4QkAGBwYRQBmZoTz86sLC%2bvAAADgCgBg0lHR2FWs%2b8NhgMMkf6YO3wCIdpdFCAD8o0tLW8hCAUAJCrA6PwcAIgCYmRYDzI%2bNzmIVAIb9CgDAHHx6HgGAnwIAWIpQ48WW/47oP2L4Qes7uPnxTQRAiKYIAxBsIgCLKMB%2bhEQ/VAADmP4mQtPTwtnZFWCAvwk/CH4cBnBY9%2bbmZ/T6M4ADie/gw7u7v%2b3t/fv29j/evfsn3Ozs/AZgIF0kgujvIgDLSAWQNhAiPXAAsLEIFYAegArMrs7NrmAV%2bBZgDgP4WoHx8YWpKYRhfn4N2kBcASz0IBpdn7HrH6kHcTs7/4C1t/fPmZnVzs7%2bxERaRHhMZERscFB4R0cvqAS58Ke7u/8OACLE%2b10hLAAQHDQx0gAYwCoCMLPyuxWANvimAqOjc5OTSwAAFTgE8B6z/xDA55%2bE5/Pn/%2bofmLK/ftPN1cPh5m0pyVOy0lLysjLSZ87ISksrKSiYGJmctbF95uKal1O4urK3ufVFKNwRLu3nRyhAABaRCiANcNDEfxQhAIA%2bPgAYn1iYmRGB/Yd7AG2Aj/%2bremwKra19rK5uuXL56i/HjkqePIFIl5ORg/9JSkqePi156uSpEyeP/O1vf/nLv0lISMhISz9%2b5NzSzN/Z/vvmxuclGEECFGBxc2FxHRtBUAHU/p/1wFcArInF6rExinUwqv5/wXi3908ul6evoycvI62moqyGV1FTVVFSkMMpKSgpIjVQVJBXUkTupM5ISkvB5fQvx49rENSfI9UogmqA90uo/Wj7rs8jHbyKzlCsAZamJg/vA1gFJr%2bOUdjFBIKv3qObwOH8fDxg%2bHx4YfZDpqOjE1SUFPE4JXW8ihZBTVdLw0BHSwOvoqmmqqmmoq6KwysrAg9ccYoKCvKysIDqxC/Hjx7566kTv2SkZ29ufATFSAMsiNVDBZZnp0UzU1/tB/UHANPYPrBfAWz/Ent/aIB%2bB/ANA0wbaMem5ld6unog10BXRx90q6nqa6pdtja%2bYWty46zR3QtmD%2b0s7cx17cx1zhtpauNxyggJDhjOSJ6CjP1y7Mjtm7dGhqfWoA6Lm0h%2b9gFW5iA/06LpKaE4PBjAQQMgIwgq0N83IoGdIA7UY/vux9%2brwKfD9m9tfREt7121u66BV9XX1jLS0bA21HK5aUv2f5gW4VJAdK2keFWRX1QnuWUF3MsLvMvxvuVlb37ZmKBPUFaSl4UmgTqcPnnizOmTgESMjYdBhPTu/BqqHhpgeWZaiNovENuPqv86Q/cjBOoPjH9/kOyPh8z%2bPjzIgui/%2b1dMTCJeWUlbg2Brqh/j6sAjutaz/GZqSXM1CbPlsbOlMeO80MEMPz7dvTXRpSXBpSz4Dv2JrccVAzMNJVVFOXlZGFGAcPzUyROmJiaTE4uwCczNYvavzCD2L00j6vfTP4ocImZGhsX5QdQjFTh0avi6bf1kwQd2d36LjCTiVZS11NVNdQgcP8e%2bzOCxkti5OspaR8pmV6qonjJTGD6ZHzIMALTnnTRXPtWtOfZR4ctrDCcrzwtaVurymorS8lKSp0%2bdgAUDi0ljra2%2bm5leRuyfXp6ZQgCmJgTi/GD2Q96Gh77ajwAcHNSwufn55wDQuLC58rtHFOTkVJUUYeyEPrwynBW0WJe4wU/b7c//MFLyYaRs61WWsJY0XRA%2bnhPYz3nZx3k5kObbRXWrCXVkP7SKvKb3yAx3QUNWT0laRvIk/Hf0yN9winItzZ2w34F0dP5A%2bpfE9ovH//DQ1y0M1Pf1DiEAm5sf0Ov%2bYeEnAHBY%2bPT5P5nMdGnJU1oa6udNdcuIz0YLI9Y6OO%2bGC98PFX8YKf80Vv32dZ6wjjpdHDmRHzKWGzyaEzTE9eNTXGtD7qU8sk64Zex7XuO%2bsdI1HUVteaQIUlJSsEU43b%2b/ItqZnoThA0v43fA5sH9c3L6wenv2AT4ebFuff74QgE//ERwcKS8jpaul%2beT62epEt4mS%2bJ3%2bvHeDRR9Hyj6%2bqfgwUrnawp3ixUzyIt9kBY7lBI3nhw2kercSHxd5XmU6msc7GEZc03M2V7ljqHSOIIOTkTxzRvKvf/k3C3Mz5PwzvYzaD%2bERHLYf1I8MTw4Nfk1/X%2b9wz%2btBiR%2bPDD9JP3wYpqez83MAMDMy8HS0q6F6CZtT3o%2bUQ3I%2bjVa8Gyxea09bqqdPFccOpgcNpAUOZwSM5YWOZAZ0JroUelxhOprF2utHXtd/bom/a6h4UUNWXf6MtLTU8WPHYK/jd/QIFjYhPOL2PQgPZv/k4IA4PMNg/%2btXAxIHTypfw/Pd/WGAt29/nV/YsLSwUlaUP29t4XHnYh3Lf42fvdtfvDdUujtQsMHPWO/K3uDnLbekjuaE93P8Bzg%2bQ9yACV5kf6pvbdh9jpN1zHV9v4uartZqd4wUoRM0FaRkzpw%2bdeokHDXYTM7K8g54P4XYv392EKsH%2bwf69%2b0H9WIA8Vn/o/jkfHgd7mA4J3e/GlFVweNVcBesLV7cvdyREbHGz1zryhI0ssfLSXMNKW%2bHanfH27aH67f6yuer6RO8qMki4mwlZao0qZvlVxbygP7knNcFbSdTFQd9pfPqMuoKUrCxnT55EtrA7bkbbKkT44tTB/kZfbMPMDQ48aP9r7r7JX58WPmO4TDA%2b/f/amrqxquqahLULE0MA584TFSQ1zvT5moZVWTf3ES/FKI/O9q3hBHekh4z15q3O1Inaslcak6fr%2bc0swJpnne875xzuWjkaK11SRd3RVvhIkFGTfY0jNMzp08DwDNnF9jREO%2bR9kUADoVn/Dv1sLr5fRJ/5mlLfPiB/au%2boVNZSRFmqK6aCsvHca2VtdTArE3yzIv2KGVF8mjBmfFeVazA5rTQN1WsD%2bPNi3XcocyI/uzItID7L25anTfSstAlWOuqWGspWRIULqnL6cufQrZkSQTgsdNDOFBg4Tk8fLDw9Pe9wdRD72L287t6v%2bmBny8YQfB41dk5gFeB85vSbRuDfo7XWkPSXEkMn%2b03Uc0WdBSI2nNmyknD2RHCZs7eUPHOQOlsOb2N%2bKw%2b5klxqGNJ6P02lncT1Yvz4prbeW1rgqytuoINTlLu9C8AAKftB46OS4INUC9u34OdCwP4JjxgPwJwcPj59Geeerff/n1yUmRqbKKqpEBztx9M8elIDapPi%2bFRgkqZoU3ZCUW0QLKXY%2bT9i0muN3lEj4lyyigvttDbnnjLNOK2RaqvYz7RnRv4MOG%2bjaMZ/qy6rA1e9gpBVl/u1LGjR6ECZ62t4IELdgDx9MR6F0s/NjcPq%2b/q7JEQnz3/DABMoZmZFUsrG2sr67iIKJdHD8lkMinUtZbhPt5A6SwnpjKC7lw/63JOn%2bV8sY7sXptHD/d/qa0ko6Uk8%2bCKsf8TO1tTQx2crIOZxh1jVRsNBRtdvJmmsh5OTk9LE4dT1lQndHW8hscAkH5gP5b%2b0R%2b9B/WdHa//DwBooT4vi3Zi3V1unLPKjg%2bK9XMtzM/IjXtcS3rUkh3UWhjdUUSLe37L/5Jh2rPLizXxbEq03w3bR2d1jLXwvi5XWZHOSe73Aq%2bbudho2mvLPjHHXdZSvH/HQVlV%2bemjx1cv2cXFJmC77%2bHhM9A/hs1NsB9T381H1MPqaH%2bFHeY%2b/lmAzS%2bby9vtRN%2bYl8/aqd4zuaEtueT6jLDenMCBwoiZGnIfN6wm4nGe142BrJCewthAt3uThbF1sU/PWxi%2beHCH/sIh2%2btGuutl8j3zoKu6z6zwDgbKMaFBRjrqevD0Iy/d0dwBz2Lf2d/fN9rbsx8eTD2/C9S/7ux41dHevQ8gXoe/4fkRYB15Evj8piCd4vu8Ls59Ni%2b8IyOmkB6w1Zu68TpjujC2j%2bU7xA2eLYl735PZW5CYHeP%2b6wivIc7ZUlP5qZV26mObQp8bPG/7TNdL6c5nI67pP7HWJYYF2hmoEc6ceHDdbnpiYWx0Htt6xer7ekd6Xg%2bJxw6WHPC%2bva27rZUvgX0B%2bLvr9763%2brCx/dvqYF9ugDMv6NFcQbSwMaWCFd5dQBR05k1Xs0aLk0Z48T2ZkV1ZUTBS5%2bqZv46WvKJ5XNaQdzDC5b%2b8Wh/u1BDq1BjxsMTnZuxNk9D7l72fPzqLl9eSOc2IjV0UbMKR880I1rvIzgWjE7P/sHrM%2b/Y2fmtLl4T4S8yfYHzzcvPXLdHGQk16M8V3pjBmqzP9w0jNSHVWRy61jh1ZQfKrogZUkXzqGMHTVWQo1peJqvGccD9bdQcDpYcWmmF3banP7CnOVxMeX/G/ddb5hu0lXeXrBoSzSlLF6dy5%2bfU3w1Ni%2byH9qP374QGAw%2brbWrtamjskfvwG8%2bckG3AmXdnbbM4dSQ%2bf4EWvNjHfD5X818rgfy4Pfhqq3mhOncgMmcqJ2ONnrzeytruz/jHTNF%2baFH/DmHzP4oUZ/pmJckOSVx3Rg%2bd9l/LA9omZqp2GrJ2ump2mcldzx9SUCIn%2b/sFhP/2vX%2b3bjyUH1ENywPvWls7mpvb/A8Chbz8/rtRnD6WFjOVHCuuS3nZnfh5r%2bm2h7%2bObhn6aT4nndVFz5l5vycehmo/Ddf8SdK%2b1pFDvWXrZaDjpyvvZELrInvNlpCGWT5GnvbsV4SJB9rK2spOlwfDA6PjowuHe7et9A%2bnHJg8WHsg9mpxOTH1TY5sE9oXrjwx/TPJhbePLRl/LXAV5gBu4WB632sx611v4abxpoYJR7HFtror%2bZaJxg18yVZM2Us4Z4hGro12czVWvass4GePCLuvme9j3p4b00l%2bmPbZ5ZIw7T5C5gJcJcLwBp%2biDU%2bcEGh5Qj9iPqT/oWsR4SA6mvqG%2bFQDe/QjwY0EO7j%2bsw83W3zdHh%2baLk7rZvnOlUYtVCauN9M2u3PqopwO5sWs9JaKuomV%2b0UIHb6YxvSMlqCzejeNxJdHJOuquBZxDo29bcN2v8Ske7IeWt3TlzqvL2SidDna6PTUjGtrvXSw8I69fDXXzB7DwYDMHNR5R39jQ1tjQWl/XLCH%2bvYN4/QQGWavv1ze/rM4uzZcyu5kvp4oiFmsThXXk2UpySfC9ifqUxbac7aGa3ZH6vdHmrd6q2VLmeD7pFellzvOrjEfnwm4YBdobh9obt5FcYZje0pO3xUvbG2qU5/ImJgSYerAf1IP9r7q/2o/lHrxvakTUN9S3gPq62iaJ1ZX3PzL8iLH6LcPa5hfR%2bFh3sv9YXthSA2WllTFdEtdO9x4sSqhJcO/NS1xqylmozVqsyZkvy3ydFMJ7cYf51M7rnO49feW4u9apntd70oKyXtg56MlbKhxnxMbMzW8MDkwM7u%2b7o2h4EPu7OvftR9V3HqhvxdTX1jRKLKO/bsB%2bDfFHACvwzg91WNv8e28RG556RY2MxbqkmZLY0fwoflpgpudtXtSLjaHq91NNnwT8X9dHREM19Rkx6ZHPbxjinxhplAY4tbF8BnMiom%2bZ2evKnsefqS6pmJgUDgyg4enHehexn9/V39mB2I%2bph/B8p76muv4bABC6jF7FDMh19QP2R9/%2bsujd5vZvo%2b1Nrznewkb6YiNtqoI4xosYK4pZaUvf7Sldayna6ajba2neaa5dyE9rDvAkXzIPO6eX5nyp2Mehg/GyPObJMxu1W/pyjrYmQ4OTI8MzaO%2bOH/Tuvv1o7/J/X31VfXVFrYRoeW//dz6H1o8F%2ba4yq2uA9GFhWtiZGjZZEiNsZszUJE1VJMw3MDb4Oe8GS36dbv401rbdXjOfzx5ixbSHv8h8coX2wCbH7UqR982i4HvhDiZPrPC2uON0InFmdnWgH%2bvd/fSjvYvYj02e/fCA%2btoWkF5b3QDqqyrrKstrJITLe8sog%2bhgrfwQqh95AHJr69fVjS81GQw%2bx3u8OHqsMHKiLH6xhb0GAAMlX8Zq/zHXudVfMVqe3JES2ckIqAx9WOp/p9TXIe/ldfLjs/dMcBfVTj%2b9fnF4eHp4eGZgYLL/d%2bx/Db0rtr%2b%2brqWupglTX42qryirlhCKdkUogwhdy8v7FTh83V8H6VpB1H%2bByD54%2bMTK3LQg%2bmkbw4vP8e3JCJptYKzys/cGCt8PFH0cqXo/WLfcWjjGI/fS/FojHtcG3eF5XeU8PedsTbAhSJvhTl%2b2tenpeTM0NN3fB%2bqhd5HRCenv6uzraO9ta%2b3%2bRn1t8773FbWgvry0qqykAgVA1zKKAQURruyBbgTmW4BlrETLexCh2dmVG/Y3ZGXkFHCqNJ/7dWSPGrL764zAwYLI5U7udh9vr7/gLT9rvS1P0Jg9nBUDB7hKv1sFL67QH1gEXtU/rylnhpe10cQdQb9KmZwU9va8QY894t7txUYnFh6IPqq%2bEYw/pL6ypKhcYkm0u4QCLGG/dTtEAnKxdO1f0QUf23r797KyKmVlnKKCkqqmXmtJ7nB2cEnss8pE1%2bZkn9HyxLWevPVXucL2rPnGzJm6jO7U8MrwJ/neNxMf2Phc0r5piDPFy1kR5G0I8vAY%2bfTx4/EJwevXbzD7QT1qfw9qfxe2Z4H9WNd%2bp76ooFRCINyBtQTrAGB/YQwojHihb%2b6urH2sb2q5c/c2/PO3HrrPvxlfqiGOlhBrSe7FUc5l8c/7CuNE/Jz51qyxShao56eGVsW4MFyv%2btub3DHDm6nJm%2bDlz6nJWCifgZ%2bgr6MFWe/rmxCHB%2bxvb3vd2oLkRxyemqoGLPegvrS4AlNfyCvaBxAzLB2UYgllQBoDfYl1CLyzBACr70sqKtMyODpa6m4BpLmFvaUG2tuerLlack96QE3C8/yIx/Usv56COH56UBvDp4Xuw3S76nPD/JaFlrkGzgyvYIU8y0ub4s787chRGWnJnKw8aGXwHnoXDc%2b%2b/U2NHVh4atDwVJbXHva%2bkFfMyyuQWFzaxtQLDi1QLzioydIBAKIefbm8%2bqGqpp6dlkymJDx44t00sDPbUfm2O3XzVdZcDXk4L7yF9iI32JHtfYv64maCm33A3bN3bXQvG6nbaKlYayhZ4eUuqsteVz9jpKogI6984pdjQYFBsAmAbnTywOh83dLc3dyE2d9aW9NUXVVfWYHMHEx9cWFZIa8E1Ofl5EsIAABdGMl3GN/VBAXbXl3/1NDcwU5lpnA54REhYaS81wMr4yXxG/xUUSt7pipxKCekg%2bFZFfckw%2b9WjNNZ14t6T85qO5/VvmeOv6Apf5Ygd01b3o4gaaypYWxpd/z4sWvX7MDsEShCZ39bK%2by7oJ6P2t%2bGqm%2borKirKK8pQ8ODqS/IL8rP5eVm50kIBG/FANgS/B6JEK0J/ClSB%2bFOUWlRKpedmc3lpLOJCTGMnKaGmu7elABBDWmxjjoPm1pp3Agvsj8ruI3qVhTgkOlhR3909sV5rUtaCpc15G7ryl1UlTTS1rn7NOTYseMXLtj6eHsz6GxQ/Kp7CBgaGzrq69qw8FRV1leg4cHUF/FKC/KLMfXZmTkSC4tbC4K3sBYPMSweFGRxaUewf7MNGOD99Nx6bUMjYn86m5udlpaZmsrlUKjxiawsekR4cZhTX7LPeF74dClxpjJppoY0VhjVlx7QFO9S6H/T57LeZW3cdR2F2waK51TP2JhZ%2bsdlHzl23NLSwt3D1cRY38TYIDQkrLK8DlIEGHW1Laj3teVlNaUlmPelqPcQnrycrNysjGyJ%2bcWt%2bQMG8RIc4kFeQmzWPiwKthuauxLIZBqTwmBRGWxaamZKWlZKakZqGjclOib0hZe7m9szTpR3npd9fbgjn%2bbRkxrwKtW/NyOkLy2I53fHyVLbXk/VwUDlngneWunkLfu75MxWANDV1fH197l//66M1CkFeSlrK3M3Nzc6jQXSoYmBoaS4EvG%2bAPO%2bEKKPqc9Iz5SYW9jEGMQLqQa65gXIS6FoTyDcbe/qpzGTw6PDwmPCiYmx6RkpLDYd%2bhhmEZPDgGrExEW99PHy8PKgJDOo5DiKrzPH7Xq%2b17XSkHulYQ%2byvG56nte7a0K4a6J%2bx5jgaK5hJn88LJzELuo5euwEgUAICPILCPS9fPm8vJyUkqKsJkHFyEDX/trV8LCIvJxCmJ4AwMsrQtXzxOq5aVwEAGXYPAwAC24gOaKV9/1DU9ys3KiYqMjYyERKQgKZGBYRkpaRAtKTU5ip3JTkVCY9mUahkzxfenh5v0jmMBgcFjMlmcEgF9Cj6S5XYm4aedioO5mqOJmr3zJSv22icctA5YKmYkXTGDO34%2bjx03iCZkhYUCwxsrKm%2bvad26dOHiOoKRvqaRnp6xgb6dlduRQcEASxKSmqyM1Goo%2bqz%2bKmZaSlpErMzm/AOsBAALAbaNbRcUFeYWlkTBQYT6IkJNESKQwylU4KiwimMEgZ2Wmp3GR2GgsAklMYrBRGVEyEy3NnTiorK5fLSUsGts3t7YGBfleHi/f0ZJ3MVG8b4a/pqt4yVr%2buKf3o6uWhhX%2bGkfN/OSVD0DLy9PYMjQgpKSvhFZecOX1CXl5WU13VUF/LyEAblqGBjv01u7iYuHzUfpCenoqoT2VzJGbm1jEGZC0gVzB%2bfvFtbUMbMSkBfmgCOZ5ETyLREhnJ1GQOHa7xSbGJ5HgWhw51SM1gQ5DoLAokChg8vTxiiFGZOenQ2XQWrbyyrLCs2DcwwFoHb6sqdUFd4ZoO7qa%2bsq3S0Qg//%2bmt/%2bfsFXNaGqdtdPahs3NweGhcfGx334CegY6k5ElVFSVtTTVDPU3AMDHWMzbWMzU1cHrgmMxkZ2fmprIR9SmsZAQAY8CuS8Ldnv5xTjoXAkNMiiNRE6lMMqxEajyNRU5OAQAKmZFEoiZQmSQmh5aRlZqRlQZZojHJEKrI6LCgEH%2bwH%2bpAppJoLJqX70vbc2cv29lZqCufV5W%2bpC5/TlXqmpZMfWNfIKX2%2bsNAvJbJOXvnh0%2bfhUdH%2bgb49g4O3nNyPHb0ryo4eYIaTleLAFky0NcyNdG3tDABkvO2VnExMRAhDpPNZjAlpmfXYE3NrM4tbAFARXVDbGJcFDEqkQqBIZHpiRR6EkiHGxI9kcGmMtlUeAmJpzPJcAOzKD0rlZuVAmCcNBYSsMhgOovKTmUxWJSCkmImJ%2bX2nRvefj4Xz9mYKUraqMpYyx0JdXmYWzdhae9jfe3pldvuj72T7O8%2bCokM8w3ya%2bvo8A8OOvo3CUUFWQJeSQ2P09fTMDDQMjbSNTMzsLIyRW5MDSLDwricVCaVJoGph8y8GVvMyMkF6fFIZkgUVB/YnEghUgCDmYQAJFNZHBoNqQm4S6YjHyAz2TR2CgMsh80BGBKS4pIoCXQ2HSFn0uqa2109nkVEhTk%2beGCqqmCFk7yqLpWdV%2bvgEnvJweXKHfdQcrFfXJaXf4h3gH9weEhZZUVMfPzxo3%2bRk5UiqCqpKCtqQZCgE1AAC3MjU2M9IwMtczNDfx8fDpMlgXnfwR%2bgMulxSXFUJpXKotCTYdJT6CwS%2bEqixiMA9EQqPQleQgVQZYAHH6BgVyryEopDh06A1JGpiVABeCckPKixtTMiOtLP39v5%2bTNrA10jqSMPzls9D6CbnX943z3WLzYrs%2bpNLKskr6CQSCYHhQfn8PKoLOaJX47ISkuqqSiqKMsTCMp6uppGhjpgvIWFkZGhtqGeBrw0NzcKCwyUGJ8UllXWJlKTYMIkoy6y0KAj7jISqQzQCmkhUWgJMIjgfSrkipZIPQBAC0Uh05LAeLgyktH6MCBjUB9qZHQor6iYnc718HR95vbcxtZW7eSR2zYW956G2j8M9orMTCnpKe9coGTU1DU01re0%2b4eGcDO5KRlcydO/wKaGV1ZQUVbA43Ha2upQBGhiSwtj0K2rhTc20DIxM7h43loiPTsTLGenJ6dw2SncZE46C4IOKkmgGOYNhQiiaSwShZFEpiZAbKB9YSJRkAih3jNIGEAcZC8pDjYK%2bAlAmJBETKIkxhCjo%2bNi84pKn7k9dXV3vXbTQVla%2bp7j87vPol0CGMSUutpXoobedTavqa2zc3J2oaiikkwnZ%2bXny8mekT5zCo%2bTx6soqqoqaWkRDAy0TZAKGFtbmRroaepoqsJLCJJEchqTm5OemceFQwE7ncVOY1JZZBiUCaQ4WEkUZPhgC5IDCwYowgD34D0sBuI3YETFhMcSoyKiQulMAKPCywQSEaIfFhFa09Dy9LlzYHDA46dPrjs4PfaK9wxPC6GUcsv7%2beMfmge2uCVtA0PDY1PT0/MLWfl5%2bcUlOJy81JmTqjh5NVUlANDUUtOHYWqib2FpAgDmZgaaBJwh%2bo5ERk56Rh6Xm5OWkZsOFYDJCA1KTIyJjgtPJMclUePBTqRfkfAg9scDGJkIliPeI9KRGygFDNDQ8KDwqJC4%2bGiYqvGJseGRIZA6eL%2bqtvGF9wu48fb1eu7p/9A9Ni6lIS6ltqhpamTxn00Dm7kVHRPTUxMzc7MLizWNja1d3SoqigAAk1Qdj4NBBBUAAGOYpFamMIiAQUdLTVNDFfY4iZyCLG5uelp2alZ%2bBuxKIBTiQaLDFhYUHRcBIwgWEmukUymJ1AQisosRESomCToBblBCSlRshI%2bfF6iEIgAeHChgw4aahEUE1dQ3hkaGh4QFwBnkicuzGw986PmvqNkt1XzB9Np/1x9InTcAAADfSURBVLxaKahqFwgW5hYFEzOzBaXF/N5%2bPF5ZWuoUVEBDTZlAUNHWUcciZGVtBsvGxgyaGK%2bioK2lJpFTmJ2WyeFmp2YXZKWksyDroJKWTCYmRPsH%2bsTFR0H0kVaGCkC0SHFx6DaMRIuBRAhqkoRudmC550v34NAAYID8wGyFYQoMgcG%2bLW3tJDrNzcMlOi7K0/vFrQcenNJBFq%2brZXBjaed/yjoWKxr5omXhkmi5Z2iIV1w48GYMIiQnI6mqrKCprqKpideB/dhI19TM0NrG/KytpTUcxC1N4E9VVRT%2bPzbiUw29GeqqAAAAAElFTkSuQmCC' /%3e%3c/svg%3e"},"path":"/authors/justin-yoo/"}]}},{"node":{"title":"이벤트 기반 애저 키 저장소 시크릿 로테이션 관리","path":"/posts/2021/03/02/event-driven-keyvault-secrets-rotation-management/","image":"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/event-driven-keyvault-secrets-rotation-management-00.png","image_caption":"이벤트 기반 애저 키 저장소 시크릿 관리하기","description":"이 포스트에서는 애저 키 저장소의 시크릿 값이 새롭게 갱신될 때 해당 이벤트를 캡쳐해서 로테이션에 필요하지 않은 오래된 버전들을 비활성화 시키는 방법에 대해 알아봅니다.","content":"<p><a href=\"/developerkorea/posts/2021/02/23/keyvault-secrets-rotation-management-in-bulk/\">지난 포스트</a>에서는 <a href=\"https://docs.microsoft.com/ko-kr/azure/key-vault/general/overview?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 키 저장소</a>의 모든 <a href=\"https://docs.microsoft.com/ko-kr/azure/key-vault/secrets/about-secrets?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">시크릿</a> 값의 모든 버전을 한꺼번에 돌려보고 비활성화 시키는 방법에 대해 알아 보았습니다. 이 방법이 매우 간편하긴 하지만, 처음 한 번이나 두 번 정도 벌크로 진행할 때를 제외하고는 매번 모든 시크릿 값을 대상으로 진행하는 것은 어찌 보면 과하지 않을까 하는 느낌도 있습니다. 그렇다면, 특정 시크릿에 새 버전이 만들어졌을 때 그 시크릿만 체크해서 필요한 만큼 변경할 수 있는 방법은 없을까요? 물론 있습니다! 애저 키 저장소 인스턴스는 기본적으로 <a href=\"https://docs.microsoft.com/ko-kr/azure/event-grid/overview?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 이벤트그리드</a>를 통해 이벤트를 발생시키므로, 이를 활용하면 이벤트 기반으로 특정 시크릿에 대해서만 <a href=\"https://docs.microsoft.com/ko-kr/azure/app-service/app-service-key-vault-references?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813#rotation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">버전 로테이션을 관리</a>할 수 있습니다.</p>\n<ul>\n<li><a href=\"/developerkorea/posts/2021/02/23/keyvault-secrets-rotation-management-in-bulk/\">애저 키 저장소 시크릿 로테이션 관리</a></li>\n<li><strong><em>이벤트 기반 애저 키 저장소 시크릿 로테이션 관리</em></strong></li>\n</ul>\n<p>이 포스트에서는 <a href=\"https://docs.microsoft.com/ko-kr/azure/event-grid/overview?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 이벤트그리드</a>, <a href=\"https://docs.microsoft.com/ko-kr/azure/logic-apps/logic-apps-overview?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 로직 앱</a>, <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>을 이용해서 특정 시크릿에 새 버전이 추가될 경우, 이를 자동으로 감지해서 로테이션 버전을 관리하는 방법에 대해 알아보기로 하겠습니다.</p>\n<blockquote>\n<p>실제 작동하는 코드를 보고 싶으신가요? 이 <a href=\"https://github.com/devkimchi/KeyVault-Reference-Sample/tree/2021-02-24\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">깃헙 리포지토리</a>에서 다운로드 받아 로컬에서 돌려보세요!</p>\n</blockquote>\n<h2 id=\"애저-키-저장소-이벤트\"><a href=\"#%EC%95%A0%EC%A0%80-%ED%82%A4-%EC%A0%80%EC%9E%A5%EC%86%8C-%EC%9D%B4%EB%B2%A4%ED%8A%B8\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>애저 키 저장소 이벤트</h2>\n<p>애저 키 저장소는 <a href=\"https://docs.microsoft.com/ko-kr/azure/key-vault/general/event-grid-overview?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">이벤트 그리드</a>와 통합하여 시크릿에 새로 버전이 하나 추가될 때 마다 <a href=\"https://docs.microsoft.com/ko-kr/azure/event-grid/event-schema-key-vault?tabs=cloud-event-schema&#x26;WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">이벤트를 발생시킵니다</a>. 따라서 이 이벤트를 받아서 처리하게 되면, 굳이 모든 시크릿을 한꺼번에 루프로 돌리지 않아도 개별 시크릿에 대해서만 작업할 수 있어서 상당히 편리합니다. 애저 키 저장소와 이벤트 그리드, 그리고 이벤트 처리기로서 <a href=\"https://docs.microsoft.com/ko-kr/azure/logic-apps/logic-apps-overview?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 로직 앱</a>과 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션 앱</a>을 통합한 전체 아키텍처는 대략 아래와 같습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/event-driven-keyvault-secrets-rotation-management-01.png\" alt=\"전체 E2E 프로세스 아키텍처\"></p>\n<p>이벤트 처리기로 <a href=\"https://docs.microsoft.com/ko-kr/azure/logic-apps/logic-apps-overview?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 로직 앱</a>을 사용하는 이유는 <a href=\"/developerkorea/posts/2021/02/02/websub-to-eventgrid-via-cloudevents-and-beyond/\">이전 포스트</a>에서 언급한 바와 같이 <a href=\"https://docs.microsoft.com/ko-kr/azure/event-grid/security-authentication?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">이벤트 그리드에서 요구하는 인증</a>을 내부적으로 손쉽게 처리할 수 있기 때문인데요, 만약 애저 펑션에서 직접 처리하고 싶다면 <a href=\"/developerkorea/posts/2021/01/19/cloudevents-for-azure-eventgrid-via-azure-functions/\">이 포스트</a>를 참조하면 좋습니다.</p>\n<p>애저 키 저장소에 이벤트 처리기로서 로직 앱을 연동 시키는 방법은 크게 두 가지가 있습니다. 하나는 애저 키 저장소에서 <a href=\"https://docs.microsoft.com/ko-kr/connectors/azureeventgrid/?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">이벤트그리드 커넥터</a>를 이용해 직접 로직 앱 인스턴스를 생성하는 방법이고, 다른 하나는 별도로 인스턴스를 생성한 후 HTTP 웹훅을 이용해 연동시키는 방법입니다. 전자의 경우 <a href=\"https://docs.microsoft.com/ko-kr/connectors/connectors?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">커넥터</a>라는 의존성이 하나 생기는 반면, 후자는 키 저장소와 로직 앱이 독립적으로 작동하기 때문에 개인적으로는 의존성을 없앤 후자를 선호합니다.</p>\n<p>먼저 애저 로직 앱 인스턴스를 하나 만들고 <a href=\"https://docs.microsoft.com/ko-kr/azure/connectors/connectors-native-reqres?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">HTTP 트리거</a>를 추가합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/event-driven-keyvault-secrets-rotation-management-02-ko.png\" alt=\"로직앱 HTTP 트리거\"></p>\n<p>이렇게 만들어 놓은 로직 앱의 URL을 이용해서 키 저장소에서 이벤트 처리기를 연동시켜 보겠습니다. 먼저 키 저장소 인스턴스의 이벤트 블레이드로 이동합니다. 그리고 <code class=\"language-text\">+ 이벤트 구독</code> 버튼을 클릭합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/event-driven-keyvault-secrets-rotation-management-03-ko.png\" alt=\"이벤트 구독 생성 버튼\"></p>\n<p>그러면 이벤트 구독 관련 인스턴스를 생성하는 화면이 나오는데, 아래와 같이 <code class=\"language-text\">이벤트 구독 인스턴스 이름</code>, <code class=\"language-text\">이벤트 스키마</code>, <code class=\"language-text\">시스템 토픽 인스턴스 이름</code>, <code class=\"language-text\">엔드포인트 정보</code>, <code class=\"language-text\">웹훅 엔드포인트 URL</code>을 선택합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/event-driven-keyvault-secrets-rotation-management-04-ko.png\" alt=\"이벤트 구독 생성 상세 정보\"></p>\n<ul>\n<li>이벤트 구독 정보 섹션에서는 이벤트 스키마로 <a href=\"https://github.com/cloudevents/spec/blob/v1.0/http-protocol-binding.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">클라우드 이벤트 스키마 v1.0</a>을 선택했는데, 이는 애저 자체 표준 대신 <a href=\"https://cncf.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CNCF</a>에서 제시하는 표준인 <a href=\"https://github.com/cloudevents/spec/tree/v1.0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">클라우드이벤트 스펙</a>을 따르는 것이 향후 이기종간 통합에 편리하기 때문입니다.</li>\n<li>항목 정보 섹션에서는 이벤트 그리드 토픽 이름을 선택합니다.</li>\n<li>이벤트 유형 섹션에서는 이벤트 형식 중에서 <code class=\"language-text\">Secret New Version Created</code> 이벤트만 선택합니다.</li>\n<li>엔드포인트 정보 섹션에서는 엔드포인트 유형으로 웹훅/웹후크를 선택하고 엔드포인트 값을 앞서 만들어 놓은 로직 앱 엔드포인트 URL로 설정합니다.</li>\n</ul>\n<p>이렇게 하면 애저 키 저장소 인스턴스와 애저 이벤트그리드, 애저 로직 앱 사이에 이벤트 발생시 기본적으로 처리할 수 있는 파이프라인을 만들게 되는데요, 실제로 애저 키 저장소에서 시크릿의 새 버전을 하나 만들어 보면 아래와 같은 이벤트가 발생하는 것을 알 수 있습니다. 원하는 <code class=\"language-text\">Microsoft.KeyVault.SecretNewVersionCreated</code> 형식의 이벤트를 캡쳐한 것이 보입니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/event-driven-keyvault-secrets-rotation-management-05-ko.png\" alt=\"로직 앱 이벤트 캡쳐\"></p>\n<p>그리고, 실제 이벤트 메시지 JSON 개체는 아래와 같이 생겼습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/event-driven-keyvault-secrets-rotation-management-06-ko.png\" alt=\"로직 앱 이벤트 메시지 페이로드\"></p>\n<p><code class=\"language-text\">data</code> 속성 안에 보면 <code class=\"language-text\">ObjectName</code>이라고 있는데, 바로 이것이 시크릿 이름이고, 이 값을 앞으로 구현할 애저 펑션으로 보내서 해당 시크릿 이름에 대해서만 필요한 버전만 남겨두고 나머지를 비활성화 시키도록 할 예정입니다. 이제 애저 펑션의 구현을 살펴보도록 하겠습니다.</p>\n<h2 id=\"애저-펑션을-통해-특정-시크릿에-대해서만-로테이션-관리하기\"><a href=\"#%EC%95%A0%EC%A0%80-%ED%8E%91%EC%85%98%EC%9D%84-%ED%86%B5%ED%95%B4-%ED%8A%B9%EC%A0%95-%EC%8B%9C%ED%81%AC%EB%A6%BF%EC%97%90-%EB%8C%80%ED%95%B4%EC%84%9C%EB%A7%8C-%EB%A1%9C%ED%85%8C%EC%9D%B4%EC%85%98-%EA%B4%80%EB%A6%AC%ED%95%98%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>애저 펑션을 통해 특정 시크릿에 대해서만 로테이션 관리하기</h2>\n<p><a href=\"/developerkorea/posts/2021/02/23/keyvault-secrets-rotation-management-in-bulk/\">지난 포스트</a>의 구현 내용과 크게 다르지 않지만, 이번에는 특정 시크릿에 대해서만 처리를 하는 내용이므로 펑션의 구현 내용이 살짝 간결해집니다. 먼저 새 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-bindings-http-webhook-trigger?tabs=csharp&#x26;WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">HTTP 트리거</a>를 하나 생성합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist108051731\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-01-func-new-http-trigger-sh\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-shell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-01-func-new-http-trigger-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-01-func-new-http-trigger-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\">func new --name DisableSecretHttpTrigger --template HttpTrigger --language C#</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e/raw/4f10f0acc014cb26bfa7e1cfa98181852ab8a922/01-func-new-http-trigger.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e#file-01-func-new-http-trigger-sh\">01-func-new-http-trigger.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>기본 템플릿을 이용해 HTTP 트리거를 만들었습니다. 이제 이 펑션 메소드의 <code class=\"language-text\">HttpTrigger</code> 바인딩 설정을 아래와 같이 바꿉니다. HTTP 메소드는 <code class=\"language-text\">POST</code> 하나로 한정하고, 라우팅 URL을 <code class=\"language-text\">secrets/{name}/disable/{count:int?}</code> 처럼 바꿉니다 (line #5). 라우팅 URL에 보면 <code class=\"language-text\">{name}</code>, <code class=\"language-text\">{count:int?}</code> 같은 플레이스홀더 두 개가 보이는데, 이는 바로 <code class=\"language-text\">string name</code>, <code class=\"language-text\">int? count</code> 같은 파라미터 변수로 치환시킬 수 있습니다 (line #6).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist108051731\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-disable-secret-http-trigger-01-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">DisableSecretHttpTrigger</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>DisableSecretHttpTrigger<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">Run</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-LC5\" class=\"blob-code blob-code-inner js-file-line highlighted\">        [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Function</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>POST<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>secrets/{name}/disable/{count:int?}<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-LC6\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-k\">string</span> <span class=\"pl-en\">name</span>, <span class=\"pl-k\">int</span>? <span class=\"pl-en\">count</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-01-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e/raw/4f10f0acc014cb26bfa7e1cfa98181852ab8a922/02-disable-secret-http-trigger-01.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e#file-02-disable-secret-http-trigger-01-cs\">02-disable-secret-http-trigger-01.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>환경 변수를 통해 아래 두 값을 받아옵니다. 하나는 애저 키 저장소에 접근할 수 있는 URI이고, 다른 하나는 애저 키 저장소 인스턴스를 호스팅하는 테넌트의 ID값입니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist108051731\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-disable-secret-http-trigger-02-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-02-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-02-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Get the KeyVault URI</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-02-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-02-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">uri</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Environment</span>.<span class=\"pl-en\">GetEnvironmentVariable</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>KeyVault__Uri<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-02-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-02-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-02-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-02-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Get the tenant ID where the KeyVault lives</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-02-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-02-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">tenantId</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Environment</span>.<span class=\"pl-en\">GetEnvironmentVariable</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>KeyVault__TenantId<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e/raw/4f10f0acc014cb26bfa7e1cfa98181852ab8a922/02-disable-secret-http-trigger-02.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e#file-02-disable-secret-http-trigger-02-cs\">02-disable-secret-http-trigger-02.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>다음으로는 애저 키 저장소에 접근할 수 있는 <code class=\"language-text\">SecretClient</code> 인스턴스를 생성한다. 이 때 인증 옵션을 <code class=\"language-text\">DefaultAzureCredentialOptions</code> 인스턴스를 통해 제공해야 하는데, 만약 개발하려는 로컬 컴퓨터에서 애저에 로그인한 계정이 여러 개의 테넌트 정보를 갖고 있다면, 아래와 같이 명시적으로 테넌트 ID 값을 지정해 줘야 하는데요, 그렇지 않으면 인증 에러가 발생합니다 (line #4-6).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist108051731\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-disable-secret-http-trigger-03-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Set the tenant ID, in case your account has multiple tenants logged in</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">options</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">DefaultAzureCredentialOptions</span>()</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-LC4\" class=\"blob-code blob-code-inner js-file-line highlighted\">            <span class=\"pl-smi\">SharedTokenCacheTenantId</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">tenantId</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-LC5\" class=\"blob-code blob-code-inner js-file-line highlighted\">            <span class=\"pl-smi\">VisualStudioTenantId</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">tenantId</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-LC6\" class=\"blob-code blob-code-inner js-file-line highlighted\">            <span class=\"pl-smi\">VisualStudioCodeTenantId</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">tenantId</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">        };</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-03-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">client</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">SecretClient</span>(<span class=\"pl-k\">new</span> <span class=\"pl-k\">Uri</span>(<span class=\"pl-smi\">uri</span>), <span class=\"pl-k\">new</span> <span class=\"pl-k\">DefaultAzureCredential</span>(<span class=\"pl-smi\">options</span>));</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e/raw/4f10f0acc014cb26bfa7e1cfa98181852ab8a922/02-disable-secret-http-trigger-03.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e#file-02-disable-secret-http-trigger-03-cs\">02-disable-secret-http-trigger-03.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>시크릿 이름을 이미 알고 있기 때문에 아래와 같이 직접 이름을 호출해서 모든 시크릿 버전을 가져옵니다. 단, 활성화 된 것만 가져오면 되므로 아래와 같이 <code class=\"language-text\">WhereAwait</code> 구문으로 필터링을 하고 (line #5), 또한 <code class=\"language-text\">OrderByDescendingAwait</code> 구문을 이용해 시간의 역순으로 정렬해서 가장 최근 것이 맨 앞으로 오게끔 처리합니다 (line #6).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist108051731\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-disable-secret-http-trigger-04-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Get the all versions of the given secret</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Filter only enabled versions</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Sort by the created date in a reverse order</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">versions</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">await</span> <span class=\"pl-smi\">client</span>.<span class=\"pl-en\">GetPropertiesOfSecretVersionsAsync</span>(<span class=\"pl-smi\">name</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-LC5\" class=\"blob-code blob-code-inner js-file-line highlighted\">                                   .<span class=\"pl-en\">WhereAwait</span>(<span class=\"pl-en\">p</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">ValueTask</span>&lt;<span class=\"pl-k\">bool</span>&gt;(<span class=\"pl-smi\">p</span>.<span class=\"pl-smi\">Enabled</span>.<span class=\"pl-en\">GetValueOrDefault</span>() <span class=\"pl-k\">==</span> <span class=\"pl-c1\">true</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-LC6\" class=\"blob-code blob-code-inner js-file-line highlighted\">                                   .<span class=\"pl-en\">OrderByDescendingAwait</span>(<span class=\"pl-en\">p</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">ValueTask</span>&lt;<span class=\"pl-k\">DateTimeOffset</span>&gt;(<span class=\"pl-smi\">p</span>.<span class=\"pl-smi\">CreatedOn</span>.<span class=\"pl-en\">GetValueOrDefault</span>()))</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">                                   .<span class=\"pl-en\">ToListAsync</span>()</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-04-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">                                   .<span class=\"pl-en\">ConfigureAwait</span>(<span class=\"pl-c1\">false</span>);</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e/raw/4f10f0acc014cb26bfa7e1cfa98181852ab8a922/02-disable-secret-http-trigger-04.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e#file-02-disable-secret-http-trigger-04-cs\">02-disable-secret-http-trigger-04.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>만약 해당 시크릿에는 활성화된 버전이 없다면, 더이상 처리할 것이 없으므로 <code class=\"language-text\">AcceptedResult</code> 인스턴스를 반환하는 것으로 펑션을 끝냅니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist108051731\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-disable-secret-http-trigger-05-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-05-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-05-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Do nothing if there is no version enabled</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-05-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-05-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span><span class=\"pl-smi\">versions</span>.<span class=\"pl-en\">Any</span>())</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-05-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-05-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-05-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-05-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">return</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">AcceptedResult</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-05-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-05-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e/raw/4f10f0acc014cb26bfa7e1cfa98181852ab8a922/02-disable-secret-http-trigger-05.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e#file-02-disable-secret-http-trigger-05-cs\">02-disable-secret-http-trigger-05.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>기본적으로 로테이션 관리를 하기 위해서는 버전이 최소 두 개가 필요하므로, 만약 <code class=\"language-text\">count</code> 값이 주어지지 않았다면 <code class=\"language-text\">2</code>를 기본값으로 해서 <code class=\"language-text\">count</code> 값을 초기화시킵니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist108051731\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-disable-secret-http-trigger-06-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-smalltalk  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-06-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-06-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">        if (!count.<span class=\"pl-c1\">HasValue</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-06-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-06-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-06-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-06-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">            count <span class=\"pl-k\">=</span> <span class=\"pl-c1\">2</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-06-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-06-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e/raw/4f10f0acc014cb26bfa7e1cfa98181852ab8a922/02-disable-secret-http-trigger-06.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e#file-02-disable-secret-http-trigger-06-cs\">02-disable-secret-http-trigger-06.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>현재 활성화된 시크릿 버전이 주어진 카운트 값 보다 많지 않다면 더이상 처리할 것이 없으므로 마찬가지로 <code class=\"language-text\">AcceptedResult</code> 인스턴스를 반환하고 펑션을 끝냅니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist108051731\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-disable-secret-http-trigger-07-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-07-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-07-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Do nothing if there is only given number of versions enabled</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-07-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-07-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">if</span> (<span class=\"pl-smi\">versions</span>.<span class=\"pl-smi\">Count</span> <span class=\"pl-k\">&lt;</span> <span class=\"pl-smi\">count</span>.<span class=\"pl-smi\">Value</span> <span class=\"pl-k\">+</span> <span class=\"pl-c1\">1</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-07-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-07-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-07-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-07-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">return</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">AcceptedResult</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-07-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-07-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e/raw/4f10f0acc014cb26bfa7e1cfa98181852ab8a922/02-disable-secret-http-trigger-07.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e#file-02-disable-secret-http-trigger-07-cs\">02-disable-secret-http-trigger-07.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>이제 남은 시크릿 버전을 대상으로 비활성화 처리를 해야 합니다. 주어진 <code class=\"language-text\">count</code> 값 만큼의 최신 버전을 건너뛰고 그 다음부터 처리합니다 (line #2). 그리고 Enabled 값을 false로 변경하고 (line #7), 업데이트합니다 (line #9).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist108051731\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-disable-secret-http-trigger-08-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Disable all versions except the first (latest) given number of versions</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-LC2\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">candidates</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">versions</span>.<span class=\"pl-en\">Skip</span>(<span class=\"pl-smi\">count</span>.<span class=\"pl-smi\">Value</span>).<span class=\"pl-en\">ToList</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">results</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">List</span>&lt;<span class=\"pl-k\">SecretProperties</span>&gt;();</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-smi\">results</span>.<span class=\"pl-en\">AddRange</span>(<span class=\"pl-smi\">versions</span>.<span class=\"pl-en\">Take</span>(<span class=\"pl-smi\">count</span>.<span class=\"pl-smi\">Value</span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">foreach</span> (<span class=\"pl-k\">var</span> <span class=\"pl-en\">candidate</span> <span class=\"pl-k\">in</span> <span class=\"pl-smi\">candidates</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-LC7\" class=\"blob-code blob-code-inner js-file-line highlighted\">            <span class=\"pl-smi\">candidate</span>.<span class=\"pl-smi\">Enabled</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">false</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-LC9\" class=\"blob-code blob-code-inner js-file-line highlighted\">            <span class=\"pl-k\">var</span> <span class=\"pl-en\">response</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">await</span> <span class=\"pl-smi\">client</span>.<span class=\"pl-en\">UpdateSecretPropertiesAsync</span>(<span class=\"pl-smi\">candidate</span>).<span class=\"pl-en\">ConfigureAwait</span>(<span class=\"pl-c1\">false</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-smi\">results</span>.<span class=\"pl-en\">Add</span>(<span class=\"pl-smi\">response</span>.<span class=\"pl-smi\">Value</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-08-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e/raw/4f10f0acc014cb26bfa7e1cfa98181852ab8a922/02-disable-secret-http-trigger-08.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e#file-02-disable-secret-http-trigger-08-cs\">02-disable-secret-http-trigger-08.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>마지막으로 처리 결과를 저장한 변수를 응답 개체에 실어 반환합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist108051731\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-disable-secret-http-trigger-09-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">res</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">ContentResult</span>()</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-smi\">Content</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">JsonConvert</span>.<span class=\"pl-en\">SerializeObject</span>(<span class=\"pl-smi\">results</span>, <span class=\"pl-smi\">Formatting</span>.<span class=\"pl-smi\">Indented</span>),</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-smi\">ContentType</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>application/json<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-smi\">StatusCode</span> <span class=\"pl-k\">=</span> (<span class=\"pl-k\">int</span>)<span class=\"pl-smi\">HttpStatusCode</span>.<span class=\"pl-smi\">OK</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">        };</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">return</span> <span class=\"pl-smi\">res</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-02-disable-secret-http-trigger-09-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e/raw/4f10f0acc014cb26bfa7e1cfa98181852ab8a922/02-disable-secret-http-trigger-09.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/948385359cc739a48ad5afdf07db932e#file-02-disable-secret-http-trigger-09-cs\">02-disable-secret-http-trigger-09.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>이렇게 해서 애저 펑션 쪽의 구현은 끝났습니다. 이제 이를 애저로 배포하고 난 후 로직 앱에 연동시켜 보겠습니다.</p>\n<h2 id=\"애저-로직-앱과-애저-펑션-연동\"><a href=\"#%EC%95%A0%EC%A0%80-%EB%A1%9C%EC%A7%81-%EC%95%B1%EA%B3%BC-%EC%95%A0%EC%A0%80-%ED%8E%91%EC%85%98-%EC%97%B0%EB%8F%99\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>애저 로직 앱과 애저 펑션 연동</h2>\n<p>앞서 만들어 둔 애저 로직 앱 인스턴스에 아래와 같이 HTTP 액션과 응답 액션을 추가합니다. 애저 펑션 엔드포인트를 호출할 때 <code class=\"language-text\">ObjectName</code> 값과 <code class=\"language-text\">2</code>를 라우팅 파라미터로 추가한 것이 보일 겁니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/event-driven-keyvault-secrets-rotation-management-07-ko.png\" alt=\"로직 앱 추가 액션\"></p>\n<p>이제 애저 키 저장소로부터 애저 이벤트그리드, 로직 앱, 애저 펑션을 이용한 종단간 프로세스 통합 작업은 끝났습니다. 실제로 이 워크플우를 실행시켜 볼까요?</p>\n<h2 id=\"종단간-테스트--애저-키-저장소-시크릿-버전-추가\"><a href=\"#%EC%A2%85%EB%8B%A8%EA%B0%84-%ED%85%8C%EC%8A%A4%ED%8A%B8--%EC%95%A0%EC%A0%80-%ED%82%A4-%EC%A0%80%EC%9E%A5%EC%86%8C-%EC%8B%9C%ED%81%AC%EB%A6%BF-%EB%B2%84%EC%A0%84-%EC%B6%94%EA%B0%80\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>종단간 테스트 – 애저 키 저장소 시크릿 버전 추가</h2>\n<p>앞서 구현한 모든 통합 워크플로우를 실행시키기 위해서는 애저 키 저장소 인스턴스에 새 시크릿 버전을 추가해 보면 됩니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/event-driven-keyvault-secrets-rotation-management-08-ko.png\" alt=\"애저 키 저장소 시크릿 버전 리스트\"></p>\n<p>아래와 같이 애저 키 저장소 인스턴스에 새 시크릿 버전을 추가해 보겠습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/event-driven-keyvault-secrets-rotation-management-09-ko.png\" alt=\"애저 키 저장소 새 시크릿 버전 추가\"></p>\n<p>아래와 같이 새 버전이 추가된 것이 보이나요?</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/event-driven-keyvault-secrets-rotation-management-10-ko.png\" alt=\"애저 키 저장소 새 시크릿 버전 추가 결과\"></p>\n<p>그리고 새 버전이 추가됐을 때 이벤트 그리드를 통해 로직 앱으로 받은 이벤트 데이터는 아래와 같습니다. <code class=\"language-text\">ObjectName</code> 값과, 새로 생성된 시크릿 버전 값이 위와 같은 것을 확인하셨나요?</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/event-driven-keyvault-secrets-rotation-management-11-ko.png\" alt=\"로직 앱 실행 결과\"></p>\n<p>이 로직 앱을 통해 애저 펑션을 호출하고 해당 시크릿의 로테이션 처리 결과가 적용된 애저 키 저장소를 살펴 보면 최신 두 버전을 제외하고 나머지는 모두 비활성화 상태로 바뀐 것이 보입니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/event-driven-keyvault-secrets-rotation-management-12-ko.png\" alt=\"애저 키 저장소 시크릿 버전 비활성화\"></p>\n<br/>\n<hr>\n<p>지금까지 <a href=\"https://docs.microsoft.com/ko-kr/azure/key-vault/general/overview?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 키 저장소</a> 인스턴스에 새 <a href=\"https://docs.microsoft.com/ko-kr/azure/key-vault/secrets/about-secrets?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">시크릿</a> 버전이 추가되는 이벤트를 캡쳐해서, 해당 시크릿만 대상으로 <a href=\"https://docs.microsoft.com/ko-kr/azure/app-service/app-service-key-vault-references?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813#rotation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">버전 로테이션 관리</a>를 하는 방법을 <a href=\"https://docs.microsoft.com/ko-kr/azure/event-grid/overview?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 이벤트그리드</a>, <a href=\"https://docs.microsoft.com/ko-kr/azure/logic-apps/logic-apps-overview?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 로직 앱</a>, <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>을 이용해서 구현해 보았습니다. 여러분의 실무에서도 이와 비슷한 방식으로 이벤트를 캡쳐해서 처리하게 하는 방식을 도입해 본다면 꽤 유용할 것입니다.</p>\n<h2 id=\"더-궁금하다면\"><a href=\"#%EB%8D%94-%EA%B6%81%EA%B8%88%ED%95%98%EB%8B%A4%EB%A9%B4\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>더 궁금하다면...</h2>\n<ul>\n<li>애저 클라우드에 관심이 있으신가요? ➡️ <a href=\"https://azure.microsoft.com/ko-kr/free/?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">무료 애저 계정 생성하기</a></li>\n<li>애저 클라우드 무료 온라인 강의 코스를 들어 보세요! ➡️ <a href=\"https://docs.microsoft.com/ko-kr/learn/?WT.mc_id=dotnet-17246-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Learn</a></li>\n<li>마이크로소프트 개발자 유튜브 채널 ➡️ <a href=\"https://www.youtube.com/channel/UCdgR-b2t7Byu_UGrHnu-T0g\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Developer Korea</a></li>\n</ul>\n","humanTime":"02 March 2021","datetime":"Tue Mar 02 2021 12:00:00 UTC+00:00","canonical_url":"https://blog.aliencube.org/ko/2021/02/24/event-driven-keyvault-secrets-rotation-management/","timeToRead":15,"tags":[{"id":"azure-keyvault","title":"azure-keyvault","path":"/tags/azure-keyvault/"},{"id":"azure-eventgrid","title":"azure-eventgrid","path":"/tags/azure-eventgrid/"},{"id":"azure-logic-apps","title":"azure-logic-apps","path":"/tags/azure-logic-apps/"},{"id":"azure-functions","title":"azure-functions","path":"/tags/azure-functions/"},{"id":"azure-sdk","title":"azure-sdk","path":"/tags/azure-sdk/"}],"category":{"id":"Azure","title":"Azure","path":"/categories/azure/","belongsTo":{"totalCount":11,"edges":[{"node":{"title":"애저 Bicep 되짚어보기","path":"/posts/2021/04/27/bicep-refreshed/"}},{"node":{"title":"애저 펑션 프록시 기능을 이용한 Open API 확장 기능 하위 호환성 유지하기","path":"/posts/2021/03/16/openapi-extension-to-support-azure-functions-v1/"}},{"node":{"title":"애저 펑션에 Open API 활성화 시키기","path":"/posts/2021/03/09/enabling-openapi-on-azure-functions/"}},{"node":{"title":"이벤트 기반 애저 키 저장소 시크릿 로테이션 관리","path":"/posts/2021/03/02/event-driven-keyvault-secrets-rotation-management/"}}]}},"author":[{"id":"justin-yoo","name":"유저스틴","image":{"type":"image","mimeType":"image/png","src":"/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png","size":{"width":500,"height":500},"sizes":"(max-width: 500px) 100vw, 500px","srcset":["/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png 500w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 500 500' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-6a0325b746fa0b3948747e4a6f689de9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-6a0325b746fa0b3948747e4a6f689de9)' width='500' height='500' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC%2baJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVRo3pWZd1RT67b2ueccy7YgHQKE0HsvYkdFsaFYEKUI0nsnlPSEhBI6offeISgdpPeQ0JFi3%2bfse84Yt/x3v7%2b/udaCiLq3d9893rH2Soz4/J75zPm%2bK0jMz68sLq4tLa0LhVvLy9srK7tra%2b/Ea339/fr6h0Pr459Za2sfflyrq%2b/R9W5lZW95eVck2hGJtoWwlt4Kl7YEgk3B4oZgYWNxfm1hfm1%2bbmVudnl2RjgzvTQ9JZiaXJwYnx8fmxsbnR59M/VmZHJ4aHxocGyg/43E7KxoYWFtEf6yYFMofLu8vLO6undIPQKwsYGtTxsbH9H1CVugFbv%2bEcNhmAOA9ysr%2bwzLwm0RLATg7ZJga2lxEwVYX5j7HYDJiYWJcQCYAYCR4QkAGBwYRQBmZoTz86sLC%2bvAAADgCgBg0lHR2FWs%2b8NhgMMkf6YO3wCIdpdFCAD8o0tLW8hCAUAJCrA6PwcAIgCYmRYDzI%2bNzmIVAIb9CgDAHHx6HgGAnwIAWIpQ48WW/47oP2L4Qes7uPnxTQRAiKYIAxBsIgCLKMB%2bhEQ/VAADmP4mQtPTwtnZFWCAvwk/CH4cBnBY9%2bbmZ/T6M4ADie/gw7u7v%2b3t/fv29j/evfsn3Ozs/AZgIF0kgujvIgDLSAWQNhAiPXAAsLEIFYAegArMrs7NrmAV%2bBZgDgP4WoHx8YWpKYRhfn4N2kBcASz0IBpdn7HrH6kHcTs7/4C1t/fPmZnVzs7%2bxERaRHhMZERscFB4R0cvqAS58Ke7u/8OACLE%2b10hLAAQHDQx0gAYwCoCMLPyuxWANvimAqOjc5OTSwAAFTgE8B6z/xDA55%2bE5/Pn/%2bofmLK/ftPN1cPh5m0pyVOy0lLysjLSZ87ISksrKSiYGJmctbF95uKal1O4urK3ufVFKNwRLu3nRyhAABaRCiANcNDEfxQhAIA%2bPgAYn1iYmRGB/Yd7AG2Aj/%2bremwKra19rK5uuXL56i/HjkqePIFIl5ORg/9JSkqePi156uSpEyeP/O1vf/nLv0lISMhISz9%2b5NzSzN/Z/vvmxuclGEECFGBxc2FxHRtBUAHU/p/1wFcArInF6rExinUwqv5/wXi3908ul6evoycvI62moqyGV1FTVVFSkMMpKSgpIjVQVJBXUkTupM5ISkvB5fQvx49rENSfI9UogmqA90uo/Wj7rs8jHbyKzlCsAZamJg/vA1gFJr%2bOUdjFBIKv3qObwOH8fDxg%2bHx4YfZDpqOjE1SUFPE4JXW8ihZBTVdLw0BHSwOvoqmmqqmmoq6KwysrAg9ccYoKCvKysIDqxC/Hjx7566kTv2SkZ29ufATFSAMsiNVDBZZnp0UzU1/tB/UHANPYPrBfAWz/Ent/aIB%2bB/ANA0wbaMem5ld6unog10BXRx90q6nqa6pdtja%2bYWty46zR3QtmD%2b0s7cx17cx1zhtpauNxyggJDhjOSJ6CjP1y7Mjtm7dGhqfWoA6Lm0h%2b9gFW5iA/06LpKaE4PBjAQQMgIwgq0N83IoGdIA7UY/vux9%2brwKfD9m9tfREt7121u66BV9XX1jLS0bA21HK5aUv2f5gW4VJAdK2keFWRX1QnuWUF3MsLvMvxvuVlb37ZmKBPUFaSl4UmgTqcPnnizOmTgESMjYdBhPTu/BqqHhpgeWZaiNovENuPqv86Q/cjBOoPjH9/kOyPh8z%2bPjzIgui/%2b1dMTCJeWUlbg2Brqh/j6sAjutaz/GZqSXM1CbPlsbOlMeO80MEMPz7dvTXRpSXBpSz4Dv2JrccVAzMNJVVFOXlZGFGAcPzUyROmJiaTE4uwCczNYvavzCD2L00j6vfTP4ocImZGhsX5QdQjFTh0avi6bf1kwQd2d36LjCTiVZS11NVNdQgcP8e%2bzOCxkti5OspaR8pmV6qonjJTGD6ZHzIMALTnnTRXPtWtOfZR4ctrDCcrzwtaVurymorS8lKSp0%2bdgAUDi0ljra2%2bm5leRuyfXp6ZQgCmJgTi/GD2Q96Gh77ajwAcHNSwufn55wDQuLC58rtHFOTkVJUUYeyEPrwynBW0WJe4wU/b7c//MFLyYaRs61WWsJY0XRA%2bnhPYz3nZx3k5kObbRXWrCXVkP7SKvKb3yAx3QUNWT0laRvIk/Hf0yN9winItzZ2w34F0dP5A%2bpfE9ovH//DQ1y0M1Pf1DiEAm5sf0Ov%2bYeEnAHBY%2bPT5P5nMdGnJU1oa6udNdcuIz0YLI9Y6OO%2bGC98PFX8YKf80Vv32dZ6wjjpdHDmRHzKWGzyaEzTE9eNTXGtD7qU8sk64Zex7XuO%2bsdI1HUVteaQIUlJSsEU43b%2b/ItqZnoThA0v43fA5sH9c3L6wenv2AT4ebFuff74QgE//ERwcKS8jpaul%2beT62epEt4mS%2bJ3%2bvHeDRR9Hyj6%2bqfgwUrnawp3ixUzyIt9kBY7lBI3nhw2kercSHxd5XmU6msc7GEZc03M2V7ljqHSOIIOTkTxzRvKvf/k3C3Mz5PwzvYzaD%2bERHLYf1I8MTw4Nfk1/X%2b9wz%2btBiR%2bPDD9JP3wYpqez83MAMDMy8HS0q6F6CZtT3o%2bUQ3I%2bjVa8Gyxea09bqqdPFccOpgcNpAUOZwSM5YWOZAZ0JroUelxhOprF2utHXtd/bom/a6h4UUNWXf6MtLTU8WPHYK/jd/QIFjYhPOL2PQgPZv/k4IA4PMNg/%2btXAxIHTypfw/Pd/WGAt29/nV/YsLSwUlaUP29t4XHnYh3Lf42fvdtfvDdUujtQsMHPWO/K3uDnLbekjuaE93P8Bzg%2bQ9yACV5kf6pvbdh9jpN1zHV9v4uartZqd4wUoRM0FaRkzpw%2bdeokHDXYTM7K8g54P4XYv392EKsH%2bwf69%2b0H9WIA8Vn/o/jkfHgd7mA4J3e/GlFVweNVcBesLV7cvdyREbHGz1zryhI0ssfLSXMNKW%2bHanfH27aH67f6yuer6RO8qMki4mwlZao0qZvlVxbygP7knNcFbSdTFQd9pfPqMuoKUrCxnT55EtrA7bkbbKkT44tTB/kZfbMPMDQ48aP9r7r7JX58WPmO4TDA%2b/f/amrqxquqahLULE0MA584TFSQ1zvT5moZVWTf3ES/FKI/O9q3hBHekh4z15q3O1Inaslcak6fr%2bc0swJpnne875xzuWjkaK11SRd3RVvhIkFGTfY0jNMzp08DwDNnF9jREO%2bR9kUADoVn/Dv1sLr5fRJ/5mlLfPiB/au%2boVNZSRFmqK6aCsvHca2VtdTArE3yzIv2KGVF8mjBmfFeVazA5rTQN1WsD%2bPNi3XcocyI/uzItID7L25anTfSstAlWOuqWGspWRIULqnL6cufQrZkSQTgsdNDOFBg4Tk8fLDw9Pe9wdRD72L287t6v%2bmBny8YQfB41dk5gFeB85vSbRuDfo7XWkPSXEkMn%2b03Uc0WdBSI2nNmyknD2RHCZs7eUPHOQOlsOb2N%2bKw%2b5klxqGNJ6P02lncT1Yvz4prbeW1rgqytuoINTlLu9C8AAKftB46OS4INUC9u34OdCwP4JjxgPwJwcPj59Geeerff/n1yUmRqbKKqpEBztx9M8elIDapPi%2bFRgkqZoU3ZCUW0QLKXY%2bT9i0muN3lEj4lyyigvttDbnnjLNOK2RaqvYz7RnRv4MOG%2bjaMZ/qy6rA1e9gpBVl/u1LGjR6ECZ62t4IELdgDx9MR6F0s/NjcPq%2b/q7JEQnz3/DABMoZmZFUsrG2sr67iIKJdHD8lkMinUtZbhPt5A6SwnpjKC7lw/63JOn%2bV8sY7sXptHD/d/qa0ko6Uk8%2bCKsf8TO1tTQx2crIOZxh1jVRsNBRtdvJmmsh5OTk9LE4dT1lQndHW8hscAkH5gP5b%2b0R%2b9B/WdHa//DwBooT4vi3Zi3V1unLPKjg%2bK9XMtzM/IjXtcS3rUkh3UWhjdUUSLe37L/5Jh2rPLizXxbEq03w3bR2d1jLXwvi5XWZHOSe73Aq%2bbudho2mvLPjHHXdZSvH/HQVlV%2bemjx1cv2cXFJmC77%2bHhM9A/hs1NsB9T381H1MPqaH%2bFHeY%2b/lmAzS%2bby9vtRN%2bYl8/aqd4zuaEtueT6jLDenMCBwoiZGnIfN6wm4nGe142BrJCewthAt3uThbF1sU/PWxi%2beHCH/sIh2%2btGuutl8j3zoKu6z6zwDgbKMaFBRjrqevD0Iy/d0dwBz2Lf2d/fN9rbsx8eTD2/C9S/7ux41dHevQ8gXoe/4fkRYB15Evj8piCd4vu8Ls59Ni%2b8IyOmkB6w1Zu68TpjujC2j%2bU7xA2eLYl735PZW5CYHeP%2b6wivIc7ZUlP5qZV26mObQp8bPG/7TNdL6c5nI67pP7HWJYYF2hmoEc6ceHDdbnpiYWx0Htt6xer7ekd6Xg%2bJxw6WHPC%2bva27rZUvgX0B%2bLvr9763%2brCx/dvqYF9ugDMv6NFcQbSwMaWCFd5dQBR05k1Xs0aLk0Z48T2ZkV1ZUTBS5%2bqZv46WvKJ5XNaQdzDC5b%2b8Wh/u1BDq1BjxsMTnZuxNk9D7l72fPzqLl9eSOc2IjV0UbMKR880I1rvIzgWjE7P/sHrM%2b/Y2fmtLl4T4S8yfYHzzcvPXLdHGQk16M8V3pjBmqzP9w0jNSHVWRy61jh1ZQfKrogZUkXzqGMHTVWQo1peJqvGccD9bdQcDpYcWmmF3banP7CnOVxMeX/G/ddb5hu0lXeXrBoSzSlLF6dy5%2bfU3w1Ni%2byH9qP374QGAw%2brbWrtamjskfvwG8%2bckG3AmXdnbbM4dSQ%2bf4EWvNjHfD5X818rgfy4Pfhqq3mhOncgMmcqJ2ONnrzeytruz/jHTNF%2baFH/DmHzP4oUZ/pmJckOSVx3Rg%2bd9l/LA9omZqp2GrJ2ump2mcldzx9SUCIn%2b/sFhP/2vX%2b3bjyUH1ENywPvWls7mpvb/A8Chbz8/rtRnD6WFjOVHCuuS3nZnfh5r%2bm2h7%2bObhn6aT4nndVFz5l5vycehmo/Ddf8SdK%2b1pFDvWXrZaDjpyvvZELrInvNlpCGWT5GnvbsV4SJB9rK2spOlwfDA6PjowuHe7et9A%2bnHJg8WHsg9mpxOTH1TY5sE9oXrjwx/TPJhbePLRl/LXAV5gBu4WB632sx611v4abxpoYJR7HFtror%2bZaJxg18yVZM2Us4Z4hGro12czVWvass4GePCLuvme9j3p4b00l%2bmPbZ5ZIw7T5C5gJcJcLwBp%2biDU%2bcEGh5Qj9iPqT/oWsR4SA6mvqG%2bFQDe/QjwY0EO7j%2bsw83W3zdHh%2baLk7rZvnOlUYtVCauN9M2u3PqopwO5sWs9JaKuomV%2b0UIHb6YxvSMlqCzejeNxJdHJOuquBZxDo29bcN2v8Ske7IeWt3TlzqvL2SidDna6PTUjGtrvXSw8I69fDXXzB7DwYDMHNR5R39jQ1tjQWl/XLCH%2bvYN4/QQGWavv1ze/rM4uzZcyu5kvp4oiFmsThXXk2UpySfC9ifqUxbac7aGa3ZH6vdHmrd6q2VLmeD7pFellzvOrjEfnwm4YBdobh9obt5FcYZje0pO3xUvbG2qU5/ImJgSYerAf1IP9r7q/2o/lHrxvakTUN9S3gPq62iaJ1ZX3PzL8iLH6LcPa5hfR%2bFh3sv9YXthSA2WllTFdEtdO9x4sSqhJcO/NS1xqylmozVqsyZkvy3ydFMJ7cYf51M7rnO49feW4u9apntd70oKyXtg56MlbKhxnxMbMzW8MDkwM7u%2b7o2h4EPu7OvftR9V3HqhvxdTX1jRKLKO/bsB%2bDfFHACvwzg91WNv8e28RG556RY2MxbqkmZLY0fwoflpgpudtXtSLjaHq91NNnwT8X9dHREM19Rkx6ZHPbxjinxhplAY4tbF8BnMiom%2bZ2evKnsefqS6pmJgUDgyg4enHehexn9/V39mB2I%2bph/B8p76muv4bABC6jF7FDMh19QP2R9/%2bsujd5vZvo%2b1Nrznewkb6YiNtqoI4xosYK4pZaUvf7Sldayna6ajba2neaa5dyE9rDvAkXzIPO6eX5nyp2Mehg/GyPObJMxu1W/pyjrYmQ4OTI8MzaO%2bOH/Tuvv1o7/J/X31VfXVFrYRoeW//dz6H1o8F%2ba4yq2uA9GFhWtiZGjZZEiNsZszUJE1VJMw3MDb4Oe8GS36dbv401rbdXjOfzx5ixbSHv8h8coX2wCbH7UqR982i4HvhDiZPrPC2uON0InFmdnWgH%2bvd/fSjvYvYj02e/fCA%2btoWkF5b3QDqqyrrKstrJITLe8sog%2bhgrfwQqh95AHJr69fVjS81GQw%2bx3u8OHqsMHKiLH6xhb0GAAMlX8Zq/zHXudVfMVqe3JES2ckIqAx9WOp/p9TXIe/ldfLjs/dMcBfVTj%2b9fnF4eHp4eGZgYLL/d%2bx/Db0rtr%2b%2brqWupglTX42qryirlhCKdkUogwhdy8v7FTh83V8H6VpB1H%2bByD54%2bMTK3LQg%2bmkbw4vP8e3JCJptYKzys/cGCt8PFH0cqXo/WLfcWjjGI/fS/FojHtcG3eF5XeU8PedsTbAhSJvhTl%2b2tenpeTM0NN3fB%2bqhd5HRCenv6uzraO9ta%2b3%2bRn1t8773FbWgvry0qqykAgVA1zKKAQURruyBbgTmW4BlrETLexCh2dmVG/Y3ZGXkFHCqNJ/7dWSPGrL764zAwYLI5U7udh9vr7/gLT9rvS1P0Jg9nBUDB7hKv1sFL67QH1gEXtU/rylnhpe10cQdQb9KmZwU9va8QY894t7txUYnFh6IPqq%2bEYw/pL6ypKhcYkm0u4QCLGG/dTtEAnKxdO1f0QUf23r797KyKmVlnKKCkqqmXmtJ7nB2cEnss8pE1%2bZkn9HyxLWevPVXucL2rPnGzJm6jO7U8MrwJ/neNxMf2Phc0r5piDPFy1kR5G0I8vAY%2bfTx4/EJwevXbzD7QT1qfw9qfxe2Z4H9WNd%2bp76ooFRCINyBtQTrAGB/YQwojHihb%2b6urH2sb2q5c/c2/PO3HrrPvxlfqiGOlhBrSe7FUc5l8c/7CuNE/Jz51qyxShao56eGVsW4MFyv%2btub3DHDm6nJm%2bDlz6nJWCifgZ%2bgr6MFWe/rmxCHB%2bxvb3vd2oLkRxyemqoGLPegvrS4AlNfyCvaBxAzLB2UYgllQBoDfYl1CLyzBACr70sqKtMyODpa6m4BpLmFvaUG2tuerLlack96QE3C8/yIx/Usv56COH56UBvDp4Xuw3S76nPD/JaFlrkGzgyvYIU8y0ub4s787chRGWnJnKw8aGXwHnoXDc%2b%2b/U2NHVh4atDwVJbXHva%2bkFfMyyuQWFzaxtQLDi1QLzioydIBAKIefbm8%2bqGqpp6dlkymJDx44t00sDPbUfm2O3XzVdZcDXk4L7yF9iI32JHtfYv64maCm33A3bN3bXQvG6nbaKlYayhZ4eUuqsteVz9jpKogI6984pdjQYFBsAmAbnTywOh83dLc3dyE2d9aW9NUXVVfWYHMHEx9cWFZIa8E1Ofl5EsIAABdGMl3GN/VBAXbXl3/1NDcwU5lpnA54REhYaS81wMr4yXxG/xUUSt7pipxKCekg%2bFZFfckw%2b9WjNNZ14t6T85qO5/VvmeOv6Apf5Ygd01b3o4gaaypYWxpd/z4sWvX7MDsEShCZ39bK%2by7oJ6P2t%2bGqm%2borKirKK8pQ8ODqS/IL8rP5eVm50kIBG/FANgS/B6JEK0J/ClSB%2bFOUWlRKpedmc3lpLOJCTGMnKaGmu7elABBDWmxjjoPm1pp3Agvsj8ruI3qVhTgkOlhR3909sV5rUtaCpc15G7ryl1UlTTS1rn7NOTYseMXLtj6eHsz6GxQ/Kp7CBgaGzrq69qw8FRV1leg4cHUF/FKC/KLMfXZmTkSC4tbC4K3sBYPMSweFGRxaUewf7MNGOD99Nx6bUMjYn86m5udlpaZmsrlUKjxiawsekR4cZhTX7LPeF74dClxpjJppoY0VhjVlx7QFO9S6H/T57LeZW3cdR2F2waK51TP2JhZ%2bsdlHzl23NLSwt3D1cRY38TYIDQkrLK8DlIEGHW1Laj3teVlNaUlmPelqPcQnrycrNysjGyJ%2bcWt%2bQMG8RIc4kFeQmzWPiwKthuauxLIZBqTwmBRGWxaamZKWlZKakZqGjclOib0hZe7m9szTpR3npd9fbgjn%2bbRkxrwKtW/NyOkLy2I53fHyVLbXk/VwUDlngneWunkLfu75MxWANDV1fH197l//66M1CkFeSlrK3M3Nzc6jQXSoYmBoaS4EvG%2bAPO%2bEKKPqc9Iz5SYW9jEGMQLqQa65gXIS6FoTyDcbe/qpzGTw6PDwmPCiYmx6RkpLDYd%2bhhmEZPDgGrExEW99PHy8PKgJDOo5DiKrzPH7Xq%2b17XSkHulYQ%2byvG56nte7a0K4a6J%2bx5jgaK5hJn88LJzELuo5euwEgUAICPILCPS9fPm8vJyUkqKsJkHFyEDX/trV8LCIvJxCmJ4AwMsrQtXzxOq5aVwEAGXYPAwAC24gOaKV9/1DU9ys3KiYqMjYyERKQgKZGBYRkpaRAtKTU5ip3JTkVCY9mUahkzxfenh5v0jmMBgcFjMlmcEgF9Cj6S5XYm4aedioO5mqOJmr3zJSv22icctA5YKmYkXTGDO34%2bjx03iCZkhYUCwxsrKm%2bvad26dOHiOoKRvqaRnp6xgb6dlduRQcEASxKSmqyM1Goo%2bqz%2bKmZaSlpErMzm/AOsBAALAbaNbRcUFeYWlkTBQYT6IkJNESKQwylU4KiwimMEgZ2Wmp3GR2GgsAklMYrBRGVEyEy3NnTiorK5fLSUsGts3t7YGBfleHi/f0ZJ3MVG8b4a/pqt4yVr%2buKf3o6uWhhX%2bGkfN/OSVD0DLy9PYMjQgpKSvhFZecOX1CXl5WU13VUF/LyEAblqGBjv01u7iYuHzUfpCenoqoT2VzJGbm1jEGZC0gVzB%2bfvFtbUMbMSkBfmgCOZ5ETyLREhnJ1GQOHa7xSbGJ5HgWhw51SM1gQ5DoLAokChg8vTxiiFGZOenQ2XQWrbyyrLCs2DcwwFoHb6sqdUFd4ZoO7qa%2bsq3S0Qg//%2bmt/%2bfsFXNaGqdtdPahs3NweGhcfGx334CegY6k5ElVFSVtTTVDPU3AMDHWMzbWMzU1cHrgmMxkZ2fmprIR9SmsZAQAY8CuS8Ldnv5xTjoXAkNMiiNRE6lMMqxEajyNRU5OAQAKmZFEoiZQmSQmh5aRlZqRlQZZojHJEKrI6LCgEH%2bwH%2bpAppJoLJqX70vbc2cv29lZqCufV5W%2bpC5/TlXqmpZMfWNfIKX2%2bsNAvJbJOXvnh0%2bfhUdH%2bgb49g4O3nNyPHb0ryo4eYIaTleLAFky0NcyNdG3tDABkvO2VnExMRAhDpPNZjAlpmfXYE3NrM4tbAFARXVDbGJcFDEqkQqBIZHpiRR6EkiHGxI9kcGmMtlUeAmJpzPJcAOzKD0rlZuVAmCcNBYSsMhgOovKTmUxWJSCkmImJ%2bX2nRvefj4Xz9mYKUraqMpYyx0JdXmYWzdhae9jfe3pldvuj72T7O8%2bCokM8w3ya%2bvo8A8OOvo3CUUFWQJeSQ2P09fTMDDQMjbSNTMzsLIyRW5MDSLDwricVCaVJoGph8y8GVvMyMkF6fFIZkgUVB/YnEghUgCDmYQAJFNZHBoNqQm4S6YjHyAz2TR2CgMsh80BGBKS4pIoCXQ2HSFn0uqa2109nkVEhTk%2beGCqqmCFk7yqLpWdV%2bvgEnvJweXKHfdQcrFfXJaXf4h3gH9weEhZZUVMfPzxo3%2bRk5UiqCqpKCtqQZCgE1AAC3MjU2M9IwMtczNDfx8fDpMlgXnfwR%2bgMulxSXFUJpXKotCTYdJT6CwS%2bEqixiMA9EQqPQleQgVQZYAHH6BgVyryEopDh06A1JGpiVABeCckPKixtTMiOtLP39v5%2bTNrA10jqSMPzls9D6CbnX943z3WLzYrs%2bpNLKskr6CQSCYHhQfn8PKoLOaJX47ISkuqqSiqKMsTCMp6uppGhjpgvIWFkZGhtqGeBrw0NzcKCwyUGJ8UllXWJlKTYMIkoy6y0KAj7jISqQzQCmkhUWgJMIjgfSrkipZIPQBAC0Uh05LAeLgyktH6MCBjUB9qZHQor6iYnc718HR95vbcxtZW7eSR2zYW956G2j8M9orMTCnpKe9coGTU1DU01re0%2b4eGcDO5KRlcydO/wKaGV1ZQUVbA43Ha2upQBGhiSwtj0K2rhTc20DIxM7h43loiPTsTLGenJ6dw2SncZE46C4IOKkmgGOYNhQiiaSwShZFEpiZAbKB9YSJRkAih3jNIGEAcZC8pDjYK%2bAlAmJBETKIkxhCjo%2bNi84pKn7k9dXV3vXbTQVla%2bp7j87vPol0CGMSUutpXoobedTavqa2zc3J2oaiikkwnZ%2bXny8mekT5zCo%2bTx6soqqoqaWkRDAy0TZAKGFtbmRroaepoqsJLCJJEchqTm5OemceFQwE7ncVOY1JZZBiUCaQ4WEkUZPhgC5IDCwYowgD34D0sBuI3YETFhMcSoyKiQulMAKPCywQSEaIfFhFa09Dy9LlzYHDA46dPrjs4PfaK9wxPC6GUcsv7%2beMfmge2uCVtA0PDY1PT0/MLWfl5%2bcUlOJy81JmTqjh5NVUlANDUUtOHYWqib2FpAgDmZgaaBJwh%2bo5ERk56Rh6Xm5OWkZsOFYDJCA1KTIyJjgtPJMclUePBTqRfkfAg9scDGJkIliPeI9KRGygFDNDQ8KDwqJC4%2bGiYqvGJseGRIZA6eL%2bqtvGF9wu48fb1eu7p/9A9Ni6lIS6ltqhpamTxn00Dm7kVHRPTUxMzc7MLizWNja1d3SoqigAAk1Qdj4NBBBUAAGOYpFamMIiAQUdLTVNDFfY4iZyCLG5uelp2alZ%2bBuxKIBTiQaLDFhYUHRcBIwgWEmukUymJ1AQisosRESomCToBblBCSlRshI%2bfF6iEIgAeHChgw4aahEUE1dQ3hkaGh4QFwBnkicuzGw986PmvqNkt1XzB9Np/1x9InTcAAADfSURBVLxaKahqFwgW5hYFEzOzBaXF/N5%2bPF5ZWuoUVEBDTZlAUNHWUcciZGVtBsvGxgyaGK%2bioK2lJpFTmJ2WyeFmp2YXZKWksyDroJKWTCYmRPsH%2bsTFR0H0kVaGCkC0SHFx6DaMRIuBRAhqkoRudmC550v34NAAYID8wGyFYQoMgcG%2bLW3tJDrNzcMlOi7K0/vFrQcenNJBFq%2brZXBjaed/yjoWKxr5omXhkmi5Z2iIV1w48GYMIiQnI6mqrKCprqKpideB/dhI19TM0NrG/KytpTUcxC1N4E9VVRT%2bPzbiUw29GeqqAAAAAElFTkSuQmCC' /%3e%3c/svg%3e"},"path":"/authors/justin-yoo/"}]}},{"node":{"title":"애저 키 저장소 시크릿 로테이션 관리하기","path":"/posts/2021/02/23/keyvault-secrets-rotation-management-in-bulk/","image":"https://sa0blogs.blob.core.windows.net/aliencube/2021/02/keyvault-secrets-rotation-management-00.png","image_caption":"애저 키 저장소 시크릿 관리하기","description":"이 포스트에서는 애저 키 저장소의 시크릿 값을 로테이션할 때 애저 펑션을 이용해 일정 기간 이상 오래된 시크릿 값을 한 번에 비활성화 시키는 방법에 대해 알아봅니다.","content":"<p>얼마전 <a href=\"https://docs.microsoft.com/ko-kr/azure/key-vault/general/overview?WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 키 저장소</a> 시크릿 값을 <a href=\"https://docs.microsoft.com/ko-kr/azure/app-service/?WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 앱 서비스</a> 혹은 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>에서 참조할 때, 더이상 버전을 명시하지 않아도 된다는 <a href=\"https://azure.microsoft.com/ko-kr/updates/versions-no-longer-required-for-key-vault-references-in-app-service-and-azure-functions/?WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">공지</a>가 있었습니다. 따라서, <a href=\"https://blog.aliencube.org/ko/2020/04/30/3-ways-referencing-azure-key-vault-from-azure-functions/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">지난 포스트</a>에서 언급했던 <a href=\"https://docs.microsoft.com/ko-kr/azure/key-vault/secrets/about-secrets?WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 키 저장소의 시크릿 값</a>을 참조하는 방법들 중 두번째 방법이 이전에는 덜 효율적이었다면 이제는 가장 효율적인 접근 방식이 되었습니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-01-keyvault-reference-txt\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-text  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-01-keyvault-reference-txt-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-01-keyvault-reference-txt-LC1\" class=\"blob-code blob-code-inner js-file-line\">@Microsoft.KeyVault(SecretUri=https://&lt;keyvault_name&gt;.vault.azure.net/secrets/&lt;secret_name&gt;)</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/01-keyvault-reference.txt\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-01-keyvault-reference-txt\">01-keyvault-reference.txt</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>위와 같이 설정하면 애저 앱 서비스와 애저 펑션 앱에서 가장 최신 버전의 시크릿 값을 자동으로 가져와서 보여줍니다. 만약 최신 버전의 시크릿 값이 생성된지 아직 만 하루가 지나지 않았다면, 애저 앱 서비스 혹은 애저 펑션 내부적으로 작동하는 캐싱 메카니즘이 완전히 값을 받아오지 않았을 수도 있기 때문에, 이전 버전과 함께 <a href=\"https://docs.microsoft.com/ko-kr/azure/app-service/app-service-key-vault-references?WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813#rotation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">로테이션</a>을 시켜줘야 합니다. 이 때 로테이션을 위해서는 가급적이면 두 가지 버전 정도로만 활성화 상태로 유지하고 나머지는 비활성화 시켜주는 것이 보안상의 관점에서도 좋습니다.</p>\n<ul>\n<li><strong><em>애저 키 저장소 시크릿 로테이션 관리</em></strong></li>\n<li><a href=\"/developerkorea/posts/2021/03/02/event-driven-keyvault-secrets-rotation-management/\">이벤트 기반 애저 키 저장소 시크릿 로테이션 관리</a></li>\n</ul>\n<p><a href=\"https://docs.microsoft.com/ko-kr/azure/key-vault/general/overview?WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 키 저장소</a>에 저장할 수 있는 시크릿의 갯수는 딱히 제한된 것이 없습니다. 따라서 현업에서 사용하다 보면 굉장히 많은 수의 시크릿을 저장하게 되는데, 이럴 경우 로테이션에 더이상 쓰이지 않는 시크릿 버전을 일일이 찾아 비활성화 시켜주기에는 너무 많을 수 있습니다. 그렇다면, 이를 자동화할 수 있는 방법에는 무엇이 있을까요? 이 포스트에서는 오래되었지만 여전히 활성화 상태로 남아있는 시크릿 버전들을 일괄적으로 비활성화시키는 방법을 애저 펑션으로 구현해 보기로 합니다.</p>\n<blockquote>\n<p>실제 작동하는 코드를 보고 싶으신가요? 이 <a href=\"https://github.com/devkimchi/KeyVault-Reference-Sample/tree/2021-02-17\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">깃헙 리포지토리</a>에서 다운로드 받아 로컬에서 돌려보세요!</p>\n</blockquote>\n<h2 id=\"애저-키-저장소-sdk\"><a href=\"#%EC%95%A0%EC%A0%80-%ED%82%A4-%EC%A0%80%EC%9E%A5%EC%86%8C-sdk\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>애저 키 저장소 SDK</h2>\n<p>애저 키 저장소를 다루는 SDK는 현재 두 가지 버전이 있습니다.</p>\n<ul>\n<li><a href=\"https://www.nuget.org/packages/Microsoft.Azure.KeyVault/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft.Azure.KeyVault</a></li>\n<li><a href=\"https://www.nuget.org/packages/Azure.Security.KeyVault.Secrets/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Azure.Security.KeyVault.Secrets</a></li>\n</ul>\n<p>이 중 전자는 이제 deprecated 된 버전이라서, 후자를 사용하면 됩니다. 이와 더불어 <a href=\"https://www.nuget.org/packages/Azure.Identity/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Azure.Identity</a> SDK도 함께 다운로드 받아 사용하도록 하겠습니다. 애저 펑션 프로젝트를 생성한 후 아래와 같이 두 NuGet 패키지를 설치합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-add-nuget-packages-sh\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-shell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-02-add-nuget-packages-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-add-nuget-packages-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\">dotnet add package Azure.Security.KeyVault.Secrets --version 4.2.0-beta.4</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-add-nuget-packages-sh-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-02-add-nuget-packages-sh-LC2\" class=\"blob-code blob-code-inner js-file-line\">dotnet add package Azure.Identity --version 1.4.0-beta.3</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/02-add-nuget-packages.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-02-add-nuget-packages-sh\">02-add-nuget-packages.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>또한, 키 저장소 SDK 패키지는 <code class=\"language-text\">IAsyncEnumerable</code> 인터페이스를 사용하므로 <a href=\"https://www.nuget.org/packages/System.Linq.Async/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">System.Linq.Async</a> 패키지도 함께 다운로드 받습니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-03-add-nuget-packages-sh\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-shell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-03-add-nuget-packages-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-03-add-nuget-packages-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\">dotnet add package System.Linq.Async --version 4.1.1</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/03-add-nuget-packages.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-03-add-nuget-packages-sh\">03-add-nuget-packages.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<blockquote>\n<p><strong>NOTE</strong>: 애저 펑션은 아직 .NET 5를 지원하지 않으므로 <code class=\"language-text\">System.Linq.Async</code> 5.0.0 버전의 패키지를 설치하지 않도록 조심합니다.</p>\n</blockquote>\n<p>이제 필요한 라이브러리 설치는 다 끝났고, 실제로 펑션 코드를 구현해 볼까요?</p>\n<h2 id=\"오래된-시크릿-버전-비활성화를-위한-애저-펑션-구현\"><a href=\"#%EC%98%A4%EB%9E%98%EB%90%9C-%EC%8B%9C%ED%81%AC%EB%A6%BF-%EB%B2%84%EC%A0%84-%EB%B9%84%ED%99%9C%EC%84%B1%ED%99%94%EB%A5%BC-%EC%9C%84%ED%95%9C-%EC%95%A0%EC%A0%80-%ED%8E%91%EC%85%98-%EA%B5%AC%ED%98%84\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>오래된 시크릿 버전 비활성화를 위한 애저 펑션 구현</h2>\n<p>아래 명령어를 통해 애저 펑션 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-bindings-http-webhook-trigger?tabs=csharp&#x26;WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">HTTP 트리거</a>를 하나 만들겠습니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-04-add-new-httptrigger-sh\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-shell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-04-add-new-httptrigger-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-04-add-new-httptrigger-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\">func new --name BulkDisableSecretsHttpTrigger --template HttpTrigger --language C#</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/04-add-new-httptrigger.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-04-add-new-httptrigger-sh\">04-add-new-httptrigger.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>기본 HTTP 트리거 템플릿으로 펑션이 하나 만들어 졌습니다. 이제 이 펑션 메소드의 <code class=\"language-text\">HttpTrigger</code> 바인딩을 아래와 같이 바꿔보겠습니다. HTTP 메소드는 <code class=\"language-text\">POST</code> 하나로 한정하고, 라우팅 URL을 <code class=\"language-text\">secrets/all/disable</code>로 두었습니다 (line #5).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-secrets-httptrigger-01-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-05-secrets-httptrigger-01-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-secrets-httptrigger-01-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">BulkDisableSecretsHttpTrigger</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-01-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-secrets-httptrigger-01-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-01-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-secrets-httptrigger-01-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>BulkDisableSecretsHttpTrigger<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-01-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-05-secrets-httptrigger-01-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">Run</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-01-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-05-secrets-httptrigger-01-cs-LC5\" class=\"blob-code blob-code-inner js-file-line highlighted\">        [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Function</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>POST<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>secrets/all/disable<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-01-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-05-secrets-httptrigger-01-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-01-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-05-secrets-httptrigger-01-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/05-secrets-httptrigger-01.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-05-secrets-httptrigger-01-cs\">05-secrets-httptrigger-01.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>환경 변수를 통해 아래 두 값을 받아옵니다. 하나는 애저 키 저장소에 접근할 수 있는 URI이고, 다른 하나는 애저 키 저장소 인스턴스를 호스팅하는 테넌트의 ID값입니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-secrets-httptrigger-02-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-02-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-secrets-httptrigger-02-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Get the KeyVault URI</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-02-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-secrets-httptrigger-02-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">uri</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Environment</span>.<span class=\"pl-en\">GetEnvironmentVariable</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>KeyVault__Uri<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-02-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-secrets-httptrigger-02-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-02-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-05-secrets-httptrigger-02-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Get the tenant ID where the KeyVault lives</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-02-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-05-secrets-httptrigger-02-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">tenantId</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Environment</span>.<span class=\"pl-en\">GetEnvironmentVariable</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>KeyVault__TenantId<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/05-secrets-httptrigger-02.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-05-secrets-httptrigger-02-cs\">05-secrets-httptrigger-02.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>다음으로는 애저 키 저장소에 접근할 수 있는 <code class=\"language-text\">SecretClient</code> 인스턴스를 생성합니다. 이 때 인증 옵션을 <code class=\"language-text\">DefaultAzureCredentialOptions</code> 인스턴스를 통해 제공해야 하는데요, 만약 개발하려는 로컬 컴퓨터에서 애저에 로그인한 계정이 여러 개의 테넌트 정보를 갖고 있다면, 아래와 같이 명시적으로 테넌트 ID 값을 지정해 줘야 합니다. 그렇지 않으면 <a href=\"https://github.com/Azure/azure-sdk-for-net/issues/11559#issuecomment-620233531\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">인증 에러</a>가 발생합니다 (line #4-6).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-secrets-httptrigger-03-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-05-secrets-httptrigger-03-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-secrets-httptrigger-03-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Set the tenant ID, in case your account has multiple tenants logged in</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-03-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-secrets-httptrigger-03-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">options</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">DefaultAzureCredentialOptions</span>()</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-03-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-secrets-httptrigger-03-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-03-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-05-secrets-httptrigger-03-cs-LC4\" class=\"blob-code blob-code-inner js-file-line highlighted\">            <span class=\"pl-smi\">SharedTokenCacheTenantId</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">tenantId</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-03-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-05-secrets-httptrigger-03-cs-LC5\" class=\"blob-code blob-code-inner js-file-line highlighted\">            <span class=\"pl-smi\">VisualStudioTenantId</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">tenantId</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-03-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-05-secrets-httptrigger-03-cs-LC6\" class=\"blob-code blob-code-inner js-file-line highlighted\">            <span class=\"pl-smi\">VisualStudioCodeTenantId</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">tenantId</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-03-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-05-secrets-httptrigger-03-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">        };</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-03-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-05-secrets-httptrigger-03-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">client</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">SecretClient</span>(<span class=\"pl-k\">new</span> <span class=\"pl-k\">Uri</span>(<span class=\"pl-smi\">uri</span>), <span class=\"pl-k\">new</span> <span class=\"pl-k\">DefaultAzureCredential</span>(<span class=\"pl-smi\">options</span>));</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/05-secrets-httptrigger-03.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-05-secrets-httptrigger-03-cs\">05-secrets-httptrigger-03.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>이제 모든 시크릿을 가져와서 하나씩 처리를 해야 합니다. 가장 먼저 할 일은 모든 시크릿을 가져오는 것입니다 (line #2-4).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-secrets-httptrigger-04-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-05-secrets-httptrigger-04-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-secrets-httptrigger-04-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Get the all secrets</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-04-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-secrets-httptrigger-04-cs-LC2\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">secrets</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">await</span> <span class=\"pl-smi\">client</span>.<span class=\"pl-en\">GetPropertiesOfSecretsAsync</span>()</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-04-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-secrets-httptrigger-04-cs-LC3\" class=\"blob-code blob-code-inner js-file-line highlighted\">                                  .<span class=\"pl-en\">ToListAsync</span>()</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-04-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-05-secrets-httptrigger-04-cs-LC4\" class=\"blob-code blob-code-inner js-file-line highlighted\">                                  .<span class=\"pl-en\">ConfigureAwait</span>(<span class=\"pl-c1\">false</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-04-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-05-secrets-httptrigger-04-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-04-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-05-secrets-httptrigger-04-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">utcNow</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">DateTimeOffset</span>.<span class=\"pl-smi\">UtcNow</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-04-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-05-secrets-httptrigger-04-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">results</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">Dictionary</span>&lt;<span class=\"pl-k\">string</span>, <span class=\"pl-k\">object</span>&gt;();</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/05-secrets-httptrigger-04.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-05-secrets-httptrigger-04-cs\">05-secrets-httptrigger-04.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>이제 각각의 시크릿을 하나씩 돌면서 모든 버전을 가져옵니다. 단, 활성화 된 것만 가져오면 되므로 아래와 같이 <code class=\"language-text\">WhereAwait</code> 구문으로 필터링을 합니다 (line #7). 또한 <code class=\"language-text\">OrderByDescendingAwait</code> 구문을 이용해 시간의 역순으로 정렬해서 가장 최근 것이 맨 앞으로 오게끔 합니다 (line #8).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-secrets-httptrigger-05-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-05-secrets-httptrigger-05-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-secrets-httptrigger-05-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">foreach</span> (<span class=\"pl-k\">var</span> <span class=\"pl-en\">secret</span> <span class=\"pl-k\">in</span> <span class=\"pl-smi\">secrets</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-05-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-secrets-httptrigger-05-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-05-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-secrets-httptrigger-05-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-c\"><span class=\"pl-c\">//</span> Get the all versions of the given secret</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-05-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-05-secrets-httptrigger-05-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-c\"><span class=\"pl-c\">//</span> Filter only enabled versions</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-05-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-05-secrets-httptrigger-05-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-c\"><span class=\"pl-c\">//</span> Sort by the created date in a reverse order</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-05-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-05-secrets-httptrigger-05-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">var</span> <span class=\"pl-en\">versions</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">await</span> <span class=\"pl-smi\">client</span>.<span class=\"pl-en\">GetPropertiesOfSecretVersionsAsync</span>(<span class=\"pl-smi\">secret</span>.<span class=\"pl-smi\">Name</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-05-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-05-secrets-httptrigger-05-cs-LC7\" class=\"blob-code blob-code-inner js-file-line highlighted\">                                       .<span class=\"pl-en\">WhereAwait</span>(<span class=\"pl-en\">p</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">ValueTask</span>&lt;<span class=\"pl-k\">bool</span>&gt;(<span class=\"pl-smi\">p</span>.<span class=\"pl-smi\">Enabled</span>.<span class=\"pl-en\">GetValueOrDefault</span>() <span class=\"pl-k\">==</span> <span class=\"pl-c1\">true</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-05-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-05-secrets-httptrigger-05-cs-LC8\" class=\"blob-code blob-code-inner js-file-line highlighted\">                                       .<span class=\"pl-en\">OrderByDescendingAwait</span>(<span class=\"pl-en\">p</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">ValueTask</span>&lt;<span class=\"pl-k\">DateTimeOffset</span>&gt;(<span class=\"pl-smi\">p</span>.<span class=\"pl-smi\">CreatedOn</span>.<span class=\"pl-en\">GetValueOrDefault</span>()))</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-05-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-05-secrets-httptrigger-05-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">                                       .<span class=\"pl-en\">ToListAsync</span>()</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-05-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-05-secrets-httptrigger-05-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">                                       .<span class=\"pl-en\">ConfigureAwait</span>(<span class=\"pl-c1\">false</span>);</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/05-secrets-httptrigger-05.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-05-secrets-httptrigger-05-cs\">05-secrets-httptrigger-05.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>만약 해당 시크릿에는 활성화된 버전이 없다면, 더이상 처리할 것이 없으므로 넘어갑니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-secrets-httptrigger-06-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-06-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-secrets-httptrigger-06-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-c\"><span class=\"pl-c\">//</span> Do nothing if there is no version enabled</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-06-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-secrets-httptrigger-06-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span><span class=\"pl-smi\">versions</span>.<span class=\"pl-en\">Any</span>())</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-06-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-secrets-httptrigger-06-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">            {</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-06-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-05-secrets-httptrigger-06-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">                <span class=\"pl-k\">continue</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-06-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-05-secrets-httptrigger-06-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">            }</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/05-secrets-httptrigger-06.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-05-secrets-httptrigger-06-cs\">05-secrets-httptrigger-06.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>만약 해당 시크릿에는 활성화된 버전이 하나뿐이라면, 더이상 처리할 것이 없으므로 넘어갑니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-secrets-httptrigger-07-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-07-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-secrets-httptrigger-07-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-c\"><span class=\"pl-c\">//</span> Do nothing if there is only one version enabled</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-07-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-secrets-httptrigger-07-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">if</span> (<span class=\"pl-smi\">versions</span>.<span class=\"pl-smi\">Count</span> <span class=\"pl-k\">&lt;</span> <span class=\"pl-c1\">2</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-07-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-secrets-httptrigger-07-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">            {</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-07-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-05-secrets-httptrigger-07-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">                <span class=\"pl-k\">continue</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-07-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-05-secrets-httptrigger-07-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">            }</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/05-secrets-httptrigger-07.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-05-secrets-httptrigger-07-cs\">05-secrets-httptrigger-07.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>만약 해당 시크릿의 최신 버전이 생성된지 만 하루가 안 됐다면, 아직 로테이션이 필요하므로 넘어갑니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-secrets-httptrigger-08-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-08-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-secrets-httptrigger-08-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-c\"><span class=\"pl-c\">//</span> Do nothing if the latest version was generated less than a day ago</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-08-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-secrets-httptrigger-08-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">if</span> (<span class=\"pl-smi\">versions</span>.<span class=\"pl-en\">First</span>().<span class=\"pl-smi\">CreatedOn</span>.<span class=\"pl-en\">GetValueOrDefault</span>() <span class=\"pl-k\">&lt;=</span> <span class=\"pl-smi\">utcNow</span>.<span class=\"pl-en\">AddDays</span>(<span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-08-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-secrets-httptrigger-08-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">            {</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-08-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-05-secrets-httptrigger-08-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">                <span class=\"pl-k\">continue</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-08-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-05-secrets-httptrigger-08-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">            }</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/05-secrets-httptrigger-08.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-05-secrets-httptrigger-08-cs\">05-secrets-httptrigger-08.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>이제 남은 시크릿 버전을 대상으로 비활성화 처리를 해야 합니다. 가장 최신의 버전은 건너뛰고 그 다음부터 처리합니다 (line #2). 그리고 <code class=\"language-text\">Enabled</code> 값을 <code class=\"language-text\">false</code>로 변경하고 (line #6), 업데이트합니다 (line #8).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-secrets-httptrigger-09-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-c\"><span class=\"pl-c\">//</span> Disable all versions except the first (latest) one</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC2\" class=\"blob-code blob-code-inner js-file-line highlighted\">            <span class=\"pl-k\">var</span> <span class=\"pl-en\">candidates</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">versions</span>.<span class=\"pl-en\">Skip</span>(<span class=\"pl-c1\">1</span>).<span class=\"pl-en\">ToList</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">var</span> <span class=\"pl-en\">result</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">List</span>&lt;<span class=\"pl-k\">SecretProperties</span>&gt;() { <span class=\"pl-smi\">versions</span>.<span class=\"pl-en\">First</span>() };</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">foreach</span> (<span class=\"pl-k\">var</span> <span class=\"pl-en\">candidate</span> <span class=\"pl-k\">in</span> <span class=\"pl-smi\">candidates</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">            {</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC6\" class=\"blob-code blob-code-inner js-file-line highlighted\">                <span class=\"pl-smi\">candidate</span>.<span class=\"pl-smi\">Enabled</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">false</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC8\" class=\"blob-code blob-code-inner js-file-line highlighted\">                <span class=\"pl-k\">var</span> <span class=\"pl-en\">response</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">await</span> <span class=\"pl-smi\">client</span>.<span class=\"pl-en\">UpdateSecretPropertiesAsync</span>(<span class=\"pl-smi\">candidate</span>).<span class=\"pl-en\">ConfigureAwait</span>(<span class=\"pl-c1\">false</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">                <span class=\"pl-smi\">result</span>.<span class=\"pl-en\">Add</span>(<span class=\"pl-smi\">response</span>.<span class=\"pl-smi\">Value</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">            }</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-smi\">results</span>.<span class=\"pl-en\">Add</span>(<span class=\"pl-smi\">secret</span>.<span class=\"pl-smi\">Name</span>, <span class=\"pl-smi\">result</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-09-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-05-secrets-httptrigger-09-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/05-secrets-httptrigger-09.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-05-secrets-httptrigger-09-cs\">05-secrets-httptrigger-09.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>마지막으로 처리 결과를 저장한 변수를 응답 개체에 실어 반환합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107959289\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-secrets-httptrigger-10-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-10-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-secrets-httptrigger-10-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">res</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">ContentResult</span>()</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-10-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-secrets-httptrigger-10-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-10-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-secrets-httptrigger-10-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-smi\">Content</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">JsonConvert</span>.<span class=\"pl-en\">SerializeObject</span>(<span class=\"pl-smi\">results</span>, <span class=\"pl-smi\">Formatting</span>.<span class=\"pl-smi\">Indented</span>),</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-10-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-05-secrets-httptrigger-10-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-smi\">ContentType</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>application/json<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-10-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-05-secrets-httptrigger-10-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">        };</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-10-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-05-secrets-httptrigger-10-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-10-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-05-secrets-httptrigger-10-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">return</span> <span class=\"pl-smi\">res</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-10-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-05-secrets-httptrigger-10-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-secrets-httptrigger-10-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-05-secrets-httptrigger-10-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9/raw/4088c4870e5b4423365bbc59e2eb8bd74d203865/05-secrets-httptrigger-10.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/75c16e773d9e1c8b8a1d5d5efa37f9c9#file-05-secrets-httptrigger-10-cs\">05-secrets-httptrigger-10.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>이렇게 한 후 실제로 애저 펑션을 실행시켜 보면 가장 최신의 시크릿 버전을 제외한 모든 오래된 버전이 비활성화 된 것을 확인할 수 있는데요, 이 펑션앱에서 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-bindings-http-webhook-trigger?tabs=csharp&#x26;WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">HTTP 트리거</a> 대신 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-bindings-timer?tabs=csharp&#x26;WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">타이머 트리거</a>를 붙인다든가, 아니면 <a href=\"https://docs.microsoft.com/ko-kr/azure/logic-apps/logic-apps-overview?WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 로직 앱</a>을 연동시켜 스케줄링을 걸어 놓는다면 더이상 활성화 되어 있지만 더이상 사용하지 않는 애저 키 저장소의 시크릿 버전들에 대한 걱정을 덜 수 있을 것입니다.</p>\n<hr>\n<p>지금까지 <a href=\"https://docs.microsoft.com/ko-kr/azure/key-vault/general/overview?WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 키 저장소</a>의 시크릿 값을 <a href=\"https://docs.microsoft.com/ko-kr/azure/app-service/?WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 앱 서비스</a> 혹은 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>에서 참조할 때 더이상 사용하지 않는 시크릿 버전을 자동으로 비활성화 시키는 방법에 대해 알아 보았습니다. 이렇게 자동화를 시켜놓으면 추가적인 관리 부담을 줄일 수 있으니 한 번 시도해 보면 좋겠습니다. <a href=\"/developerkorea/posts/2021/03/02/event-driven-keyvault-secrets-rotation-management/\">다음 포스트</a>에서는 시크릿에 새 버전이 추가될 경우 발생하는 이벤트를 통해 특정 시크릿만을 대상으로 로테이션 관리를 하는 방법에 대해 알아보겠습니다.</p>\n<h2 id=\"더-궁금하다면\"><a href=\"#%EB%8D%94-%EA%B6%81%EA%B8%88%ED%95%98%EB%8B%A4%EB%A9%B4\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>더 궁금하다면...</h2>\n<ul>\n<li>애저 클라우드에 관심이 있으신가요? ➡️ <a href=\"https://azure.microsoft.com/ko-kr/free/?WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">무료 애저 계정 생성하기</a></li>\n<li>애저 클라우드 무료 온라인 강의 코스를 들어 보세요! ➡️ <a href=\"https://docs.microsoft.com/ko-kr/learn/?WT.mc_id=dotnet-16807-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Learn</a></li>\n<li>마이크로소프트 개발자 유튜브 채널 ➡️ <a href=\"https://www.youtube.com/channel/UCdgR-b2t7Byu_UGrHnu-T0g\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Developer Korea</a></li>\n</ul>\n","humanTime":"23 February 2021","datetime":"Tue Feb 23 2021 12:00:00 UTC+00:00","canonical_url":"https://blog.aliencube.org/ko/2021/02/17/keyvault-secrets-rotation-management/","timeToRead":10,"tags":[{"id":"azure-keyvault","title":"azure-keyvault","path":"/tags/azure-keyvault/"},{"id":"azure-functions","title":"azure-functions","path":"/tags/azure-functions/"},{"id":"azure-sdk","title":"azure-sdk","path":"/tags/azure-sdk/"},{"id":"secret-management","title":"secret-management","path":"/tags/secret-management/"}],"category":{"id":"Azure","title":"Azure","path":"/categories/azure/","belongsTo":{"totalCount":11,"edges":[{"node":{"title":"애저 Bicep 되짚어보기","path":"/posts/2021/04/27/bicep-refreshed/"}},{"node":{"title":"애저 펑션 프록시 기능을 이용한 Open API 확장 기능 하위 호환성 유지하기","path":"/posts/2021/03/16/openapi-extension-to-support-azure-functions-v1/"}},{"node":{"title":"애저 펑션에 Open API 활성화 시키기","path":"/posts/2021/03/09/enabling-openapi-on-azure-functions/"}},{"node":{"title":"이벤트 기반 애저 키 저장소 시크릿 로테이션 관리","path":"/posts/2021/03/02/event-driven-keyvault-secrets-rotation-management/"}}]}},"author":[{"id":"justin-yoo","name":"유저스틴","image":{"type":"image","mimeType":"image/png","src":"/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png","size":{"width":500,"height":500},"sizes":"(max-width: 500px) 100vw, 500px","srcset":["/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png 500w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 500 500' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-6a0325b746fa0b3948747e4a6f689de9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-6a0325b746fa0b3948747e4a6f689de9)' width='500' height='500' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC%2baJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVRo3pWZd1RT67b2ueccy7YgHQKE0HsvYkdFsaFYEKUI0nsnlPSEhBI6offeISgdpPeQ0JFi3%2bfse84Yt/x3v7%2b/udaCiLq3d9893rH2Soz4/J75zPm%2bK0jMz68sLq4tLa0LhVvLy9srK7tra%2b/Ea339/fr6h0Pr459Za2sfflyrq%2b/R9W5lZW95eVck2hGJtoWwlt4Kl7YEgk3B4oZgYWNxfm1hfm1%2bbmVudnl2RjgzvTQ9JZiaXJwYnx8fmxsbnR59M/VmZHJ4aHxocGyg/43E7KxoYWFtEf6yYFMofLu8vLO6undIPQKwsYGtTxsbH9H1CVugFbv%2bEcNhmAOA9ysr%2bwzLwm0RLATg7ZJga2lxEwVYX5j7HYDJiYWJcQCYAYCR4QkAGBwYRQBmZoTz86sLC%2bvAAADgCgBg0lHR2FWs%2b8NhgMMkf6YO3wCIdpdFCAD8o0tLW8hCAUAJCrA6PwcAIgCYmRYDzI%2bNzmIVAIb9CgDAHHx6HgGAnwIAWIpQ48WW/47oP2L4Qes7uPnxTQRAiKYIAxBsIgCLKMB%2bhEQ/VAADmP4mQtPTwtnZFWCAvwk/CH4cBnBY9%2bbmZ/T6M4ADie/gw7u7v%2b3t/fv29j/evfsn3Ozs/AZgIF0kgujvIgDLSAWQNhAiPXAAsLEIFYAegArMrs7NrmAV%2bBZgDgP4WoHx8YWpKYRhfn4N2kBcASz0IBpdn7HrH6kHcTs7/4C1t/fPmZnVzs7%2bxERaRHhMZERscFB4R0cvqAS58Ke7u/8OACLE%2b10hLAAQHDQx0gAYwCoCMLPyuxWANvimAqOjc5OTSwAAFTgE8B6z/xDA55%2bE5/Pn/%2bofmLK/ftPN1cPh5m0pyVOy0lLysjLSZ87ISksrKSiYGJmctbF95uKal1O4urK3ufVFKNwRLu3nRyhAABaRCiANcNDEfxQhAIA%2bPgAYn1iYmRGB/Yd7AG2Aj/%2bremwKra19rK5uuXL56i/HjkqePIFIl5ORg/9JSkqePi156uSpEyeP/O1vf/nLv0lISMhISz9%2b5NzSzN/Z/vvmxuclGEECFGBxc2FxHRtBUAHU/p/1wFcArInF6rExinUwqv5/wXi3908ul6evoycvI62moqyGV1FTVVFSkMMpKSgpIjVQVJBXUkTupM5ISkvB5fQvx49rENSfI9UogmqA90uo/Wj7rs8jHbyKzlCsAZamJg/vA1gFJr%2bOUdjFBIKv3qObwOH8fDxg%2bHx4YfZDpqOjE1SUFPE4JXW8ihZBTVdLw0BHSwOvoqmmqqmmoq6KwysrAg9ccYoKCvKysIDqxC/Hjx7566kTv2SkZ29ufATFSAMsiNVDBZZnp0UzU1/tB/UHANPYPrBfAWz/Ent/aIB%2bB/ANA0wbaMem5ld6unog10BXRx90q6nqa6pdtja%2bYWty46zR3QtmD%2b0s7cx17cx1zhtpauNxyggJDhjOSJ6CjP1y7Mjtm7dGhqfWoA6Lm0h%2b9gFW5iA/06LpKaE4PBjAQQMgIwgq0N83IoGdIA7UY/vux9%2brwKfD9m9tfREt7121u66BV9XX1jLS0bA21HK5aUv2f5gW4VJAdK2keFWRX1QnuWUF3MsLvMvxvuVlb37ZmKBPUFaSl4UmgTqcPnnizOmTgESMjYdBhPTu/BqqHhpgeWZaiNovENuPqv86Q/cjBOoPjH9/kOyPh8z%2bPjzIgui/%2b1dMTCJeWUlbg2Brqh/j6sAjutaz/GZqSXM1CbPlsbOlMeO80MEMPz7dvTXRpSXBpSz4Dv2JrccVAzMNJVVFOXlZGFGAcPzUyROmJiaTE4uwCczNYvavzCD2L00j6vfTP4ocImZGhsX5QdQjFTh0avi6bf1kwQd2d36LjCTiVZS11NVNdQgcP8e%2bzOCxkti5OspaR8pmV6qonjJTGD6ZHzIMALTnnTRXPtWtOfZR4ctrDCcrzwtaVurymorS8lKSp0%2bdgAUDi0ljra2%2bm5leRuyfXp6ZQgCmJgTi/GD2Q96Gh77ajwAcHNSwufn55wDQuLC58rtHFOTkVJUUYeyEPrwynBW0WJe4wU/b7c//MFLyYaRs61WWsJY0XRA%2bnhPYz3nZx3k5kObbRXWrCXVkP7SKvKb3yAx3QUNWT0laRvIk/Hf0yN9winItzZ2w34F0dP5A%2bpfE9ovH//DQ1y0M1Pf1DiEAm5sf0Ov%2bYeEnAHBY%2bPT5P5nMdGnJU1oa6udNdcuIz0YLI9Y6OO%2bGC98PFX8YKf80Vv32dZ6wjjpdHDmRHzKWGzyaEzTE9eNTXGtD7qU8sk64Zex7XuO%2bsdI1HUVteaQIUlJSsEU43b%2b/ItqZnoThA0v43fA5sH9c3L6wenv2AT4ebFuff74QgE//ERwcKS8jpaul%2beT62epEt4mS%2bJ3%2bvHeDRR9Hyj6%2bqfgwUrnawp3ixUzyIt9kBY7lBI3nhw2kercSHxd5XmU6msc7GEZc03M2V7ljqHSOIIOTkTxzRvKvf/k3C3Mz5PwzvYzaD%2bERHLYf1I8MTw4Nfk1/X%2b9wz%2btBiR%2bPDD9JP3wYpqez83MAMDMy8HS0q6F6CZtT3o%2bUQ3I%2bjVa8Gyxea09bqqdPFccOpgcNpAUOZwSM5YWOZAZ0JroUelxhOprF2utHXtd/bom/a6h4UUNWXf6MtLTU8WPHYK/jd/QIFjYhPOL2PQgPZv/k4IA4PMNg/%2btXAxIHTypfw/Pd/WGAt29/nV/YsLSwUlaUP29t4XHnYh3Lf42fvdtfvDdUujtQsMHPWO/K3uDnLbekjuaE93P8Bzg%2bQ9yACV5kf6pvbdh9jpN1zHV9v4uartZqd4wUoRM0FaRkzpw%2bdeokHDXYTM7K8g54P4XYv392EKsH%2bwf69%2b0H9WIA8Vn/o/jkfHgd7mA4J3e/GlFVweNVcBesLV7cvdyREbHGz1zryhI0ssfLSXMNKW%2bHanfH27aH67f6yuer6RO8qMki4mwlZao0qZvlVxbygP7knNcFbSdTFQd9pfPqMuoKUrCxnT55EtrA7bkbbKkT44tTB/kZfbMPMDQ48aP9r7r7JX58WPmO4TDA%2b/f/amrqxquqahLULE0MA584TFSQ1zvT5moZVWTf3ES/FKI/O9q3hBHekh4z15q3O1Inaslcak6fr%2bc0swJpnne875xzuWjkaK11SRd3RVvhIkFGTfY0jNMzp08DwDNnF9jREO%2bR9kUADoVn/Dv1sLr5fRJ/5mlLfPiB/au%2boVNZSRFmqK6aCsvHca2VtdTArE3yzIv2KGVF8mjBmfFeVazA5rTQN1WsD%2bPNi3XcocyI/uzItID7L25anTfSstAlWOuqWGspWRIULqnL6cufQrZkSQTgsdNDOFBg4Tk8fLDw9Pe9wdRD72L287t6v%2bmBny8YQfB41dk5gFeB85vSbRuDfo7XWkPSXEkMn%2b03Uc0WdBSI2nNmyknD2RHCZs7eUPHOQOlsOb2N%2bKw%2b5klxqGNJ6P02lncT1Yvz4prbeW1rgqytuoINTlLu9C8AAKftB46OS4INUC9u34OdCwP4JjxgPwJwcPj59Geeerff/n1yUmRqbKKqpEBztx9M8elIDapPi%2bFRgkqZoU3ZCUW0QLKXY%2bT9i0muN3lEj4lyyigvttDbnnjLNOK2RaqvYz7RnRv4MOG%2bjaMZ/qy6rA1e9gpBVl/u1LGjR6ECZ62t4IELdgDx9MR6F0s/NjcPq%2b/q7JEQnz3/DABMoZmZFUsrG2sr67iIKJdHD8lkMinUtZbhPt5A6SwnpjKC7lw/63JOn%2bV8sY7sXptHD/d/qa0ko6Uk8%2bCKsf8TO1tTQx2crIOZxh1jVRsNBRtdvJmmsh5OTk9LE4dT1lQndHW8hscAkH5gP5b%2b0R%2b9B/WdHa//DwBooT4vi3Zi3V1unLPKjg%2bK9XMtzM/IjXtcS3rUkh3UWhjdUUSLe37L/5Jh2rPLizXxbEq03w3bR2d1jLXwvi5XWZHOSe73Aq%2bbudho2mvLPjHHXdZSvH/HQVlV%2bemjx1cv2cXFJmC77%2bHhM9A/hs1NsB9T381H1MPqaH%2bFHeY%2b/lmAzS%2bby9vtRN%2bYl8/aqd4zuaEtueT6jLDenMCBwoiZGnIfN6wm4nGe142BrJCewthAt3uThbF1sU/PWxi%2beHCH/sIh2%2btGuutl8j3zoKu6z6zwDgbKMaFBRjrqevD0Iy/d0dwBz2Lf2d/fN9rbsx8eTD2/C9S/7ux41dHevQ8gXoe/4fkRYB15Evj8piCd4vu8Ls59Ni%2b8IyOmkB6w1Zu68TpjujC2j%2bU7xA2eLYl735PZW5CYHeP%2b6wivIc7ZUlP5qZV26mObQp8bPG/7TNdL6c5nI67pP7HWJYYF2hmoEc6ceHDdbnpiYWx0Htt6xer7ekd6Xg%2bJxw6WHPC%2bva27rZUvgX0B%2bLvr9763%2brCx/dvqYF9ugDMv6NFcQbSwMaWCFd5dQBR05k1Xs0aLk0Z48T2ZkV1ZUTBS5%2bqZv46WvKJ5XNaQdzDC5b%2b8Wh/u1BDq1BjxsMTnZuxNk9D7l72fPzqLl9eSOc2IjV0UbMKR880I1rvIzgWjE7P/sHrM%2b/Y2fmtLl4T4S8yfYHzzcvPXLdHGQk16M8V3pjBmqzP9w0jNSHVWRy61jh1ZQfKrogZUkXzqGMHTVWQo1peJqvGccD9bdQcDpYcWmmF3banP7CnOVxMeX/G/ddb5hu0lXeXrBoSzSlLF6dy5%2bfU3w1Ni%2byH9qP374QGAw%2brbWrtamjskfvwG8%2bckG3AmXdnbbM4dSQ%2bf4EWvNjHfD5X818rgfy4Pfhqq3mhOncgMmcqJ2ONnrzeytruz/jHTNF%2baFH/DmHzP4oUZ/pmJckOSVx3Rg%2bd9l/LA9omZqp2GrJ2ump2mcldzx9SUCIn%2b/sFhP/2vX%2b3bjyUH1ENywPvWls7mpvb/A8Chbz8/rtRnD6WFjOVHCuuS3nZnfh5r%2bm2h7%2bObhn6aT4nndVFz5l5vycehmo/Ddf8SdK%2b1pFDvWXrZaDjpyvvZELrInvNlpCGWT5GnvbsV4SJB9rK2spOlwfDA6PjowuHe7et9A%2bnHJg8WHsg9mpxOTH1TY5sE9oXrjwx/TPJhbePLRl/LXAV5gBu4WB632sx611v4abxpoYJR7HFtror%2bZaJxg18yVZM2Us4Z4hGro12czVWvass4GePCLuvme9j3p4b00l%2bmPbZ5ZIw7T5C5gJcJcLwBp%2biDU%2bcEGh5Qj9iPqT/oWsR4SA6mvqG%2bFQDe/QjwY0EO7j%2bsw83W3zdHh%2baLk7rZvnOlUYtVCauN9M2u3PqopwO5sWs9JaKuomV%2b0UIHb6YxvSMlqCzejeNxJdHJOuquBZxDo29bcN2v8Ske7IeWt3TlzqvL2SidDna6PTUjGtrvXSw8I69fDXXzB7DwYDMHNR5R39jQ1tjQWl/XLCH%2bvYN4/QQGWavv1ze/rM4uzZcyu5kvp4oiFmsThXXk2UpySfC9ifqUxbac7aGa3ZH6vdHmrd6q2VLmeD7pFellzvOrjEfnwm4YBdobh9obt5FcYZje0pO3xUvbG2qU5/ImJgSYerAf1IP9r7q/2o/lHrxvakTUN9S3gPq62iaJ1ZX3PzL8iLH6LcPa5hfR%2bFh3sv9YXthSA2WllTFdEtdO9x4sSqhJcO/NS1xqylmozVqsyZkvy3ydFMJ7cYf51M7rnO49feW4u9apntd70oKyXtg56MlbKhxnxMbMzW8MDkwM7u%2b7o2h4EPu7OvftR9V3HqhvxdTX1jRKLKO/bsB%2bDfFHACvwzg91WNv8e28RG556RY2MxbqkmZLY0fwoflpgpudtXtSLjaHq91NNnwT8X9dHREM19Rkx6ZHPbxjinxhplAY4tbF8BnMiom%2bZ2evKnsefqS6pmJgUDgyg4enHehexn9/V39mB2I%2bph/B8p76muv4bABC6jF7FDMh19QP2R9/%2bsujd5vZvo%2b1Nrznewkb6YiNtqoI4xosYK4pZaUvf7Sldayna6ajba2neaa5dyE9rDvAkXzIPO6eX5nyp2Mehg/GyPObJMxu1W/pyjrYmQ4OTI8MzaO%2bOH/Tuvv1o7/J/X31VfXVFrYRoeW//dz6H1o8F%2ba4yq2uA9GFhWtiZGjZZEiNsZszUJE1VJMw3MDb4Oe8GS36dbv401rbdXjOfzx5ixbSHv8h8coX2wCbH7UqR982i4HvhDiZPrPC2uON0InFmdnWgH%2bvd/fSjvYvYj02e/fCA%2btoWkF5b3QDqqyrrKstrJITLe8sog%2bhgrfwQqh95AHJr69fVjS81GQw%2bx3u8OHqsMHKiLH6xhb0GAAMlX8Zq/zHXudVfMVqe3JES2ckIqAx9WOp/p9TXIe/ldfLjs/dMcBfVTj%2b9fnF4eHp4eGZgYLL/d%2bx/Db0rtr%2b%2brqWupglTX42qryirlhCKdkUogwhdy8v7FTh83V8H6VpB1H%2bByD54%2bMTK3LQg%2bmkbw4vP8e3JCJptYKzys/cGCt8PFH0cqXo/WLfcWjjGI/fS/FojHtcG3eF5XeU8PedsTbAhSJvhTl%2b2tenpeTM0NN3fB%2bqhd5HRCenv6uzraO9ta%2b3%2bRn1t8773FbWgvry0qqykAgVA1zKKAQURruyBbgTmW4BlrETLexCh2dmVG/Y3ZGXkFHCqNJ/7dWSPGrL764zAwYLI5U7udh9vr7/gLT9rvS1P0Jg9nBUDB7hKv1sFL67QH1gEXtU/rylnhpe10cQdQb9KmZwU9va8QY894t7txUYnFh6IPqq%2bEYw/pL6ypKhcYkm0u4QCLGG/dTtEAnKxdO1f0QUf23r797KyKmVlnKKCkqqmXmtJ7nB2cEnss8pE1%2bZkn9HyxLWevPVXucL2rPnGzJm6jO7U8MrwJ/neNxMf2Phc0r5piDPFy1kR5G0I8vAY%2bfTx4/EJwevXbzD7QT1qfw9qfxe2Z4H9WNd%2bp76ooFRCINyBtQTrAGB/YQwojHihb%2b6urH2sb2q5c/c2/PO3HrrPvxlfqiGOlhBrSe7FUc5l8c/7CuNE/Jz51qyxShao56eGVsW4MFyv%2btub3DHDm6nJm%2bDlz6nJWCifgZ%2bgr6MFWe/rmxCHB%2bxvb3vd2oLkRxyemqoGLPegvrS4AlNfyCvaBxAzLB2UYgllQBoDfYl1CLyzBACr70sqKtMyODpa6m4BpLmFvaUG2tuerLlack96QE3C8/yIx/Usv56COH56UBvDp4Xuw3S76nPD/JaFlrkGzgyvYIU8y0ub4s787chRGWnJnKw8aGXwHnoXDc%2b%2b/U2NHVh4atDwVJbXHva%2bkFfMyyuQWFzaxtQLDi1QLzioydIBAKIefbm8%2bqGqpp6dlkymJDx44t00sDPbUfm2O3XzVdZcDXk4L7yF9iI32JHtfYv64maCm33A3bN3bXQvG6nbaKlYayhZ4eUuqsteVz9jpKogI6984pdjQYFBsAmAbnTywOh83dLc3dyE2d9aW9NUXVVfWYHMHEx9cWFZIa8E1Ofl5EsIAABdGMl3GN/VBAXbXl3/1NDcwU5lpnA54REhYaS81wMr4yXxG/xUUSt7pipxKCekg%2bFZFfckw%2b9WjNNZ14t6T85qO5/VvmeOv6Apf5Ygd01b3o4gaaypYWxpd/z4sWvX7MDsEShCZ39bK%2by7oJ6P2t%2bGqm%2borKirKK8pQ8ODqS/IL8rP5eVm50kIBG/FANgS/B6JEK0J/ClSB%2bFOUWlRKpedmc3lpLOJCTGMnKaGmu7elABBDWmxjjoPm1pp3Agvsj8ruI3qVhTgkOlhR3909sV5rUtaCpc15G7ryl1UlTTS1rn7NOTYseMXLtj6eHsz6GxQ/Kp7CBgaGzrq69qw8FRV1leg4cHUF/FKC/KLMfXZmTkSC4tbC4K3sBYPMSweFGRxaUewf7MNGOD99Nx6bUMjYn86m5udlpaZmsrlUKjxiawsekR4cZhTX7LPeF74dClxpjJppoY0VhjVlx7QFO9S6H/T57LeZW3cdR2F2waK51TP2JhZ%2bsdlHzl23NLSwt3D1cRY38TYIDQkrLK8DlIEGHW1Laj3teVlNaUlmPelqPcQnrycrNysjGyJ%2bcWt%2bQMG8RIc4kFeQmzWPiwKthuauxLIZBqTwmBRGWxaamZKWlZKakZqGjclOib0hZe7m9szTpR3npd9fbgjn%2bbRkxrwKtW/NyOkLy2I53fHyVLbXk/VwUDlngneWunkLfu75MxWANDV1fH197l//66M1CkFeSlrK3M3Nzc6jQXSoYmBoaS4EvG%2bAPO%2bEKKPqc9Iz5SYW9jEGMQLqQa65gXIS6FoTyDcbe/qpzGTw6PDwmPCiYmx6RkpLDYd%2bhhmEZPDgGrExEW99PHy8PKgJDOo5DiKrzPH7Xq%2b17XSkHulYQ%2byvG56nte7a0K4a6J%2bx5jgaK5hJn88LJzELuo5euwEgUAICPILCPS9fPm8vJyUkqKsJkHFyEDX/trV8LCIvJxCmJ4AwMsrQtXzxOq5aVwEAGXYPAwAC24gOaKV9/1DU9ys3KiYqMjYyERKQgKZGBYRkpaRAtKTU5ip3JTkVCY9mUahkzxfenh5v0jmMBgcFjMlmcEgF9Cj6S5XYm4aedioO5mqOJmr3zJSv22icctA5YKmYkXTGDO34%2bjx03iCZkhYUCwxsrKm%2bvad26dOHiOoKRvqaRnp6xgb6dlduRQcEASxKSmqyM1Goo%2bqz%2bKmZaSlpErMzm/AOsBAALAbaNbRcUFeYWlkTBQYT6IkJNESKQwylU4KiwimMEgZ2Wmp3GR2GgsAklMYrBRGVEyEy3NnTiorK5fLSUsGts3t7YGBfleHi/f0ZJ3MVG8b4a/pqt4yVr%2buKf3o6uWhhX%2bGkfN/OSVD0DLy9PYMjQgpKSvhFZecOX1CXl5WU13VUF/LyEAblqGBjv01u7iYuHzUfpCenoqoT2VzJGbm1jEGZC0gVzB%2bfvFtbUMbMSkBfmgCOZ5ETyLREhnJ1GQOHa7xSbGJ5HgWhw51SM1gQ5DoLAokChg8vTxiiFGZOenQ2XQWrbyyrLCs2DcwwFoHb6sqdUFd4ZoO7qa%2bsq3S0Qg//%2bmt/%2bfsFXNaGqdtdPahs3NweGhcfGx334CegY6k5ElVFSVtTTVDPU3AMDHWMzbWMzU1cHrgmMxkZ2fmprIR9SmsZAQAY8CuS8Ldnv5xTjoXAkNMiiNRE6lMMqxEajyNRU5OAQAKmZFEoiZQmSQmh5aRlZqRlQZZojHJEKrI6LCgEH%2bwH%2bpAppJoLJqX70vbc2cv29lZqCufV5W%2bpC5/TlXqmpZMfWNfIKX2%2bsNAvJbJOXvnh0%2bfhUdH%2bgb49g4O3nNyPHb0ryo4eYIaTleLAFky0NcyNdG3tDABkvO2VnExMRAhDpPNZjAlpmfXYE3NrM4tbAFARXVDbGJcFDEqkQqBIZHpiRR6EkiHGxI9kcGmMtlUeAmJpzPJcAOzKD0rlZuVAmCcNBYSsMhgOovKTmUxWJSCkmImJ%2bX2nRvefj4Xz9mYKUraqMpYyx0JdXmYWzdhae9jfe3pldvuj72T7O8%2bCokM8w3ya%2bvo8A8OOvo3CUUFWQJeSQ2P09fTMDDQMjbSNTMzsLIyRW5MDSLDwricVCaVJoGph8y8GVvMyMkF6fFIZkgUVB/YnEghUgCDmYQAJFNZHBoNqQm4S6YjHyAz2TR2CgMsh80BGBKS4pIoCXQ2HSFn0uqa2109nkVEhTk%2beGCqqmCFk7yqLpWdV%2bvgEnvJweXKHfdQcrFfXJaXf4h3gH9weEhZZUVMfPzxo3%2bRk5UiqCqpKCtqQZCgE1AAC3MjU2M9IwMtczNDfx8fDpMlgXnfwR%2bgMulxSXFUJpXKotCTYdJT6CwS%2bEqixiMA9EQqPQleQgVQZYAHH6BgVyryEopDh06A1JGpiVABeCckPKixtTMiOtLP39v5%2bTNrA10jqSMPzls9D6CbnX943z3WLzYrs%2bpNLKskr6CQSCYHhQfn8PKoLOaJX47ISkuqqSiqKMsTCMp6uppGhjpgvIWFkZGhtqGeBrw0NzcKCwyUGJ8UllXWJlKTYMIkoy6y0KAj7jISqQzQCmkhUWgJMIjgfSrkipZIPQBAC0Uh05LAeLgyktH6MCBjUB9qZHQor6iYnc718HR95vbcxtZW7eSR2zYW956G2j8M9orMTCnpKe9coGTU1DU01re0%2b4eGcDO5KRlcydO/wKaGV1ZQUVbA43Ha2upQBGhiSwtj0K2rhTc20DIxM7h43loiPTsTLGenJ6dw2SncZE46C4IOKkmgGOYNhQiiaSwShZFEpiZAbKB9YSJRkAih3jNIGEAcZC8pDjYK%2bAlAmJBETKIkxhCjo%2bNi84pKn7k9dXV3vXbTQVla%2bp7j87vPol0CGMSUutpXoobedTavqa2zc3J2oaiikkwnZ%2bXny8mekT5zCo%2bTx6soqqoqaWkRDAy0TZAKGFtbmRroaepoqsJLCJJEchqTm5OemceFQwE7ncVOY1JZZBiUCaQ4WEkUZPhgC5IDCwYowgD34D0sBuI3YETFhMcSoyKiQulMAKPCywQSEaIfFhFa09Dy9LlzYHDA46dPrjs4PfaK9wxPC6GUcsv7%2beMfmge2uCVtA0PDY1PT0/MLWfl5%2bcUlOJy81JmTqjh5NVUlANDUUtOHYWqib2FpAgDmZgaaBJwh%2bo5ERk56Rh6Xm5OWkZsOFYDJCA1KTIyJjgtPJMclUePBTqRfkfAg9scDGJkIliPeI9KRGygFDNDQ8KDwqJC4%2bGiYqvGJseGRIZA6eL%2bqtvGF9wu48fb1eu7p/9A9Ni6lIS6ltqhpamTxn00Dm7kVHRPTUxMzc7MLizWNja1d3SoqigAAk1Qdj4NBBBUAAGOYpFamMIiAQUdLTVNDFfY4iZyCLG5uelp2alZ%2bBuxKIBTiQaLDFhYUHRcBIwgWEmukUymJ1AQisosRESomCToBblBCSlRshI%2bfF6iEIgAeHChgw4aahEUE1dQ3hkaGh4QFwBnkicuzGw986PmvqNkt1XzB9Np/1x9InTcAAADfSURBVLxaKahqFwgW5hYFEzOzBaXF/N5%2bPF5ZWuoUVEBDTZlAUNHWUcciZGVtBsvGxgyaGK%2bioK2lJpFTmJ2WyeFmp2YXZKWksyDroJKWTCYmRPsH%2bsTFR0H0kVaGCkC0SHFx6DaMRIuBRAhqkoRudmC550v34NAAYID8wGyFYQoMgcG%2bLW3tJDrNzcMlOi7K0/vFrQcenNJBFq%2brZXBjaed/yjoWKxr5omXhkmi5Z2iIV1w48GYMIiQnI6mqrKCprqKpideB/dhI19TM0NrG/KytpTUcxC1N4E9VVRT%2bPzbiUw29GeqqAAAAAElFTkSuQmCC' /%3e%3c/svg%3e"},"path":"/authors/justin-yoo/"}]}},{"node":{"title":"애저 듀어러블 펑션으로 웹훅 검사 도구 만들기","path":"/posts/2021/02/16/developing-webhook-testing-tool-with-azure-durable-functions/","image":"https://sa0blogs.blob.core.windows.net/aliencube/2020/04/building-requestbin-with-durable-functions-00.png","image_caption":"애저 펑션과 RequestBin 아이콘 합성","description":"이 포스트에서는 애저 듀어러블 펑션의 Stateful 속성을 이용해서 웹훅을 테스트할 수 있는 도구를 개발해 보겠습니다.","content":"<p>혹시 웹훅을 테스트 하기 위해 사용했던 추억의 RequestBin 앱 첫 화면이 기억나시나요?</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/04/building-requestbin-with-durable-functions-01.png\"></p>\n<p>현재는 정식으로 서비스 되고 있지 않고, 다만 소스 코드와 함께 <a href=\"https://requestbin.herokuapp.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">샘플 형태</a>로 운영되고 있습니다. 따라서, 내가 직접 이 서비스를 운영하고 싶다면 도커 컨테이너를 이용해서 어딘가에 호스팅을 해야 합니다. 이와 관련해서 <a href=\"https://docs.microsoft.com/ko-kr/azure/container-instances/container-instances-overview?WT.mc_id=dotnet-16306-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 컨테이너 인스턴스</a>를 활용해서 <a href=\"https://github.com/aliencube/RequestBin-on-ACI\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">올리는 방법</a>과 <a href=\"https://docs.microsoft.com/ko-kr/azure/app-service/?WT.mc_id=dotnet-16306-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 앱 서비스</a>를 활용해서 <a href=\"https://github.com/aliencube/RequestBin-on-Azure-App-Service\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">올리는 방법</a>을 예전에 샘플 코드 형태로 소개한 적이 있습니다. 그런데, 문제가 하나 있습니다. 오리지널 RequestBin 앱은 애플리케이션과 Redis 캐시로 구성이 되어 있는데, 캐시의 특성상 언제든 데이터가 소실될 수 있기 때문에 가끔은 오래된 웹훅 히스토리를 확인하고 싶을 때에는 난감할 수도 있죠.</p>\n<p>마침 애저 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/durable/durable-functions-overview?tabs=csharp&#x26;WT.mc_id=dotnet-16306-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">듀어러블 펑션</a>은 자체적으로 테이블 저장소 기능을 이용해서 <a href=\"https://docs.microsoft.com/ko-kr/azure/architecture/patterns/event-sourcing?WT.mc_id=dotnet-16306-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">이벤트 소싱 패턴</a>을 구현해 놓았습니다. 또한 이를 통해 데이터를 Stateful하게 저장할 수 있기 때문에 코드와 데이터를 동시에 다뤄야 하는 RequestBin 애플리케이션을 처음부터 만들어 보기에 아주 적절한 예시가 될 수 있습니다. 애저 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/durable/durable-functions-overview?tabs=csharp&#x26;WT.mc_id=dotnet-16306-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">듀어러블 펑션</a>이 갖는 독특한 속성 중 하나는 상태(State)를 저장할 수 있는(Stateful) 기능입니다. 이 상태 저장 속성을 이용하면 애저 펑션을 훨씬 더 다양한 용도로 사용할 수 있는데요, 이번 포스트에서는 바로 이 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/durable/durable-functions-overview?tabs=csharp&#x26;WT.mc_id=dotnet-16306-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">듀어러블 펑션</a>의 Stateful 속성을 이용해서 API의 웹훅 기능을 테스트할 수 있는 <a href=\"https://requestbin.herokuapp.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">RequestBin 애플리케이션</a>을 구현해 보겠습니다.</p>\n<blockquote>\n<p>이 포스트에 쓰인 샘플 코드는 <a href=\"https://github.com/devkimchi/RequestBin-Sample\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Durable RequestBin Sample</a>에서 다운로드 받을 수 있습니다.</p>\n</blockquote>\n<h2 id=\"상태-저장-엔티티\"><a href=\"#%EC%83%81%ED%83%9C-%EC%A0%80%EC%9E%A5-%EC%97%94%ED%8B%B0%ED%8B%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>상태 저장 엔티티</h2>\n<p><a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/durable/durable-functions-overview?tabs=csharp&#x26;WT.mc_id=dotnet-16306-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">듀어러블 펑션</a>의 오케스트레이션 기능은 <code class=\"language-text\">IDurableOrchestrationClient</code>를 통해 State를 암시적으로 저장하는 반면에, 상태 저장 엔티티를 사용하면 <code class=\"language-text\">IDurableClient</code>를 통해 이 State를 명시적으로 저장하고 호출합니다. 따라서, 대략 아래와 같은 모양이 될 텐데요, 오케스트레이션을 구현하는 대신 State에 직접 접근하는 <code class=\"language-text\">IDurableClient</code> 인스턴스가 보일 것입니다 (line #4).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist102553743\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-01-create-bin-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-01-create-bin-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-01-create-bin-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">CreateBin</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-create-bin-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-01-create-bin-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">CreateBin</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-create-bin-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-01-create-bin-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Anonymous</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>bins<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-create-bin-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-01-create-bin-cs-LC4\" class=\"blob-code blob-code-inner js-file-line highlighted\">    [<span class=\"pl-k\">DurableClient</span>] <span class=\"pl-k\">IDurableClient</span> <span class=\"pl-en\">client</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-create-bin-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-01-create-bin-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-create-bin-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-01-create-bin-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-create-bin-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-01-create-bin-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9/raw/ff7ae30340542da444369629ca0ecee0473e50fd/01-create-bin.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9#file-01-create-bin-cs\">01-create-bin.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>이제 이를 바탕으로 상태를 정의하는 엔티티를 생성합니다. <code class=\"language-text\">binId</code>는 유일한 값이라면 뭐가 되든 상관 없으므로 여기서는 간단하게 GUID를 사용합니다 (line #6). <code class=\"language-text\">EntityId</code>가 바로 상태를 관장하는 값입니다 (line #7).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist102553743\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-create-bin-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-02-create-bin-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-create-bin-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">CreateBin</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-create-bin-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-02-create-bin-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">CreateBin</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-create-bin-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-02-create-bin-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Anonymous</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>bins<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-create-bin-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-02-create-bin-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">DurableClient</span>] <span class=\"pl-k\">IDurableClient</span> <span class=\"pl-en\">client</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-create-bin-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-02-create-bin-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-create-bin-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-02-create-bin-cs-LC6\" class=\"blob-code blob-code-inner js-file-line highlighted\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">binId</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Guid</span>.<span class=\"pl-en\">NewGuid</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-create-bin-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-02-create-bin-cs-LC7\" class=\"blob-code blob-code-inner js-file-line highlighted\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">bin</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">EntityId</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Bin<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">binId</span>.<span class=\"pl-en\">ToString</span>());</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-create-bin-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-02-create-bin-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-create-bin-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-02-create-bin-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-create-bin-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-02-create-bin-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9/raw/ff7ae30340542da444369629ca0ecee0473e50fd/02-create-bin.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9#file-02-create-bin-cs\">02-create-bin.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>위 코드에서 보면 <code class=\"language-text\">&quot;Bin&quot;</code>이라는 값은 이 상태를 명시적으로 저장하고 삭제하는 엔티티의 이름입니다. 이 엔티티는 액터 모델의 구현을 따릅니다. 따라서, 엔티티의 상태와 더불어 어떤 식으로 엔티티의 상태를 변경시킬 수 있는지에 대한 액션도 함께 정의되어 있지요. 대략 아래와 같은 모습이 됩니다. 먼저 <code class=\"language-text\">IBin</code> 인터페이스를 통해 상태 변경과 관련한 액션을 정의합니다. 여기서는 상태를 추가하고 리셋하는 역할만 정의합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist102553743\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-03-ibin-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-03-ibin-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-03-ibin-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">interface</span> <span class=\"pl-en\">IBin</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-03-ibin-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-03-ibin-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-ibin-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-03-ibin-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">void</span> <span class=\"pl-en\">Add</span>(<span class=\"pl-k\">BinItem</span> <span class=\"pl-en\">item</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-ibin-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-03-ibin-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">void</span> <span class=\"pl-en\">Reset</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-ibin-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-03-ibin-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9/raw/ff7ae30340542da444369629ca0ecee0473e50fd/03-ibin.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9#file-03-ibin-cs\">03-ibin.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>그리고 아래와 같이 <code class=\"language-text\">Bin</code> 클라스로 인터페이스 구현을 하는데, 상태 저장을 위한 <code class=\"language-text\">History</code>라는 속성을 정의합니다 (line #5). 이 때 클라스 데코레이터로 직렬화 옵션을 <code class=\"language-text\">MemberSerialization.OptIn</code>라고 주면 (line #1) 명시적으로 <code class=\"language-text\">JsonProperty</code> 데코레이터를 선언한 속성에 대해서만 직렬화를 시도하게 됩니다 (line #4). 마지막 줄에 보면 <code class=\"language-text\">Run(IDurableEntityContext)</code>라는 이름의 정적 메소드가 있는데 (line #23), 이를 통해 이벤트를 발생시켜 테이블 저장소에 상태를 저장합니다.</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist102553743\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-04-bin-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-04-bin-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-04-bin-cs-LC1\" class=\"blob-code blob-code-inner js-file-line highlighted\">[<span class=\"pl-k\">JsonObject</span>(<span class=\"pl-en\">MemberSerialization</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">MemberSerialization</span>.<span class=\"pl-smi\">OptIn</span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-04-bin-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">Bin</span> : <span class=\"pl-k\">IBin</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-04-bin-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-04-bin-cs-LC4\" class=\"blob-code blob-code-inner js-file-line highlighted\">    [<span class=\"pl-k\">JsonProperty</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>history<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-04-bin-cs-LC5\" class=\"blob-code blob-code-inner js-file-line highlighted\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">virtual</span> <span class=\"pl-k\">List</span>&lt;<span class=\"pl-k\">BinItem</span>&gt; <span class=\"pl-en\">History</span> { <span class=\"pl-k\">get</span>; <span class=\"pl-k\">set</span>; } <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">List</span>&lt;<span class=\"pl-k\">BinItem</span>&gt;();</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-04-bin-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-04-bin-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"pl-en\">Add</span>(<span class=\"pl-k\">BinItem</span> <span class=\"pl-en\">item</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-04-bin-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-04-bin-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">if</span> (<span class=\"pl-smi\">item</span> <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-04-bin-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-04-bin-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">return</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-04-bin-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-04-bin-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-04-bin-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">this</span>.<span class=\"pl-smi\">History</span>.<span class=\"pl-en\">Insert</span>(<span class=\"pl-c1\">0</span>, <span class=\"pl-smi\">item</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-04-bin-cs-LC15\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-04-bin-cs-LC16\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-04-bin-cs-LC17\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"pl-en\">Reset</span>()</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-04-bin-cs-LC18\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-04-bin-cs-LC19\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">this</span>.<span class=\"pl-smi\">History</span>.<span class=\"pl-en\">Clear</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-04-bin-cs-LC20\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-04-bin-cs-LC21\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-04-bin-cs-LC22\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">Bin</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-04-bin-cs-LC23\" class=\"blob-code blob-code-inner js-file-line highlighted\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">Task</span> <span class=\"pl-en\">Run</span>([<span class=\"pl-k\">EntityTrigger</span>] <span class=\"pl-k\">IDurableEntityContext</span> <span class=\"pl-en\">ctx</span>) <span class=\"pl-k\">=&gt;</span> <span class=\"pl-smi\">ctx</span>.<span class=\"pl-en\">DispatchAsync</span>&lt;<span class=\"pl-k\">Bin</span>&gt;();</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-bin-cs-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-04-bin-cs-LC24\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9/raw/ff7ae30340542da444369629ca0ecee0473e50fd/04-bin.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9#file-04-bin-cs\">04-bin.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<h2 id=\"bin-생성\"><a href=\"#bin-%EC%83%9D%EC%84%B1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Bin 생성</h2>\n<p>그렇다면, 이제 이 엔티티에 어떻게 상태를 저장할까요? <code class=\"language-text\">SignalEntityAsync()</code> 메소드를 통해 엔티티에 구현한 메소드를 호출합니다 (line #8). 여기서는 비어있는 Bin 객체만 반환시킬 예정이므로 <code class=\"language-text\">null</code> 값을 보내게 됩니다. 이렇게 해서 비어있는 Bin이 하나 만들어졌습니다.</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist102553743\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-create-bin-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-05-create-bin-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-create-bin-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">CreateBin</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-create-bin-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-create-bin-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">CreateBin</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-create-bin-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-create-bin-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Anonymous</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>bins<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-create-bin-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-05-create-bin-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">DurableClient</span>] <span class=\"pl-k\">IDurableClient</span> <span class=\"pl-en\">client</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-create-bin-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-05-create-bin-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-create-bin-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-05-create-bin-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-create-bin-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-05-create-bin-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-create-bin-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-05-create-bin-cs-LC8\" class=\"blob-code blob-code-inner js-file-line highlighted\">    <span class=\"pl-k\">await</span> <span class=\"pl-smi\">client</span>.<span class=\"pl-en\">SignalEntityAsync</span>&lt;<span class=\"pl-k\">IBin</span>&gt;(<span class=\"pl-smi\">bin</span>, <span class=\"pl-en\">o</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-smi\">o</span>.<span class=\"pl-en\">Add</span>(<span class=\"pl-c1\">null</span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-create-bin-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-05-create-bin-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-create-bin-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-05-create-bin-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-create-bin-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-05-create-bin-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9/raw/ff7ae30340542da444369629ca0ecee0473e50fd/05-create-bin.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9#file-05-create-bin-cs\">05-create-bin.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>여기까지 해서 펑션 앱을 실제로 돌려보면 테이블 저장소에 아래와 같은 형태로 레코드가 생성된 것이 보일 것입니다. <code class=\"language-text\">history</code> 필드에 비어있는 배열이 보이나요? 현재 <code class=\"language-text\">Bin</code>만 만들어졌기 때문입니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/04/building-requestbin-with-durable-functions-02.png\"></p>\n<h2 id=\"웹훅-요청-저장\"><a href=\"#%EC%9B%B9%ED%9B%85-%EC%9A%94%EC%B2%AD-%EC%A0%80%EC%9E%A5\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>웹훅 요청 저장</h2>\n<p>이제 웹훅 요청 히스토리를 하나씩 저장시켜 보도록 하죠. 앞서 만든 엔드포인트와 거의 비슷합니다. 다만 이번에는 요청 데이터를 넣어줘야 합니다. 타임스탬프, 요청 메소드, 헤더, 쿼리스트링, 페이로드를 모두 캡쳐해서 저장합니다 (line #10-14).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist102553743\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-06-add-history-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-06-add-history-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-06-add-history-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">AddHistory</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-06-add-history-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">AddHistory</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-06-add-history-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Anonymous</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>get<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>put<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>patch<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>delete<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>bins/{binId}<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-06-add-history-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">DurableClient</span>] <span class=\"pl-k\">IDurableClient</span> <span class=\"pl-en\">client</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-06-add-history-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">string</span> <span class=\"pl-en\">binId</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-06-add-history-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-06-add-history-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">history</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">BinItem</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-06-add-history-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">using</span> (<span class=\"pl-k\">var</span> <span class=\"pl-en\">reader</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">StreamReader</span>(<span class=\"pl-smi\">req</span>.<span class=\"pl-smi\">Body</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-06-add-history-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-06-add-history-cs-LC10\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-smi\">history</span>.<span class=\"pl-smi\">Timestamp</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">DateTimeOffset</span>.<span class=\"pl-smi\">UtcNow</span>.<span class=\"pl-en\">ToString</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>yyyy-MM-ddTHH:mm:ss.fffzzz<span class=\"pl-pds\">\"</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-06-add-history-cs-LC11\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-smi\">history</span>.<span class=\"pl-smi\">Method</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">req</span>.<span class=\"pl-smi\">Method</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-06-add-history-cs-LC12\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-smi\">history</span>.<span class=\"pl-smi\">Headers</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">req</span>.<span class=\"pl-smi\">Headers</span>.<span class=\"pl-en\">AsEnumerable</span>().<span class=\"pl-en\">ToDictionary</span>(<span class=\"pl-en\">p</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-smi\">p</span>.<span class=\"pl-smi\">Key</span>, <span class=\"pl-en\">p</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-smi\">string</span>.<span class=\"pl-en\">Join</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>;<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">p</span>.<span class=\"pl-smi\">Value</span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-06-add-history-cs-LC13\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-smi\">history</span>.<span class=\"pl-smi\">Queries</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">req</span>.<span class=\"pl-smi\">Query</span>.<span class=\"pl-en\">ToDictionary</span>(<span class=\"pl-en\">p</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-smi\">p</span>.<span class=\"pl-smi\">Key</span>, <span class=\"pl-en\">p</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-smi\">string</span>.<span class=\"pl-en\">Join</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>;<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">p</span>.<span class=\"pl-smi\">Value</span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-06-add-history-cs-LC14\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-smi\">history</span>.<span class=\"pl-smi\">Body</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">await</span> <span class=\"pl-smi\">reader</span>.<span class=\"pl-en\">ReadToEndAsync</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-06-add-history-cs-LC15\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-06-add-history-cs-LC16\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-06-add-history-cs-LC17\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-add-history-cs-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-06-add-history-cs-LC18\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9/raw/ff7ae30340542da444369629ca0ecee0473e50fd/06-add-history.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9#file-06-add-history-cs\">06-add-history.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>그리고, 앞서와 같이 <code class=\"language-text\">bin</code>을 만들어 <code class=\"language-text\">SignalEntityAsync()</code> 메소드를 통해 히스토리를 추가합니다 (line #11).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist102553743\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-07-add-history-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-07-add-history-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-07-add-history-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">AddHistory</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-add-history-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-07-add-history-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">AddHistory</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-add-history-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-07-add-history-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Anonymous</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>get<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>put<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>patch<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>delete<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>bins/{binId}<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-add-history-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-07-add-history-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">DurableClient</span>] <span class=\"pl-k\">IDurableClient</span> <span class=\"pl-en\">client</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-add-history-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-07-add-history-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">string</span> <span class=\"pl-en\">binId</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-add-history-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-07-add-history-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-add-history-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-07-add-history-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-add-history-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-07-add-history-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-add-history-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-07-add-history-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">bin</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">EntityId</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Bin<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">binId</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-add-history-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-07-add-history-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-add-history-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-07-add-history-cs-LC11\" class=\"blob-code blob-code-inner js-file-line highlighted\">    <span class=\"pl-k\">await</span> <span class=\"pl-smi\">client</span>.<span class=\"pl-en\">SignalEntityAsync</span>&lt;<span class=\"pl-k\">IBin</span>&gt;(<span class=\"pl-smi\">bin</span>, <span class=\"pl-en\">o</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-smi\">o</span>.<span class=\"pl-en\">Add</span>(<span class=\"pl-smi\">history</span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-add-history-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-07-add-history-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-add-history-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-07-add-history-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-add-history-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-07-add-history-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9/raw/ff7ae30340542da444369629ca0ecee0473e50fd/07-add-history.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9#file-07-add-history-cs\">07-add-history.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>이렇게 한 후 실제로 웹훅 요청을 날려보면 테이블 저장소의 데이터가 아래와 같이 변경된 것이 보이는데요, 이는 실제로 요청 데이터가 저장된 것입니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/04/building-requestbin-with-durable-functions-03.png\"></p>\n<h2 id=\"웹훅-히스토리-조회\"><a href=\"#%EC%9B%B9%ED%9B%85-%ED%9E%88%EC%8A%A4%ED%86%A0%EB%A6%AC-%EC%A1%B0%ED%9A%8C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>웹훅 히스토리 조회</h2>\n<p>그렇다면, 지금까지 저장해 놓은 웹훅 히스토리를 열어봐야 할 필요도 있을 테죠? 이 경우는 아래와 같이 먼저 Bin 레퍼런스를 생성합니다 (line #7).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist102553743\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-08-get-history-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-08-get-history-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-08-get-history-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">GetHistory</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-get-history-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-08-get-history-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">GetHistory</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-get-history-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-08-get-history-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Anonymous</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>get<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>bins/{binId}/history<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-get-history-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-08-get-history-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">DurableClient</span>] <span class=\"pl-k\">IDurableClient</span> <span class=\"pl-en\">client</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-get-history-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-08-get-history-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">string</span> <span class=\"pl-en\">binId</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-get-history-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-08-get-history-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-get-history-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-08-get-history-cs-LC7\" class=\"blob-code blob-code-inner js-file-line highlighted\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">bin</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">EntityId</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Bin<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">binId</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-get-history-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-08-get-history-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-get-history-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-08-get-history-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-get-history-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-08-get-history-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9/raw/ff7ae30340542da444369629ca0ecee0473e50fd/08-get-history.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9#file-08-get-history-cs\">08-get-history.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>그리고 난 뒤, <code class=\"language-text\">ReadEntityStateAsync()</code> 메소드를 통해 현재 상태를 가져와서 응답 객체로 반환합니다 (line #9).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist102553743\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-09-get-history-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-09-get-history-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-09-get-history-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">GetHistory</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-09-get-history-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">GetHistory</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-09-get-history-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Anonymous</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>get<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>bins/{binId}/history<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-09-get-history-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">DurableClient</span>] <span class=\"pl-k\">IDurableClient</span> <span class=\"pl-en\">client</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-09-get-history-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">string</span> <span class=\"pl-en\">binId</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-09-get-history-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-09-get-history-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-09-get-history-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-09-get-history-cs-LC9\" class=\"blob-code blob-code-inner js-file-line highlighted\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">entity</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">await</span> <span class=\"pl-smi\">client</span>.<span class=\"pl-en\">ReadEntityStateAsync</span>&lt;<span class=\"pl-k\">Bin</span>&gt;(<span class=\"pl-smi\">bin</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-09-get-history-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">payload</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">entity</span>.<span class=\"pl-smi\">EntityState</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-09-get-history-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-09-get-history-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">result</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">JsonObjectContentResult</span>(<span class=\"pl-smi\">HttpStatusCode</span>.<span class=\"pl-smi\">OK</span>, <span class=\"pl-smi\">payload</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-09-get-history-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-09-get-history-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">return</span> <span class=\"pl-smi\">result</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-get-history-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-09-get-history-cs-LC15\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9/raw/ff7ae30340542da444369629ca0ecee0473e50fd/09-get-history.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9#file-09-get-history-cs\">09-get-history.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>이렇게 하면 아래와 같이 저장된 웹훅 요청 데이터에 대한 히스토리를 볼 수 있게 됩니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/04/building-requestbin-with-durable-functions-04.png\"></p>\n<h2 id=\"웹훅-히스토리-삭제\"><a href=\"#%EC%9B%B9%ED%9B%85-%ED%9E%88%EC%8A%A4%ED%86%A0%EB%A6%AC-%EC%82%AD%EC%A0%9C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>웹훅 히스토리 삭제</h2>\n<p>이번에는 Bin 안에 저장된 모든 히스토리를 삭제해 볼까요? 먼저 Bin 레퍼런스를 생성합니다 (line #7).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist102553743\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-10-reset-history-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-10-reset-history-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-10-reset-history-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">ResetHistory</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-reset-history-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-10-reset-history-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">ResetHistory</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-reset-history-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-10-reset-history-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Anonymous</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>delete<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>bins/{binId}/reset<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-reset-history-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-10-reset-history-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">DurableClient</span>] <span class=\"pl-k\">IDurableClient</span> <span class=\"pl-en\">client</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-reset-history-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-10-reset-history-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">string</span> <span class=\"pl-en\">binId</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-reset-history-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-10-reset-history-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-reset-history-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-10-reset-history-cs-LC7\" class=\"blob-code blob-code-inner js-file-line highlighted\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">bin</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">EntityId</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Bin<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">binId</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-reset-history-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-10-reset-history-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-reset-history-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-10-reset-history-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-reset-history-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-10-reset-history-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9/raw/ff7ae30340542da444369629ca0ecee0473e50fd/10-reset-history.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9#file-10-reset-history-cs\">10-reset-history.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>그리고 난 후 이번에는 <code class=\"language-text\">SignalEntityAsync()</code> 메소드를 통해 <code class=\"language-text\">Bin</code> 액터의 <code class=\"language-text\">Reset()</code> 메소드를 호출합니다 (line #9).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist102553743\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-11-reset-history-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-11-reset-history-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-11-reset-history-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">ResetHistory</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-11-reset-history-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-11-reset-history-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">ResetHistory</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-11-reset-history-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-11-reset-history-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Anonymous</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>delete<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>bins/{binId}/reset<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-11-reset-history-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-11-reset-history-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">DurableClient</span>] <span class=\"pl-k\">IDurableClient</span> <span class=\"pl-en\">client</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-11-reset-history-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-11-reset-history-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">string</span> <span class=\"pl-en\">binId</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-11-reset-history-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-11-reset-history-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-11-reset-history-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-11-reset-history-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-11-reset-history-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-11-reset-history-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-11-reset-history-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-11-reset-history-cs-LC9\" class=\"blob-code blob-code-inner js-file-line highlighted\">    <span class=\"pl-k\">await</span> <span class=\"pl-smi\">client</span>.<span class=\"pl-en\">SignalEntityAsync</span>&lt;<span class=\"pl-k\">IBin</span>&gt;(<span class=\"pl-smi\">bin</span>, <span class=\"pl-en\">o</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-smi\">o</span>.<span class=\"pl-en\">Reset</span>());</td>\n      </tr>\n      <tr>\n        <td id=\"file-11-reset-history-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-11-reset-history-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-11-reset-history-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-11-reset-history-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-11-reset-history-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-11-reset-history-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9/raw/ff7ae30340542da444369629ca0ecee0473e50fd/11-reset-history.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9#file-11-reset-history-cs\">11-reset-history.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>이후 테이블 저장소를 조회해 보면 모든 웹훅 히스토리가 사라진 것을 확인할 수 있습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/04/building-requestbin-with-durable-functions-05.png\"></p>\n<h2 id=\"bin-삭제\"><a href=\"#bin-%EC%82%AD%EC%A0%9C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Bin 삭제</h2>\n<p>이제 마지막으로 이 Bin이 더이상 필요없을 때 삭제하는 엔드포인트를 만들어 보겠습니다. 먼저 Bin 레퍼런스를 생성합니다 (line #7).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist102553743\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-12-purge-bin-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-12-purge-bin-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-12-purge-bin-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">PurgeBin</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-12-purge-bin-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-12-purge-bin-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">PurgeBin</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-12-purge-bin-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-12-purge-bin-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Anonymous</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>delete<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>bins/{binId}/purge<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-12-purge-bin-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-12-purge-bin-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">DurableClient</span>] <span class=\"pl-k\">IDurableClient</span> <span class=\"pl-en\">client</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-12-purge-bin-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-12-purge-bin-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">string</span> <span class=\"pl-en\">binId</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-12-purge-bin-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-12-purge-bin-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-12-purge-bin-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-12-purge-bin-cs-LC7\" class=\"blob-code blob-code-inner js-file-line highlighted\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">bin</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">EntityId</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Bin<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">binId</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-12-purge-bin-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-12-purge-bin-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-12-purge-bin-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-12-purge-bin-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-12-purge-bin-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-12-purge-bin-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9/raw/ff7ae30340542da444369629ca0ecee0473e50fd/12-purge-bin.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9#file-12-purge-bin-cs\">12-purge-bin.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>그리고, <code class=\"language-text\">PurgeInstanceHistoryAsync()</code> 메소드를 통해 엔티티 자체를 테이블 저장소에서 삭제합니다 (line #9).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist102553743\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-13-purge-bin-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-13-purge-bin-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-13-purge-bin-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">PurgeBin</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-13-purge-bin-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-13-purge-bin-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">PurgeBin</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-13-purge-bin-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-13-purge-bin-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Anonymous</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>delete<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>bins/{binId}/purge<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-13-purge-bin-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-13-purge-bin-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">DurableClient</span>] <span class=\"pl-k\">IDurableClient</span> <span class=\"pl-en\">client</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-13-purge-bin-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-13-purge-bin-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">string</span> <span class=\"pl-en\">binId</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-13-purge-bin-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-13-purge-bin-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-13-purge-bin-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-13-purge-bin-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-13-purge-bin-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-13-purge-bin-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-13-purge-bin-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-13-purge-bin-cs-LC9\" class=\"blob-code blob-code-inner js-file-line highlighted\">    <span class=\"pl-k\">await</span> <span class=\"pl-smi\">client</span>.<span class=\"pl-en\">PurgeInstanceHistoryAsync</span>(<span class=\"pl-s\"><span class=\"pl-pds\">$\"</span>@{<span class=\"pl-smi\">bin</span>.<span class=\"pl-smi\">EntityName</span>}@{<span class=\"pl-smi\">bin</span>.<span class=\"pl-smi\">EntityKey</span>}<span class=\"pl-pds\">\"</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-13-purge-bin-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-13-purge-bin-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-13-purge-bin-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-13-purge-bin-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">result</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">NoContentResult</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-13-purge-bin-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-13-purge-bin-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-13-purge-bin-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-13-purge-bin-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">return</span> <span class=\"pl-smi\">result</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-13-purge-bin-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-13-purge-bin-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9/raw/ff7ae30340542da444369629ca0ecee0473e50fd/13-purge-bin.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/01426032d1ee6886796d9cb72e048dd9#file-13-purge-bin-cs\">13-purge-bin.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>실제로 이 엔드포인트를 호출하면 아래와 같이 테이블 저장소에서 엔티티가 완전히 사라진 것이 보입니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/04/building-requestbin-with-durable-functions-06.png\"></p>\n<br/>\n<hr>\n<p>이렇게 해서 웹훅 API의 페이로드를 테스트해 볼 때 유용한 RequestBin 앱을 애저 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/durable/durable-functions-overview?tabs=csharp&#x26;WT.mc_id=dotnet-16306-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">듀어러블 펑션</a>을 이용해 구현해 봤습니다. 이 코드를 이용하면 아무래도 PoC이니만큼 간단한 웹훅 확인 용도로 사용하는데에는 큰 문제가 없습니다. 여기에 더해 조금 더 UI를 붙여준다거나 하면 좀 더 완성도가 높은 앱이 될 것입니다. 이 포스트의 포인트는 애저 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/durable/durable-functions-overview?tabs=csharp&#x26;WT.mc_id=dotnet-16306-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">듀어러블 펑션</a>의 Stateful한 특성을 오케스트레이션 용도 뿐만 아니라 직접 액세스를 통해 다양한 활용도를 구현해 볼 수 있다는 데 있으니, 앞으로 이 듀어러블 펑션을 통해 좀 더 다양한 워크플로우 관리를 할 수 있기를 기대합니다.</p>\n<h2 id=\"더-궁금하다면\"><a href=\"#%EB%8D%94-%EA%B6%81%EA%B8%88%ED%95%98%EB%8B%A4%EB%A9%B4\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>더 궁금하다면...</h2>\n<ul>\n<li>애저 클라우드에 관심이 있으신가요? ➡️ <a href=\"https://azure.microsoft.com/ko-kr/free/?WT.mc_id=dotnet-16306-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">무료 애저 계정 생성하기</a></li>\n<li>애저 클라우드 무료 온라인 강의 코스를 들어 보세요! ➡️ <a href=\"https://docs.microsoft.com/ko-kr/learn/?WT.mc_id=dotnet-16306-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Learn</a></li>\n<li>마이크로소프트 개발자 유튜브 채널 ➡️ <a href=\"https://www.youtube.com/channel/UCdgR-b2t7Byu_UGrHnu-T0g\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Developer Korea</a></li>\n</ul>\n","humanTime":"16 February 2021","datetime":"Tue Feb 16 2021 12:00:00 UTC+00:00","canonical_url":"https://blog.aliencube.org/ko/2020/04/23/building-requestbin-with-durable-functions/","timeToRead":12,"tags":[{"id":"azure-functions","title":"azure-functions","path":"/tags/azure-functions/"},{"id":"azure-durable-functions","title":"azure-durable-functions","path":"/tags/azure-durable-functions/"},{"id":"statefulness","title":"statefulness","path":"/tags/statefulness/"},{"id":"requestbin","title":"requestbin","path":"/tags/requestbin/"}],"category":{"id":"Azure","title":"Azure","path":"/categories/azure/","belongsTo":{"totalCount":11,"edges":[{"node":{"title":"애저 Bicep 되짚어보기","path":"/posts/2021/04/27/bicep-refreshed/"}},{"node":{"title":"애저 펑션 프록시 기능을 이용한 Open API 확장 기능 하위 호환성 유지하기","path":"/posts/2021/03/16/openapi-extension-to-support-azure-functions-v1/"}},{"node":{"title":"애저 펑션에 Open API 활성화 시키기","path":"/posts/2021/03/09/enabling-openapi-on-azure-functions/"}},{"node":{"title":"이벤트 기반 애저 키 저장소 시크릿 로테이션 관리","path":"/posts/2021/03/02/event-driven-keyvault-secrets-rotation-management/"}}]}},"author":[{"id":"justin-yoo","name":"유저스틴","image":{"type":"image","mimeType":"image/png","src":"/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png","size":{"width":500,"height":500},"sizes":"(max-width: 500px) 100vw, 500px","srcset":["/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png 500w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 500 500' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-6a0325b746fa0b3948747e4a6f689de9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-6a0325b746fa0b3948747e4a6f689de9)' width='500' height='500' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC%2baJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVRo3pWZd1RT67b2ueccy7YgHQKE0HsvYkdFsaFYEKUI0nsnlPSEhBI6offeISgdpPeQ0JFi3%2bfse84Yt/x3v7%2b/udaCiLq3d9893rH2Soz4/J75zPm%2bK0jMz68sLq4tLa0LhVvLy9srK7tra%2b/Ea339/fr6h0Pr459Za2sfflyrq%2b/R9W5lZW95eVck2hGJtoWwlt4Kl7YEgk3B4oZgYWNxfm1hfm1%2bbmVudnl2RjgzvTQ9JZiaXJwYnx8fmxsbnR59M/VmZHJ4aHxocGyg/43E7KxoYWFtEf6yYFMofLu8vLO6undIPQKwsYGtTxsbH9H1CVugFbv%2bEcNhmAOA9ysr%2bwzLwm0RLATg7ZJga2lxEwVYX5j7HYDJiYWJcQCYAYCR4QkAGBwYRQBmZoTz86sLC%2bvAAADgCgBg0lHR2FWs%2b8NhgMMkf6YO3wCIdpdFCAD8o0tLW8hCAUAJCrA6PwcAIgCYmRYDzI%2bNzmIVAIb9CgDAHHx6HgGAnwIAWIpQ48WW/47oP2L4Qes7uPnxTQRAiKYIAxBsIgCLKMB%2bhEQ/VAADmP4mQtPTwtnZFWCAvwk/CH4cBnBY9%2bbmZ/T6M4ADie/gw7u7v%2b3t/fv29j/evfsn3Ozs/AZgIF0kgujvIgDLSAWQNhAiPXAAsLEIFYAegArMrs7NrmAV%2bBZgDgP4WoHx8YWpKYRhfn4N2kBcASz0IBpdn7HrH6kHcTs7/4C1t/fPmZnVzs7%2bxERaRHhMZERscFB4R0cvqAS58Ke7u/8OACLE%2b10hLAAQHDQx0gAYwCoCMLPyuxWANvimAqOjc5OTSwAAFTgE8B6z/xDA55%2bE5/Pn/%2bofmLK/ftPN1cPh5m0pyVOy0lLysjLSZ87ISksrKSiYGJmctbF95uKal1O4urK3ufVFKNwRLu3nRyhAABaRCiANcNDEfxQhAIA%2bPgAYn1iYmRGB/Yd7AG2Aj/%2bremwKra19rK5uuXL56i/HjkqePIFIl5ORg/9JSkqePi156uSpEyeP/O1vf/nLv0lISMhISz9%2b5NzSzN/Z/vvmxuclGEECFGBxc2FxHRtBUAHU/p/1wFcArInF6rExinUwqv5/wXi3908ul6evoycvI62moqyGV1FTVVFSkMMpKSgpIjVQVJBXUkTupM5ISkvB5fQvx49rENSfI9UogmqA90uo/Wj7rs8jHbyKzlCsAZamJg/vA1gFJr%2bOUdjFBIKv3qObwOH8fDxg%2bHx4YfZDpqOjE1SUFPE4JXW8ihZBTVdLw0BHSwOvoqmmqqmmoq6KwysrAg9ccYoKCvKysIDqxC/Hjx7566kTv2SkZ29ufATFSAMsiNVDBZZnp0UzU1/tB/UHANPYPrBfAWz/Ent/aIB%2bB/ANA0wbaMem5ld6unog10BXRx90q6nqa6pdtja%2bYWty46zR3QtmD%2b0s7cx17cx1zhtpauNxyggJDhjOSJ6CjP1y7Mjtm7dGhqfWoA6Lm0h%2b9gFW5iA/06LpKaE4PBjAQQMgIwgq0N83IoGdIA7UY/vux9%2brwKfD9m9tfREt7121u66BV9XX1jLS0bA21HK5aUv2f5gW4VJAdK2keFWRX1QnuWUF3MsLvMvxvuVlb37ZmKBPUFaSl4UmgTqcPnnizOmTgESMjYdBhPTu/BqqHhpgeWZaiNovENuPqv86Q/cjBOoPjH9/kOyPh8z%2bPjzIgui/%2b1dMTCJeWUlbg2Brqh/j6sAjutaz/GZqSXM1CbPlsbOlMeO80MEMPz7dvTXRpSXBpSz4Dv2JrccVAzMNJVVFOXlZGFGAcPzUyROmJiaTE4uwCczNYvavzCD2L00j6vfTP4ocImZGhsX5QdQjFTh0avi6bf1kwQd2d36LjCTiVZS11NVNdQgcP8e%2bzOCxkti5OspaR8pmV6qonjJTGD6ZHzIMALTnnTRXPtWtOfZR4ctrDCcrzwtaVurymorS8lKSp0%2bdgAUDi0ljra2%2bm5leRuyfXp6ZQgCmJgTi/GD2Q96Gh77ajwAcHNSwufn55wDQuLC58rtHFOTkVJUUYeyEPrwynBW0WJe4wU/b7c//MFLyYaRs61WWsJY0XRA%2bnhPYz3nZx3k5kObbRXWrCXVkP7SKvKb3yAx3QUNWT0laRvIk/Hf0yN9winItzZ2w34F0dP5A%2bpfE9ovH//DQ1y0M1Pf1DiEAm5sf0Ov%2bYeEnAHBY%2bPT5P5nMdGnJU1oa6udNdcuIz0YLI9Y6OO%2bGC98PFX8YKf80Vv32dZ6wjjpdHDmRHzKWGzyaEzTE9eNTXGtD7qU8sk64Zex7XuO%2bsdI1HUVteaQIUlJSsEU43b%2b/ItqZnoThA0v43fA5sH9c3L6wenv2AT4ebFuff74QgE//ERwcKS8jpaul%2beT62epEt4mS%2bJ3%2bvHeDRR9Hyj6%2bqfgwUrnawp3ixUzyIt9kBY7lBI3nhw2kercSHxd5XmU6msc7GEZc03M2V7ljqHSOIIOTkTxzRvKvf/k3C3Mz5PwzvYzaD%2bERHLYf1I8MTw4Nfk1/X%2b9wz%2btBiR%2bPDD9JP3wYpqez83MAMDMy8HS0q6F6CZtT3o%2bUQ3I%2bjVa8Gyxea09bqqdPFccOpgcNpAUOZwSM5YWOZAZ0JroUelxhOprF2utHXtd/bom/a6h4UUNWXf6MtLTU8WPHYK/jd/QIFjYhPOL2PQgPZv/k4IA4PMNg/%2btXAxIHTypfw/Pd/WGAt29/nV/YsLSwUlaUP29t4XHnYh3Lf42fvdtfvDdUujtQsMHPWO/K3uDnLbekjuaE93P8Bzg%2bQ9yACV5kf6pvbdh9jpN1zHV9v4uartZqd4wUoRM0FaRkzpw%2bdeokHDXYTM7K8g54P4XYv392EKsH%2bwf69%2b0H9WIA8Vn/o/jkfHgd7mA4J3e/GlFVweNVcBesLV7cvdyREbHGz1zryhI0ssfLSXMNKW%2bHanfH27aH67f6yuer6RO8qMki4mwlZao0qZvlVxbygP7knNcFbSdTFQd9pfPqMuoKUrCxnT55EtrA7bkbbKkT44tTB/kZfbMPMDQ48aP9r7r7JX58WPmO4TDA%2b/f/amrqxquqahLULE0MA584TFSQ1zvT5moZVWTf3ES/FKI/O9q3hBHekh4z15q3O1Inaslcak6fr%2bc0swJpnne875xzuWjkaK11SRd3RVvhIkFGTfY0jNMzp08DwDNnF9jREO%2bR9kUADoVn/Dv1sLr5fRJ/5mlLfPiB/au%2boVNZSRFmqK6aCsvHca2VtdTArE3yzIv2KGVF8mjBmfFeVazA5rTQN1WsD%2bPNi3XcocyI/uzItID7L25anTfSstAlWOuqWGspWRIULqnL6cufQrZkSQTgsdNDOFBg4Tk8fLDw9Pe9wdRD72L287t6v%2bmBny8YQfB41dk5gFeB85vSbRuDfo7XWkPSXEkMn%2b03Uc0WdBSI2nNmyknD2RHCZs7eUPHOQOlsOb2N%2bKw%2b5klxqGNJ6P02lncT1Yvz4prbeW1rgqytuoINTlLu9C8AAKftB46OS4INUC9u34OdCwP4JjxgPwJwcPj59Geeerff/n1yUmRqbKKqpEBztx9M8elIDapPi%2bFRgkqZoU3ZCUW0QLKXY%2bT9i0muN3lEj4lyyigvttDbnnjLNOK2RaqvYz7RnRv4MOG%2bjaMZ/qy6rA1e9gpBVl/u1LGjR6ECZ62t4IELdgDx9MR6F0s/NjcPq%2b/q7JEQnz3/DABMoZmZFUsrG2sr67iIKJdHD8lkMinUtZbhPt5A6SwnpjKC7lw/63JOn%2bV8sY7sXptHD/d/qa0ko6Uk8%2bCKsf8TO1tTQx2crIOZxh1jVRsNBRtdvJmmsh5OTk9LE4dT1lQndHW8hscAkH5gP5b%2b0R%2b9B/WdHa//DwBooT4vi3Zi3V1unLPKjg%2bK9XMtzM/IjXtcS3rUkh3UWhjdUUSLe37L/5Jh2rPLizXxbEq03w3bR2d1jLXwvi5XWZHOSe73Aq%2bbudho2mvLPjHHXdZSvH/HQVlV%2bemjx1cv2cXFJmC77%2bHhM9A/hs1NsB9T381H1MPqaH%2bFHeY%2b/lmAzS%2bby9vtRN%2bYl8/aqd4zuaEtueT6jLDenMCBwoiZGnIfN6wm4nGe142BrJCewthAt3uThbF1sU/PWxi%2beHCH/sIh2%2btGuutl8j3zoKu6z6zwDgbKMaFBRjrqevD0Iy/d0dwBz2Lf2d/fN9rbsx8eTD2/C9S/7ux41dHevQ8gXoe/4fkRYB15Evj8piCd4vu8Ls59Ni%2b8IyOmkB6w1Zu68TpjujC2j%2bU7xA2eLYl735PZW5CYHeP%2b6wivIc7ZUlP5qZV26mObQp8bPG/7TNdL6c5nI67pP7HWJYYF2hmoEc6ceHDdbnpiYWx0Htt6xer7ekd6Xg%2bJxw6WHPC%2bva27rZUvgX0B%2bLvr9763%2brCx/dvqYF9ugDMv6NFcQbSwMaWCFd5dQBR05k1Xs0aLk0Z48T2ZkV1ZUTBS5%2bqZv46WvKJ5XNaQdzDC5b%2b8Wh/u1BDq1BjxsMTnZuxNk9D7l72fPzqLl9eSOc2IjV0UbMKR880I1rvIzgWjE7P/sHrM%2b/Y2fmtLl4T4S8yfYHzzcvPXLdHGQk16M8V3pjBmqzP9w0jNSHVWRy61jh1ZQfKrogZUkXzqGMHTVWQo1peJqvGccD9bdQcDpYcWmmF3banP7CnOVxMeX/G/ddb5hu0lXeXrBoSzSlLF6dy5%2bfU3w1Ni%2byH9qP374QGAw%2brbWrtamjskfvwG8%2bckG3AmXdnbbM4dSQ%2bf4EWvNjHfD5X818rgfy4Pfhqq3mhOncgMmcqJ2ONnrzeytruz/jHTNF%2baFH/DmHzP4oUZ/pmJckOSVx3Rg%2bd9l/LA9omZqp2GrJ2ump2mcldzx9SUCIn%2b/sFhP/2vX%2b3bjyUH1ENywPvWls7mpvb/A8Chbz8/rtRnD6WFjOVHCuuS3nZnfh5r%2bm2h7%2bObhn6aT4nndVFz5l5vycehmo/Ddf8SdK%2b1pFDvWXrZaDjpyvvZELrInvNlpCGWT5GnvbsV4SJB9rK2spOlwfDA6PjowuHe7et9A%2bnHJg8WHsg9mpxOTH1TY5sE9oXrjwx/TPJhbePLRl/LXAV5gBu4WB632sx611v4abxpoYJR7HFtror%2bZaJxg18yVZM2Us4Z4hGro12czVWvass4GePCLuvme9j3p4b00l%2bmPbZ5ZIw7T5C5gJcJcLwBp%2biDU%2bcEGh5Qj9iPqT/oWsR4SA6mvqG%2bFQDe/QjwY0EO7j%2bsw83W3zdHh%2baLk7rZvnOlUYtVCauN9M2u3PqopwO5sWs9JaKuomV%2b0UIHb6YxvSMlqCzejeNxJdHJOuquBZxDo29bcN2v8Ske7IeWt3TlzqvL2SidDna6PTUjGtrvXSw8I69fDXXzB7DwYDMHNR5R39jQ1tjQWl/XLCH%2bvYN4/QQGWavv1ze/rM4uzZcyu5kvp4oiFmsThXXk2UpySfC9ifqUxbac7aGa3ZH6vdHmrd6q2VLmeD7pFellzvOrjEfnwm4YBdobh9obt5FcYZje0pO3xUvbG2qU5/ImJgSYerAf1IP9r7q/2o/lHrxvakTUN9S3gPq62iaJ1ZX3PzL8iLH6LcPa5hfR%2bFh3sv9YXthSA2WllTFdEtdO9x4sSqhJcO/NS1xqylmozVqsyZkvy3ydFMJ7cYf51M7rnO49feW4u9apntd70oKyXtg56MlbKhxnxMbMzW8MDkwM7u%2b7o2h4EPu7OvftR9V3HqhvxdTX1jRKLKO/bsB%2bDfFHACvwzg91WNv8e28RG556RY2MxbqkmZLY0fwoflpgpudtXtSLjaHq91NNnwT8X9dHREM19Rkx6ZHPbxjinxhplAY4tbF8BnMiom%2bZ2evKnsefqS6pmJgUDgyg4enHehexn9/V39mB2I%2bph/B8p76muv4bABC6jF7FDMh19QP2R9/%2bsujd5vZvo%2b1Nrznewkb6YiNtqoI4xosYK4pZaUvf7Sldayna6ajba2neaa5dyE9rDvAkXzIPO6eX5nyp2Mehg/GyPObJMxu1W/pyjrYmQ4OTI8MzaO%2bOH/Tuvv1o7/J/X31VfXVFrYRoeW//dz6H1o8F%2ba4yq2uA9GFhWtiZGjZZEiNsZszUJE1VJMw3MDb4Oe8GS36dbv401rbdXjOfzx5ixbSHv8h8coX2wCbH7UqR982i4HvhDiZPrPC2uON0InFmdnWgH%2bvd/fSjvYvYj02e/fCA%2btoWkF5b3QDqqyrrKstrJITLe8sog%2bhgrfwQqh95AHJr69fVjS81GQw%2bx3u8OHqsMHKiLH6xhb0GAAMlX8Zq/zHXudVfMVqe3JES2ckIqAx9WOp/p9TXIe/ldfLjs/dMcBfVTj%2b9fnF4eHp4eGZgYLL/d%2bx/Db0rtr%2b%2brqWupglTX42qryirlhCKdkUogwhdy8v7FTh83V8H6VpB1H%2bByD54%2bMTK3LQg%2bmkbw4vP8e3JCJptYKzys/cGCt8PFH0cqXo/WLfcWjjGI/fS/FojHtcG3eF5XeU8PedsTbAhSJvhTl%2b2tenpeTM0NN3fB%2bqhd5HRCenv6uzraO9ta%2b3%2bRn1t8773FbWgvry0qqykAgVA1zKKAQURruyBbgTmW4BlrETLexCh2dmVG/Y3ZGXkFHCqNJ/7dWSPGrL764zAwYLI5U7udh9vr7/gLT9rvS1P0Jg9nBUDB7hKv1sFL67QH1gEXtU/rylnhpe10cQdQb9KmZwU9va8QY894t7txUYnFh6IPqq%2bEYw/pL6ypKhcYkm0u4QCLGG/dTtEAnKxdO1f0QUf23r797KyKmVlnKKCkqqmXmtJ7nB2cEnss8pE1%2bZkn9HyxLWevPVXucL2rPnGzJm6jO7U8MrwJ/neNxMf2Phc0r5piDPFy1kR5G0I8vAY%2bfTx4/EJwevXbzD7QT1qfw9qfxe2Z4H9WNd%2bp76ooFRCINyBtQTrAGB/YQwojHihb%2b6urH2sb2q5c/c2/PO3HrrPvxlfqiGOlhBrSe7FUc5l8c/7CuNE/Jz51qyxShao56eGVsW4MFyv%2btub3DHDm6nJm%2bDlz6nJWCifgZ%2bgr6MFWe/rmxCHB%2bxvb3vd2oLkRxyemqoGLPegvrS4AlNfyCvaBxAzLB2UYgllQBoDfYl1CLyzBACr70sqKtMyODpa6m4BpLmFvaUG2tuerLlack96QE3C8/yIx/Usv56COH56UBvDp4Xuw3S76nPD/JaFlrkGzgyvYIU8y0ub4s787chRGWnJnKw8aGXwHnoXDc%2b%2b/U2NHVh4atDwVJbXHva%2bkFfMyyuQWFzaxtQLDi1QLzioydIBAKIefbm8%2bqGqpp6dlkymJDx44t00sDPbUfm2O3XzVdZcDXk4L7yF9iI32JHtfYv64maCm33A3bN3bXQvG6nbaKlYayhZ4eUuqsteVz9jpKogI6984pdjQYFBsAmAbnTywOh83dLc3dyE2d9aW9NUXVVfWYHMHEx9cWFZIa8E1Ofl5EsIAABdGMl3GN/VBAXbXl3/1NDcwU5lpnA54REhYaS81wMr4yXxG/xUUSt7pipxKCekg%2bFZFfckw%2b9WjNNZ14t6T85qO5/VvmeOv6Apf5Ygd01b3o4gaaypYWxpd/z4sWvX7MDsEShCZ39bK%2by7oJ6P2t%2bGqm%2borKirKK8pQ8ODqS/IL8rP5eVm50kIBG/FANgS/B6JEK0J/ClSB%2bFOUWlRKpedmc3lpLOJCTGMnKaGmu7elABBDWmxjjoPm1pp3Agvsj8ruI3qVhTgkOlhR3909sV5rUtaCpc15G7ryl1UlTTS1rn7NOTYseMXLtj6eHsz6GxQ/Kp7CBgaGzrq69qw8FRV1leg4cHUF/FKC/KLMfXZmTkSC4tbC4K3sBYPMSweFGRxaUewf7MNGOD99Nx6bUMjYn86m5udlpaZmsrlUKjxiawsekR4cZhTX7LPeF74dClxpjJppoY0VhjVlx7QFO9S6H/T57LeZW3cdR2F2waK51TP2JhZ%2bsdlHzl23NLSwt3D1cRY38TYIDQkrLK8DlIEGHW1Laj3teVlNaUlmPelqPcQnrycrNysjGyJ%2bcWt%2bQMG8RIc4kFeQmzWPiwKthuauxLIZBqTwmBRGWxaamZKWlZKakZqGjclOib0hZe7m9szTpR3npd9fbgjn%2bbRkxrwKtW/NyOkLy2I53fHyVLbXk/VwUDlngneWunkLfu75MxWANDV1fH197l//66M1CkFeSlrK3M3Nzc6jQXSoYmBoaS4EvG%2bAPO%2bEKKPqc9Iz5SYW9jEGMQLqQa65gXIS6FoTyDcbe/qpzGTw6PDwmPCiYmx6RkpLDYd%2bhhmEZPDgGrExEW99PHy8PKgJDOo5DiKrzPH7Xq%2b17XSkHulYQ%2byvG56nte7a0K4a6J%2bx5jgaK5hJn88LJzELuo5euwEgUAICPILCPS9fPm8vJyUkqKsJkHFyEDX/trV8LCIvJxCmJ4AwMsrQtXzxOq5aVwEAGXYPAwAC24gOaKV9/1DU9ys3KiYqMjYyERKQgKZGBYRkpaRAtKTU5ip3JTkVCY9mUahkzxfenh5v0jmMBgcFjMlmcEgF9Cj6S5XYm4aedioO5mqOJmr3zJSv22icctA5YKmYkXTGDO34%2bjx03iCZkhYUCwxsrKm%2bvad26dOHiOoKRvqaRnp6xgb6dlduRQcEASxKSmqyM1Goo%2bqz%2bKmZaSlpErMzm/AOsBAALAbaNbRcUFeYWlkTBQYT6IkJNESKQwylU4KiwimMEgZ2Wmp3GR2GgsAklMYrBRGVEyEy3NnTiorK5fLSUsGts3t7YGBfleHi/f0ZJ3MVG8b4a/pqt4yVr%2buKf3o6uWhhX%2bGkfN/OSVD0DLy9PYMjQgpKSvhFZecOX1CXl5WU13VUF/LyEAblqGBjv01u7iYuHzUfpCenoqoT2VzJGbm1jEGZC0gVzB%2bfvFtbUMbMSkBfmgCOZ5ETyLREhnJ1GQOHa7xSbGJ5HgWhw51SM1gQ5DoLAokChg8vTxiiFGZOenQ2XQWrbyyrLCs2DcwwFoHb6sqdUFd4ZoO7qa%2bsq3S0Qg//%2bmt/%2bfsFXNaGqdtdPahs3NweGhcfGx334CegY6k5ElVFSVtTTVDPU3AMDHWMzbWMzU1cHrgmMxkZ2fmprIR9SmsZAQAY8CuS8Ldnv5xTjoXAkNMiiNRE6lMMqxEajyNRU5OAQAKmZFEoiZQmSQmh5aRlZqRlQZZojHJEKrI6LCgEH%2bwH%2bpAppJoLJqX70vbc2cv29lZqCufV5W%2bpC5/TlXqmpZMfWNfIKX2%2bsNAvJbJOXvnh0%2bfhUdH%2bgb49g4O3nNyPHb0ryo4eYIaTleLAFky0NcyNdG3tDABkvO2VnExMRAhDpPNZjAlpmfXYE3NrM4tbAFARXVDbGJcFDEqkQqBIZHpiRR6EkiHGxI9kcGmMtlUeAmJpzPJcAOzKD0rlZuVAmCcNBYSsMhgOovKTmUxWJSCkmImJ%2bX2nRvefj4Xz9mYKUraqMpYyx0JdXmYWzdhae9jfe3pldvuj72T7O8%2bCokM8w3ya%2bvo8A8OOvo3CUUFWQJeSQ2P09fTMDDQMjbSNTMzsLIyRW5MDSLDwricVCaVJoGph8y8GVvMyMkF6fFIZkgUVB/YnEghUgCDmYQAJFNZHBoNqQm4S6YjHyAz2TR2CgMsh80BGBKS4pIoCXQ2HSFn0uqa2109nkVEhTk%2beGCqqmCFk7yqLpWdV%2bvgEnvJweXKHfdQcrFfXJaXf4h3gH9weEhZZUVMfPzxo3%2bRk5UiqCqpKCtqQZCgE1AAC3MjU2M9IwMtczNDfx8fDpMlgXnfwR%2bgMulxSXFUJpXKotCTYdJT6CwS%2bEqixiMA9EQqPQleQgVQZYAHH6BgVyryEopDh06A1JGpiVABeCckPKixtTMiOtLP39v5%2bTNrA10jqSMPzls9D6CbnX943z3WLzYrs%2bpNLKskr6CQSCYHhQfn8PKoLOaJX47ISkuqqSiqKMsTCMp6uppGhjpgvIWFkZGhtqGeBrw0NzcKCwyUGJ8UllXWJlKTYMIkoy6y0KAj7jISqQzQCmkhUWgJMIjgfSrkipZIPQBAC0Uh05LAeLgyktH6MCBjUB9qZHQor6iYnc718HR95vbcxtZW7eSR2zYW956G2j8M9orMTCnpKe9coGTU1DU01re0%2b4eGcDO5KRlcydO/wKaGV1ZQUVbA43Ha2upQBGhiSwtj0K2rhTc20DIxM7h43loiPTsTLGenJ6dw2SncZE46C4IOKkmgGOYNhQiiaSwShZFEpiZAbKB9YSJRkAih3jNIGEAcZC8pDjYK%2bAlAmJBETKIkxhCjo%2bNi84pKn7k9dXV3vXbTQVla%2bp7j87vPol0CGMSUutpXoobedTavqa2zc3J2oaiikkwnZ%2bXny8mekT5zCo%2bTx6soqqoqaWkRDAy0TZAKGFtbmRroaepoqsJLCJJEchqTm5OemceFQwE7ncVOY1JZZBiUCaQ4WEkUZPhgC5IDCwYowgD34D0sBuI3YETFhMcSoyKiQulMAKPCywQSEaIfFhFa09Dy9LlzYHDA46dPrjs4PfaK9wxPC6GUcsv7%2beMfmge2uCVtA0PDY1PT0/MLWfl5%2bcUlOJy81JmTqjh5NVUlANDUUtOHYWqib2FpAgDmZgaaBJwh%2bo5ERk56Rh6Xm5OWkZsOFYDJCA1KTIyJjgtPJMclUePBTqRfkfAg9scDGJkIliPeI9KRGygFDNDQ8KDwqJC4%2bGiYqvGJseGRIZA6eL%2bqtvGF9wu48fb1eu7p/9A9Ni6lIS6ltqhpamTxn00Dm7kVHRPTUxMzc7MLizWNja1d3SoqigAAk1Qdj4NBBBUAAGOYpFamMIiAQUdLTVNDFfY4iZyCLG5uelp2alZ%2bBuxKIBTiQaLDFhYUHRcBIwgWEmukUymJ1AQisosRESomCToBblBCSlRshI%2bfF6iEIgAeHChgw4aahEUE1dQ3hkaGh4QFwBnkicuzGw986PmvqNkt1XzB9Np/1x9InTcAAADfSURBVLxaKahqFwgW5hYFEzOzBaXF/N5%2bPF5ZWuoUVEBDTZlAUNHWUcciZGVtBsvGxgyaGK%2bioK2lJpFTmJ2WyeFmp2YXZKWksyDroJKWTCYmRPsH%2bsTFR0H0kVaGCkC0SHFx6DaMRIuBRAhqkoRudmC550v34NAAYID8wGyFYQoMgcG%2bLW3tJDrNzcMlOi7K0/vFrQcenNJBFq%2brZXBjaed/yjoWKxr5omXhkmi5Z2iIV1w48GYMIiQnI6mqrKCprqKpideB/dhI19TM0NrG/KytpTUcxC1N4E9VVRT%2bPzbiUw29GeqqAAAAAElFTkSuQmCC' /%3e%3c/svg%3e"},"path":"/authors/justin-yoo/"}]}},{"node":{"title":"애저 펑션에 Open API 확장 기능을 이용해 파워 플랫폼용 커스텀 커넥터 곧바로 생성하기","path":"/posts/2021/02/09/creating-custom-connector-from-azure-functions-with-swagger/","image":"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-00.png","image_caption":"파워 플랫폼에 Open API 확장 기능을 연동시킨 애저 펑션 API로 커스텀 커넥터를 생성해서 연결","description":"이 포스트에서는 애저 펑션 API에 Open API 확장 기능을 통합해서 파워 플랫폼에 사용할 커스텀 커넥터를 생성하는 방법에 대해 알아봅니다.","content":"<p><a href=\"https://github.com/Azure/azure-functions-openapi-extension\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션을 위한 Open API 확장 기능</a>을 사용하면 좋은 점 중에 하나가 바로 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-15268-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>으로 API를 개발할 때 이 API의 발견가능성(discoverability)을 높여준다는 것입니다. 따라서, 이를 이용하면 굉장히 손쉽게 <a href=\"https://docs.microsoft.com/ko-kr/azure/api-management/api-management-key-concepts?WT.mc_id=dotnet-15268-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 API 관리도구</a>에 연동시킬 수 있습니다. 또한 <a href=\"https://docs.microsoft.com/ko-kr/azure/logic-apps/logic-apps-overview?WT.mc_id=dotnet-15268-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 로직 앱</a>이나 <a href=\"https://powerplatform.microsoft.com/ko-kr/?WT.mc_id=dotnet-15268-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">파워 플랫폼</a> 에서 사용하는 <a href=\"https://docs.microsoft.com/ko-kr/connectors/custom-connectors/?WT.mc_id=dotnet-15268-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">커스텀 커넥터</a> 역시도 쉽게 생성할 수 있는데요, 이 포스트에서는 이 Open API 확장 기능을 이용해 애저 펑션에 Open API 문서를 통합한 후, 이를 이용해 커스텀 커넥터를 만들어 보는 방법에 대해 알아봅니다.</p>\n<h2 id=\"샘플-애저-펑션-코드\"><a href=\"#%EC%83%98%ED%94%8C-%EC%95%A0%EC%A0%80-%ED%8E%91%EC%85%98-%EC%BD%94%EB%93%9C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>샘플 애저 펑션 코드</h2>\n<p>우선 기본적인 뼈대만 갖춘 애저 펑션 샘플 코드는 아래와 같습니다. <code class=\"language-text\">/feeds/items</code>와 <code class=\"language-text\">/feeds/item</code> 이라는 두 개의 엔드포인트를 나타냅니다 (line #7, 15).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist104331941\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-01-feed-reader-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-01-feed-reader-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-01-feed-reader-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">namespace</span> <span class=\"pl-en\">FeedReaders</span>.<span class=\"pl-en\">FunctionApp</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-01-feed-reader-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-01-feed-reader-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">FeedReaderHttpTrigger</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-01-feed-reader-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-01-feed-reader-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">        [<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">FeedReaderHttpTrigger</span>.<span class=\"pl-smi\">GetFeedItemsAsync</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-01-feed-reader-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">GetFeedItemsAsync</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-01-feed-reader-cs-LC7\" class=\"blob-code blob-code-inner js-file-line highlighted\">            [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Function</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>feeds/items<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-01-feed-reader-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-01-feed-reader-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-01-feed-reader-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">            ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-01-feed-reader-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-01-feed-reader-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-01-feed-reader-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">        [<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">FeedReaderHttpTrigger</span>.<span class=\"pl-smi\">GetFeedItemAsync</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-01-feed-reader-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">GetFeedItemAsync</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-01-feed-reader-cs-LC15\" class=\"blob-code blob-code-inner js-file-line highlighted\">            [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Function</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>feeds/item<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-01-feed-reader-cs-LC16\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-01-feed-reader-cs-LC17\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-01-feed-reader-cs-LC18\" class=\"blob-code blob-code-inner js-file-line\">            ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-01-feed-reader-cs-LC19\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-01-feed-reader-cs-LC20\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-feed-reader-cs-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-01-feed-reader-cs-LC21\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2b4bc731ff8f2cdb5e80e28bd7dff9e7/raw/380e6f3505b9b9763c4458626012165ee70de593/01-feed-reader.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2b4bc731ff8f2cdb5e80e28bd7dff9e7#file-01-feed-reader-cs\">01-feed-reader.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>이를 실행시키면 당연하겠지만, 아래와 같이 두 개의 엔드포인트를 확인할 수 있습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-01.png\" alt=\"애저 펑션 엔드포인트\"></p>\n<h2 id=\"nuget-패키지-설치\"><a href=\"#nuget-%ED%8C%A8%ED%82%A4%EC%A7%80-%EC%84%A4%EC%B9%98\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>NuGet 패키지 설치</h2>\n<p>애저 펑션에 Open API 문서를 손쉽게 생성해 주는 NuGet 패키지를 설치합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist104331941\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-install-nuget-package-2-sh\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-shell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-02-install-nuget-package-2-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-install-nuget-package-2-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\">dotnet add <span class=\"pl-k\">&lt;</span>PROJECT<span class=\"pl-k\">&gt;</span> package Microsoft.Azure.WebJobs.Extensions.OpenApi</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2b4bc731ff8f2cdb5e80e28bd7dff9e7/raw/380e6f3505b9b9763c4458626012165ee70de593/02-install-nuget-package-2.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2b4bc731ff8f2cdb5e80e28bd7dff9e7#file-02-install-nuget-package-2-sh\">02-install-nuget-package-2.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<h2 id=\"보일러플레이트-코드-설치\"><a href=\"#%EB%B3%B4%EC%9D%BC%EB%9F%AC%ED%94%8C%EB%A0%88%EC%9D%B4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%84%A4%EC%B9%98\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>보일러플레이트 코드 설치</h2>\n<p>사실, 위 NuGet 패키지를 설치하면 보일러플레이트 코드가 자동으로 설치가 됩니다. 따라서, 이 부분은 딱히 고민할 부분이 없습니다. 앱을 빌드하고 실행시켜볼까요? 아래 그림과 같이 추가 엔드포인트가 보일텐데, 이 세 엔드포인트가 바로 Open API와 관련한 것들입니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-02.png\" alt=\"애저 펑션 Open API 엔드포인트\"></p>\n<p>이제 이 중에서 <code class=\"language-text\">http://localhost:7071/api/swagger/ui</code>를 브라우저에서 실행시켜 보면 아래와 같습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-03.png\" alt=\"엔드포인트 없는 애저 펑션 Swagger UI 페이지\"></p>\n<p>일단 Swagger UI 페이지는 나왔지만, 아직 엔드포인트를 설정하지 않았기 때문에 자세한 내용은 보이질 않습니다.</p>\n<h2 id=\"open-api-확장을-위한-데코레이터-지정\"><a href=\"#open-api-%ED%99%95%EC%9E%A5%EC%9D%84-%EC%9C%84%ED%95%9C-%EB%8D%B0%EC%BD%94%EB%A0%88%EC%9D%B4%ED%84%B0-%EC%A7%80%EC%A0%95\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Open API 확장을 위한 데코레이터 지정</h2>\n<p>이제 아래와 같이 각각의 엔드포인트에 데코레이터를 이용해 Open API 설정을 해 보겠습니다. <code class=\"language-text\">OpenApiOperationAttribute</code>, <code class=\"language-text\">OpenApiSecurityAttribute</code>, <code class=\"language-text\">OpenApiRequestBodyAttribute</code>, <code class=\"language-text\">OpenApiResponseWithBodyAttribute</code> 등의 데코레이터를 사용했습니다 (line #1-4, 13-16).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist104331941\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-08-add-decorators-2-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-08-add-decorators-2-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC1\" class=\"blob-code blob-code-inner js-file-line highlighted\">[<span class=\"pl-k\">OpenApiOperation</span>(<span class=\"pl-smi\">operationId</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>getFeedItems<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">tags</span>: <span class=\"pl-k\">new</span>[] { <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>feedItem<span class=\"pl-pds\">\"</span></span> }, <span class=\"pl-en\">Summary</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Gets a list of feed items from the given feed<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>This operation returns a list of feed items from the given feed URI.<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Visibility</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">OpenApiVisibilityType</span>.<span class=\"pl-smi\">Important</span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC2\" class=\"blob-code blob-code-inner js-file-line highlighted\">[<span class=\"pl-k\">OpenApiSecurity</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>function_key<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">SecuritySchemeType</span>.<span class=\"pl-smi\">ApiKey</span>, <span class=\"pl-en\">Name</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>x-functions-key<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">In</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">OpenApiSecurityLocationType</span>.<span class=\"pl-smi\">Header</span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC3\" class=\"blob-code blob-code-inner js-file-line highlighted\">[<span class=\"pl-k\">OpenApiRequestBody</span>(<span class=\"pl-smi\">contentType</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>application/json<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">bodyType</span>: <span class=\"pl-k\">typeof</span>(<span class=\"pl-k\">FeedReaderRequest</span>), <span class=\"pl-en\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Feed reader request payload<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC4\" class=\"blob-code blob-code-inner js-file-line highlighted\">[<span class=\"pl-k\">OpenApiResponseWithBody</span>(<span class=\"pl-smi\">statusCode</span>: <span class=\"pl-smi\">HttpStatusCode</span>.<span class=\"pl-smi\">OK</span>, <span class=\"pl-smi\">contentType</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>application/json<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">bodyType</span>: <span class=\"pl-k\">typeof</span>(<span class=\"pl-k\">List</span>&lt;<span class=\"pl-k\">FeedReaderResponse</span>&gt;), <span class=\"pl-en\">Summary</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>List of feed reader response payload<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">FeedReaderHttpTrigger</span>.<span class=\"pl-smi\">GetFeedItemsAsync</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">GetFeedItemsAsync</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Function</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>feeds/items<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC13\" class=\"blob-code blob-code-inner js-file-line highlighted\">[<span class=\"pl-k\">OpenApiOperation</span>(<span class=\"pl-smi\">operationId</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>getFeedItem<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">tags</span>: <span class=\"pl-k\">new</span>[] { <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>feedItem<span class=\"pl-pds\">\"</span></span> }, <span class=\"pl-en\">Summary</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Gets a single feed item from the given feed<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>This operation returns a single feed item from the given feed URI.<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Visibility</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">OpenApiVisibilityType</span>.<span class=\"pl-smi\">Important</span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC14\" class=\"blob-code blob-code-inner js-file-line highlighted\">[<span class=\"pl-k\">OpenApiSecurity</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>function_key<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">SecuritySchemeType</span>.<span class=\"pl-smi\">ApiKey</span>, <span class=\"pl-en\">Name</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>x-functions-key<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">In</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">OpenApiSecurityLocationType</span>.<span class=\"pl-smi\">Header</span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC15\" class=\"blob-code blob-code-inner js-file-line highlighted\">[<span class=\"pl-k\">OpenApiRequestBody</span>(<span class=\"pl-smi\">contentType</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>application/json<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">bodyType</span>: <span class=\"pl-k\">typeof</span>(<span class=\"pl-k\">FeedReaderRequest</span>), <span class=\"pl-en\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Feed reader request payload<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC16\" class=\"blob-code blob-code-inner js-file-line highlighted\">[<span class=\"pl-k\">OpenApiResponseWithBody</span>(<span class=\"pl-smi\">statusCode</span>: <span class=\"pl-smi\">HttpStatusCode</span>.<span class=\"pl-smi\">OK</span>, <span class=\"pl-smi\">contentType</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>application/json<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">bodyType</span>: <span class=\"pl-k\">typeof</span>(<span class=\"pl-k\">FeedReaderResponse</span>), <span class=\"pl-en\">Summary</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Feed reader response payload<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC17\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-k\">nameof</span>(<span class=\"pl-smi\">FeedReaderHttpTrigger</span>.<span class=\"pl-smi\">GetFeedItemAsync</span>))]</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC18\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">GetFeedItemAsync</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC19\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Function</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>feeds/item<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC20\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC21\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC22\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-add-decorators-2-cs-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-08-add-decorators-2-cs-LC23\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/2b4bc731ff8f2cdb5e80e28bd7dff9e7/raw/380e6f3505b9b9763c4458626012165ee70de593/08-add-decorators-2.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/2b4bc731ff8f2cdb5e80e28bd7dff9e7#file-08-add-decorators-2-cs\">08-add-decorators-2.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>이렇게 컴파일 한 후, 다시 펑션 앱을 실행시켜 보면 아래와 같이 Swagger UI 페이지가 제대로 보입니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-04.png\" alt=\"엔드포인트 포함한 애저 펑션 Swagger UI 페이지 #1\"></p>\n<p>이렇게 애저 펑션에 Open API 익스텐션을 추가해서 Swagger UI 페이지를 붙이는 것 까지 살펴봤습니다. 이를 애저로 배포한 후 다시 Swagger UI 페이지에 접속해 볼까요?</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-05.png\" alt=\"엔드포인트 포함한 애저 펑션 Swagger UI 페이지 #1\"></p>\n<p>이제 배포가 끝났으니 실제 커스텀 커넥터를 만들기 위한 다음 단계로 넘어가도록 하겠습니다.</p>\n<h2 id=\"커스텀-커넥터-생성\"><a href=\"#%EC%BB%A4%EC%8A%A4%ED%85%80-%EC%BB%A4%EB%84%A5%ED%84%B0-%EC%83%9D%EC%84%B1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>커스텀 커넥터 생성</h2>\n<p>커스텀 커넥터는 한 번 만들어 놓으면 <a href=\"https://flow.microsoft.com/ko-kr/?WT.mc_id=dotnet-15268-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">파워 오토메이트</a>와 <a href=\"https://powerapps.microsoft.com/ko-kr/?WT.mc_id=dotnet-15268-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">파워 앱스</a> 어디서든 사용할 수 있습니다. 따라서 여기서는 파워 오토메이트에서 커스텀 커넥터를 만들어 보기로 합니다. 먼저 아래와 같이 애저 펑션에서 제공하는 Swagger 문서의 URL을 지정합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-06.png\" alt=\"파워 오토메이트 커스텀 커넥터 #1\"></p>\n<p>그런데, 가끔 아래와 같이 잘 안될 때가 있습니다. 이것은 현재 알려진 버그인데요, 괜찮습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-07.png\" alt=\"파워 오토메이트 커스텀 커넥터 #2\"></p>\n<p>그럴 땐 당황하지 말고, Swagger 문서를 저장한 후 직접 업로드합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-08.png\" alt=\"파워 오토메이트 커스텀 커넥터 #3\"></p>\n<p>이렇게 하면 그 다음부터는 그냥 자동으로 진행됩니다. 애초에 이 Open API 익스텐션이 바로 이 커스텀 커넥터를 염두에 두고 만든 것이어서 문제없이 진행됩니다. 아래와 같이 <code class=\"language-text\">✅ Create Connector</code> 버튼을 눌러 마무리합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-09.png\" alt=\"파워 오토메이트 커스텀 커넥터 #4\"></p>\n<p>이제 커스텀 커넥터가 제대로 작동하는지 테스트를 해 볼 차례입니다. 아래 그림과 같이 <code class=\"language-text\">4. Test</code> 탭에서 커스텀 커넥터를 연결합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-10.png\" alt=\"파워 오토메이트 커스텀 커넥터 #5\"></p>\n<p>그러면 아래 그림과 같이 애저 펑션 API 키 값을 입력하라는 표시가 나타나는데요, 여기서 API 키 값을 입력한 후 연결합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-11.png\" alt=\"파워 오토메이트 커스텀 커넥터 #6\"></p>\n<p>커스텀 커넥터에 성공적으로 커넥션이 만들어지면, 이제 아래와 같이 실제로 테스트를 진행합니다. 아래 그림의 입력창은 바로 Swagger 문서에 정의된 요청 객체의 형식을 그대로 따라갑니다. 필요한 데이터를 입력하고 아래 <code class=\"language-text\">Test Operation</code> 버튼을 눌러보겠습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-12.png\" alt=\"파워 오토메이트 커스텀 커넥터 #7\"></p>\n<p>그러면 아래와 같이 테스트가 성공적으로 수행된 것이 보입니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-13.png\" alt=\"파워 오토메이트 커스텀 커넥터 #8\"></p>\n<p>이제 커스텀 커넥터를 생성했으니, 파워 오토메이트를 하나 만들어 보겠습니다.</p>\n<h2 id=\"커스텀-커넥터를-이용한-파워-오토메이트-플로우-만들기\"><a href=\"#%EC%BB%A4%EC%8A%A4%ED%85%80-%EC%BB%A4%EB%84%A5%ED%84%B0%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%ED%8C%8C%EC%9B%8C-%EC%98%A4%ED%86%A0%EB%A9%94%EC%9D%B4%ED%8A%B8-%ED%94%8C%EB%A1%9C%EC%9A%B0-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>커스텀 커넥터를 이용한 파워 오토메이트 플로우 만들기</h2>\n<p>이번에 만드는 파워 오토메이트 플로우는 파워 앱에서 이용할 것이기 때문에 아래와 같은 순서로 생성합니다. 먼저 <code class=\"language-text\">Instant Flow</code>를 선택합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-14.png\" alt=\"파워 오토메이트 커스텀 커넥터 #9\"></p>\n<p>그 다음에는 아래 그림과 같이 파워 앱을 트리거로 지정합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-15.png\" alt=\"파워 오토메이트 커스텀 커넥터 #10\"></p>\n<p>그러면 이제 본격적인 플로우 작성을 위한 디자이너 창이 생겼습니다. 여기서 <code class=\"language-text\">➕ New Step</code> 버튼을 클릭합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-16.png\" alt=\"파워 오토메이트 커스텀 커넥터 #11\"></p>\n<p>검색 창에 <code class=\"language-text\">ATOM</code>을 입력하면 방금 우리가 생성한 커스텀 커넥터가 보입니다. 그리고, 애저 펑션에서 만든 두 개의 엔드포인트가 나타나는 것을 알 수 있죠? 여기서 피드 아이템 하나만 가져오는 액션을 아래와 같이 선택합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-17.png\" alt=\"파워 오토메이트 커스텀 커넥터 #12\"></p>\n<p>액션을 선택하면 앞서 커스텀 커넥터를 테스트 할 때와 비슷한 필드 입력 화면이 나타납니다. 동일한 내용을 입력합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-18.png\" alt=\"파워 오토메이트 커스텀 커넥터 #13\"></p>\n<p>이 플로우의 목적은 방금 커스텀 커넥터로 받아온 유튜브 피드를 소셜미디어에 포스팅하는 것이므로, 다음 액션으로 아래와 같이 트위터에 포스팅하는 액션을 선택합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-19.png\" alt=\"파워 오토메이트 커스텀 커넥터 #14\"></p>\n<p>그리고 난 후, 앞서 커스텀 커넥터로부터 받아온 데이터를 아래와 같이 트위터 포스트 데이터로 입력합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-20.png\" alt=\"파워 오토메이트 커스텀 커넥터 #15\"></p>\n<p>이번에는 파워 앱으로 이 플로우의 결과를 넘겨줘야 하니 아래와 같이 응답 객체 액션을 선택합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-21.png\" alt=\"파워 오토메이트 커스텀 커넥터 #16\"></p>\n<p>그리고, 응답 객체의 본문에는 커스텀 커넥터에서 받아온 응답 객체 전부를 넣습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-22.png\" alt=\"파워 오토메이트 커스텀 커넥터 #17\"></p>\n<p>여기까지 하면 파워 오토메이트 플로우 작성은 거의 다 끝났습니다. 한 번 테스트를 해 볼까요? 우측 상단의 <code class=\"language-text\">Test</code> 버튼을 클릭해서 아래와 같이 선택한 후 <code class=\"language-text\">Save &amp; Test</code> 버튼을 클릭합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-23.png\" alt=\"파워 오토메이트 커스텀 커넥터 #18\"></p>\n<p>그러면 다음 화면에서는 이 플로우에서 사용하는 커넥터들이 다 제대로 연결되어 있는지 확인하게 되는데, 다 연결 되었다면 아래 <code class=\"language-text\">Continue</code> 버튼을 눌러 계속 진행합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-24.png\" alt=\"파워 오토메이트 커스텀 커넥터 #19\"></p>\n<p>모든 것이 잘 진행된다면 아래와 같이 테스트에 성공했다는 메시지를 볼 수 있습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-25.png\" alt=\"파워 오토메이트 커스텀 커넥터 #20\"></p>\n<p>이제 실제로 워크플로우가 어떻게 진행됐는지 살펴보겠습니다. 모든 액션은 아래와 같이 성공적으로 진행되었습니다. 여기서 응답 객체 데이터를 복사해 놓겠습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-26.png\" alt=\"파워 오토메이트 커스텀 커넥터 #21\"></p>\n<p>그리고 실제로 트위터에도 성공적으로 포스팅이 된 것을 확인할 수 있습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-27.png\" alt=\"파워 오토메이트 커스텀 커넥터 #22\"></p>\n<p>이제 응답 객체를 파워앱에서 좀 더 확실하게 인식할 수 있게끔 마지막 설정을 해 줄 차례입니다. 앞서 복사한 응답 객체 데이터를 가지고 JSON 스키마를 설정합니다. 아래 그림의 <code class=\"language-text\">Generate from Sample</code> 버튼을 클릭합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-28.png\" alt=\"파워 오토메이트 커스텀 커넥터 #23\"></p>\n<p>방금 복사해 놨던 JSON 응답 객체를 붙여넣고 <code class=\"language-text\">Done</code> 버튼을 클릭합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-29.png\" alt=\"파워 오토메이트 커스텀 커넥터 #24\"></p>\n<p>그러면 JSON 응답객체 스키마가 생성된 것을 확인할 수 있습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-30.png\" alt=\"파워 오토메이트 커스텀 커넥터 #25\"></p>\n<p>여기까지 한 후 저장하면 파워 오토메이트 플로우 작성은 모두 끝났습니다.</p>\n<h2 id=\"파워-앱에-파워-오토메이트-연동하기\"><a href=\"#%ED%8C%8C%EC%9B%8C-%EC%95%B1%EC%97%90-%ED%8C%8C%EC%9B%8C-%EC%98%A4%ED%86%A0%EB%A9%94%EC%9D%B4%ED%8A%B8-%EC%97%B0%EB%8F%99%ED%95%98%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>파워 앱에 파워 오토메이트 연동하기</h2>\n<p>이제 파워 앱을 만들어 볼 차례입니다. 이번에 만드는 파워 앱에 앞서 만든 파워 오토메이트를 연결해 보도록 하죠. 우선 새 앱 캔버스를 하나 생성합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-31.png\" alt=\"파워 앱스 #1\"></p>\n<p>그 다음에 버튼 콘트롤 하나, 라벨 콘트롤 두 개, 이미지 콘트롤 하나를 캔버스에 추가합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-32.png\" alt=\"파워 앱스 #2\"></p>\n<p>버튼을 눌렀을 때 필요한 액션이 바로 파워 오토메이트를 실행시키는 것입니다. 이 액션을 아래와 같이 연결합니다. 버튼을 클릭한 후 상단의 메뉴 바에서 <code class=\"language-text\">Action</code>을 클릭합니다. 그리고 바로 아래에 있는 <code class=\"language-text\">Power Automate</code>를 선택합니다. 그 다음에 나오는 화면에서 앞서 만들어 둔 파워 오토메이트를 선택하면 됩니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-33.png\" alt=\"파워 앱스 #3\"></p>\n<p>연결이 끝나면 곧바로 함수 창에 어떤 작업을 할 것인지를 물어보는데, 여기에 <code class=\"language-text\">ClearCollect(result, AmplifyingaRandomYouTubeContent.Run())</code> 라고 입력합니다. 여기서 <code class=\"language-text\">AmplifyingaRandomYouTubeContent()</code> 함수는 파워 오토메이트 이름을 의미합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-34.png\" alt=\"파워 앱스 #4\"></p>\n<p>이제 다른 레이블 콘트롤 두 개와 이미지 콘트롤 한 개에는 이 파워 오토메이트 실행 결과를 표시합니다. 각각의 콘트롤에 아래와 같이 입력합니다.</p>\n<ul>\n<li>상단 레이블 콘트롤: <code class=\"language-text\">First(result).title</code></li>\n<li>하단 레이블 콘트롤: <code class=\"language-text\">First(result).link</code></li>\n<li>이미지 콘트롤: <code class=\"language-text\">First(result).thumbnailLink</code></li>\n</ul>\n<p>이렇게 입력한 후 파워 앱을 실행시켜 버튼을 클릭해 볼까요? 그러면 아래와 같은 결과가 나타납니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-35.png\" alt=\"파워 앱스 #5\"></p>\n<p>그리고 트위터에도 제대로 포스트가 잘 이루어진 것을 확인할 수 있습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2020/07/creating-custom-connector-from-azure-functions-with-swagger-36.png\" alt=\"파워 앱스 #6\"></p>\n<br/>\n<hr>\n<p>지금까지, <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-15268-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a> 앱에 <a href=\"https://github.com/Azure/azure-functions-openapi-extension\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Open API 익스텐션</a>을 설치해서 자동으로 Swagger 문서를 만들어주게끔 하는 것과 더불어, 이를 이용해 <a href=\"https://flow.microsoft.com/ko-kr/?WT.mc_id=dotnet-15268-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">파워 오토메이트</a>에 쓰이는 <a href=\"https://docs.microsoft.com/ko-kr/connectors/custom-connectors/?WT.mc_id=dotnet-15268-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">커스텀 커넥터</a>를 손쉽게 만드는 방법, 그리고 파워 오토메이트에 이 커스텀 커넥터를 쉽게 붙이는 방법, 마지막으로 <a href=\"https://powerapps.microsoft.com/ko-kr/?WT.mc_id=dotnet-15268-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">파워 앱</a>에 파워 오토메이트를 쉽게 연동하는 방법에 대해 알아 보았습니다. 이렇게 애저 펑션에 간단한 익스텐션 하나만 설치하는 것으로 애저 펑션 API의 확장성이 엄청나게 높아지게 되는데, 이를 이용하면 <a href=\"https://powerplatform.microsoft.com/ko-kr/?WT.mc_id=dotnet-15268-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">파워 플랫폼</a>에서 필요한 API를 정말 손쉽게 만들 수 있으리라 확신합니다.</p>\n<h2 id=\"더-궁금하다면\"><a href=\"#%EB%8D%94-%EA%B6%81%EA%B8%88%ED%95%98%EB%8B%A4%EB%A9%B4\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>더 궁금하다면...</h2>\n<ul>\n<li>애저 클라우드에 관심이 있으신가요? ➡️ <a href=\"https://azure.microsoft.com/ko-kr/free/?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">무료 애저 계정 생성하기</a></li>\n<li>애저 클라우드 무료 온라인 강의 코스를 들어 보세요! ➡️ <a href=\"https://docs.microsoft.com/ko-kr/learn/?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Learn</a></li>\n<li>마이크로소프트 개발자 유튜브 채널 ➡️ <a href=\"https://www.youtube.com/channel/UCdgR-b2t7Byu_UGrHnu-T0g\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Developer Korea</a></li>\n</ul>\n","humanTime":"09 February 2021","datetime":"Tue Feb 09 2021 12:00:00 UTC+00:00","canonical_url":"https://blog.aliencube.org/ko/2020/07/15/creating-custom-connector-from-azure-functions-with-swagger/","timeToRead":14,"tags":[{"id":"azure-functions","title":"azure-functions","path":"/tags/azure-functions/"},{"id":"power-platform","title":"power-platform","path":"/tags/power-platform/"},{"id":"openapi","title":"openapi","path":"/tags/openapi/"},{"id":"custom-connector","title":"custom-connector","path":"/tags/custom-connector/"}],"category":{"id":"Power Platform","title":"Power Platform","path":"/categories/power-platform/","belongsTo":{"totalCount":2,"edges":[{"node":{"title":"명령어 한 줄로 파워 플랫폼 실습 환경 설정하기","path":"/posts/2021/04/13/single-command-provisioning-for-power-platform-hands-on-labs-environment/"}},{"node":{"title":"애저 펑션에 Open API 확장 기능을 이용해 파워 플랫폼용 커스텀 커넥터 곧바로 생성하기","path":"/posts/2021/02/09/creating-custom-connector-from-azure-functions-with-swagger/"}}]}},"author":[{"id":"justin-yoo","name":"유저스틴","image":{"type":"image","mimeType":"image/png","src":"/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png","size":{"width":500,"height":500},"sizes":"(max-width: 500px) 100vw, 500px","srcset":["/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png 500w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 500 500' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-6a0325b746fa0b3948747e4a6f689de9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-6a0325b746fa0b3948747e4a6f689de9)' width='500' height='500' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC%2baJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVRo3pWZd1RT67b2ueccy7YgHQKE0HsvYkdFsaFYEKUI0nsnlPSEhBI6offeISgdpPeQ0JFi3%2bfse84Yt/x3v7%2b/udaCiLq3d9893rH2Soz4/J75zPm%2bK0jMz68sLq4tLa0LhVvLy9srK7tra%2b/Ea339/fr6h0Pr459Za2sfflyrq%2b/R9W5lZW95eVck2hGJtoWwlt4Kl7YEgk3B4oZgYWNxfm1hfm1%2bbmVudnl2RjgzvTQ9JZiaXJwYnx8fmxsbnR59M/VmZHJ4aHxocGyg/43E7KxoYWFtEf6yYFMofLu8vLO6undIPQKwsYGtTxsbH9H1CVugFbv%2bEcNhmAOA9ysr%2bwzLwm0RLATg7ZJga2lxEwVYX5j7HYDJiYWJcQCYAYCR4QkAGBwYRQBmZoTz86sLC%2bvAAADgCgBg0lHR2FWs%2b8NhgMMkf6YO3wCIdpdFCAD8o0tLW8hCAUAJCrA6PwcAIgCYmRYDzI%2bNzmIVAIb9CgDAHHx6HgGAnwIAWIpQ48WW/47oP2L4Qes7uPnxTQRAiKYIAxBsIgCLKMB%2bhEQ/VAADmP4mQtPTwtnZFWCAvwk/CH4cBnBY9%2bbmZ/T6M4ADie/gw7u7v%2b3t/fv29j/evfsn3Ozs/AZgIF0kgujvIgDLSAWQNhAiPXAAsLEIFYAegArMrs7NrmAV%2bBZgDgP4WoHx8YWpKYRhfn4N2kBcASz0IBpdn7HrH6kHcTs7/4C1t/fPmZnVzs7%2bxERaRHhMZERscFB4R0cvqAS58Ke7u/8OACLE%2b10hLAAQHDQx0gAYwCoCMLPyuxWANvimAqOjc5OTSwAAFTgE8B6z/xDA55%2bE5/Pn/%2bofmLK/ftPN1cPh5m0pyVOy0lLysjLSZ87ISksrKSiYGJmctbF95uKal1O4urK3ufVFKNwRLu3nRyhAABaRCiANcNDEfxQhAIA%2bPgAYn1iYmRGB/Yd7AG2Aj/%2bremwKra19rK5uuXL56i/HjkqePIFIl5ORg/9JSkqePi156uSpEyeP/O1vf/nLv0lISMhISz9%2b5NzSzN/Z/vvmxuclGEECFGBxc2FxHRtBUAHU/p/1wFcArInF6rExinUwqv5/wXi3908ul6evoycvI62moqyGV1FTVVFSkMMpKSgpIjVQVJBXUkTupM5ISkvB5fQvx49rENSfI9UogmqA90uo/Wj7rs8jHbyKzlCsAZamJg/vA1gFJr%2bOUdjFBIKv3qObwOH8fDxg%2bHx4YfZDpqOjE1SUFPE4JXW8ihZBTVdLw0BHSwOvoqmmqqmmoq6KwysrAg9ccYoKCvKysIDqxC/Hjx7566kTv2SkZ29ufATFSAMsiNVDBZZnp0UzU1/tB/UHANPYPrBfAWz/Ent/aIB%2bB/ANA0wbaMem5ld6unog10BXRx90q6nqa6pdtja%2bYWty46zR3QtmD%2b0s7cx17cx1zhtpauNxyggJDhjOSJ6CjP1y7Mjtm7dGhqfWoA6Lm0h%2b9gFW5iA/06LpKaE4PBjAQQMgIwgq0N83IoGdIA7UY/vux9%2brwKfD9m9tfREt7121u66BV9XX1jLS0bA21HK5aUv2f5gW4VJAdK2keFWRX1QnuWUF3MsLvMvxvuVlb37ZmKBPUFaSl4UmgTqcPnnizOmTgESMjYdBhPTu/BqqHhpgeWZaiNovENuPqv86Q/cjBOoPjH9/kOyPh8z%2bPjzIgui/%2b1dMTCJeWUlbg2Brqh/j6sAjutaz/GZqSXM1CbPlsbOlMeO80MEMPz7dvTXRpSXBpSz4Dv2JrccVAzMNJVVFOXlZGFGAcPzUyROmJiaTE4uwCczNYvavzCD2L00j6vfTP4ocImZGhsX5QdQjFTh0avi6bf1kwQd2d36LjCTiVZS11NVNdQgcP8e%2bzOCxkti5OspaR8pmV6qonjJTGD6ZHzIMALTnnTRXPtWtOfZR4ctrDCcrzwtaVurymorS8lKSp0%2bdgAUDi0ljra2%2bm5leRuyfXp6ZQgCmJgTi/GD2Q96Gh77ajwAcHNSwufn55wDQuLC58rtHFOTkVJUUYeyEPrwynBW0WJe4wU/b7c//MFLyYaRs61WWsJY0XRA%2bnhPYz3nZx3k5kObbRXWrCXVkP7SKvKb3yAx3QUNWT0laRvIk/Hf0yN9winItzZ2w34F0dP5A%2bpfE9ovH//DQ1y0M1Pf1DiEAm5sf0Ov%2bYeEnAHBY%2bPT5P5nMdGnJU1oa6udNdcuIz0YLI9Y6OO%2bGC98PFX8YKf80Vv32dZ6wjjpdHDmRHzKWGzyaEzTE9eNTXGtD7qU8sk64Zex7XuO%2bsdI1HUVteaQIUlJSsEU43b%2b/ItqZnoThA0v43fA5sH9c3L6wenv2AT4ebFuff74QgE//ERwcKS8jpaul%2beT62epEt4mS%2bJ3%2bvHeDRR9Hyj6%2bqfgwUrnawp3ixUzyIt9kBY7lBI3nhw2kercSHxd5XmU6msc7GEZc03M2V7ljqHSOIIOTkTxzRvKvf/k3C3Mz5PwzvYzaD%2bERHLYf1I8MTw4Nfk1/X%2b9wz%2btBiR%2bPDD9JP3wYpqez83MAMDMy8HS0q6F6CZtT3o%2bUQ3I%2bjVa8Gyxea09bqqdPFccOpgcNpAUOZwSM5YWOZAZ0JroUelxhOprF2utHXtd/bom/a6h4UUNWXf6MtLTU8WPHYK/jd/QIFjYhPOL2PQgPZv/k4IA4PMNg/%2btXAxIHTypfw/Pd/WGAt29/nV/YsLSwUlaUP29t4XHnYh3Lf42fvdtfvDdUujtQsMHPWO/K3uDnLbekjuaE93P8Bzg%2bQ9yACV5kf6pvbdh9jpN1zHV9v4uartZqd4wUoRM0FaRkzpw%2bdeokHDXYTM7K8g54P4XYv392EKsH%2bwf69%2b0H9WIA8Vn/o/jkfHgd7mA4J3e/GlFVweNVcBesLV7cvdyREbHGz1zryhI0ssfLSXMNKW%2bHanfH27aH67f6yuer6RO8qMki4mwlZao0qZvlVxbygP7knNcFbSdTFQd9pfPqMuoKUrCxnT55EtrA7bkbbKkT44tTB/kZfbMPMDQ48aP9r7r7JX58WPmO4TDA%2b/f/amrqxquqahLULE0MA584TFSQ1zvT5moZVWTf3ES/FKI/O9q3hBHekh4z15q3O1Inaslcak6fr%2bc0swJpnne875xzuWjkaK11SRd3RVvhIkFGTfY0jNMzp08DwDNnF9jREO%2bR9kUADoVn/Dv1sLr5fRJ/5mlLfPiB/au%2boVNZSRFmqK6aCsvHca2VtdTArE3yzIv2KGVF8mjBmfFeVazA5rTQN1WsD%2bPNi3XcocyI/uzItID7L25anTfSstAlWOuqWGspWRIULqnL6cufQrZkSQTgsdNDOFBg4Tk8fLDw9Pe9wdRD72L287t6v%2bmBny8YQfB41dk5gFeB85vSbRuDfo7XWkPSXEkMn%2b03Uc0WdBSI2nNmyknD2RHCZs7eUPHOQOlsOb2N%2bKw%2b5klxqGNJ6P02lncT1Yvz4prbeW1rgqytuoINTlLu9C8AAKftB46OS4INUC9u34OdCwP4JjxgPwJwcPj59Geeerff/n1yUmRqbKKqpEBztx9M8elIDapPi%2bFRgkqZoU3ZCUW0QLKXY%2bT9i0muN3lEj4lyyigvttDbnnjLNOK2RaqvYz7RnRv4MOG%2bjaMZ/qy6rA1e9gpBVl/u1LGjR6ECZ62t4IELdgDx9MR6F0s/NjcPq%2b/q7JEQnz3/DABMoZmZFUsrG2sr67iIKJdHD8lkMinUtZbhPt5A6SwnpjKC7lw/63JOn%2bV8sY7sXptHD/d/qa0ko6Uk8%2bCKsf8TO1tTQx2crIOZxh1jVRsNBRtdvJmmsh5OTk9LE4dT1lQndHW8hscAkH5gP5b%2b0R%2b9B/WdHa//DwBooT4vi3Zi3V1unLPKjg%2bK9XMtzM/IjXtcS3rUkh3UWhjdUUSLe37L/5Jh2rPLizXxbEq03w3bR2d1jLXwvi5XWZHOSe73Aq%2bbudho2mvLPjHHXdZSvH/HQVlV%2bemjx1cv2cXFJmC77%2bHhM9A/hs1NsB9T381H1MPqaH%2bFHeY%2b/lmAzS%2bby9vtRN%2bYl8/aqd4zuaEtueT6jLDenMCBwoiZGnIfN6wm4nGe142BrJCewthAt3uThbF1sU/PWxi%2beHCH/sIh2%2btGuutl8j3zoKu6z6zwDgbKMaFBRjrqevD0Iy/d0dwBz2Lf2d/fN9rbsx8eTD2/C9S/7ux41dHevQ8gXoe/4fkRYB15Evj8piCd4vu8Ls59Ni%2b8IyOmkB6w1Zu68TpjujC2j%2bU7xA2eLYl735PZW5CYHeP%2b6wivIc7ZUlP5qZV26mObQp8bPG/7TNdL6c5nI67pP7HWJYYF2hmoEc6ceHDdbnpiYWx0Htt6xer7ekd6Xg%2bJxw6WHPC%2bva27rZUvgX0B%2bLvr9763%2brCx/dvqYF9ugDMv6NFcQbSwMaWCFd5dQBR05k1Xs0aLk0Z48T2ZkV1ZUTBS5%2bqZv46WvKJ5XNaQdzDC5b%2b8Wh/u1BDq1BjxsMTnZuxNk9D7l72fPzqLl9eSOc2IjV0UbMKR880I1rvIzgWjE7P/sHrM%2b/Y2fmtLl4T4S8yfYHzzcvPXLdHGQk16M8V3pjBmqzP9w0jNSHVWRy61jh1ZQfKrogZUkXzqGMHTVWQo1peJqvGccD9bdQcDpYcWmmF3banP7CnOVxMeX/G/ddb5hu0lXeXrBoSzSlLF6dy5%2bfU3w1Ni%2byH9qP374QGAw%2brbWrtamjskfvwG8%2bckG3AmXdnbbM4dSQ%2bf4EWvNjHfD5X818rgfy4Pfhqq3mhOncgMmcqJ2ONnrzeytruz/jHTNF%2baFH/DmHzP4oUZ/pmJckOSVx3Rg%2bd9l/LA9omZqp2GrJ2ump2mcldzx9SUCIn%2b/sFhP/2vX%2b3bjyUH1ENywPvWls7mpvb/A8Chbz8/rtRnD6WFjOVHCuuS3nZnfh5r%2bm2h7%2bObhn6aT4nndVFz5l5vycehmo/Ddf8SdK%2b1pFDvWXrZaDjpyvvZELrInvNlpCGWT5GnvbsV4SJB9rK2spOlwfDA6PjowuHe7et9A%2bnHJg8WHsg9mpxOTH1TY5sE9oXrjwx/TPJhbePLRl/LXAV5gBu4WB632sx611v4abxpoYJR7HFtror%2bZaJxg18yVZM2Us4Z4hGro12czVWvass4GePCLuvme9j3p4b00l%2bmPbZ5ZIw7T5C5gJcJcLwBp%2biDU%2bcEGh5Qj9iPqT/oWsR4SA6mvqG%2bFQDe/QjwY0EO7j%2bsw83W3zdHh%2baLk7rZvnOlUYtVCauN9M2u3PqopwO5sWs9JaKuomV%2b0UIHb6YxvSMlqCzejeNxJdHJOuquBZxDo29bcN2v8Ske7IeWt3TlzqvL2SidDna6PTUjGtrvXSw8I69fDXXzB7DwYDMHNR5R39jQ1tjQWl/XLCH%2bvYN4/QQGWavv1ze/rM4uzZcyu5kvp4oiFmsThXXk2UpySfC9ifqUxbac7aGa3ZH6vdHmrd6q2VLmeD7pFellzvOrjEfnwm4YBdobh9obt5FcYZje0pO3xUvbG2qU5/ImJgSYerAf1IP9r7q/2o/lHrxvakTUN9S3gPq62iaJ1ZX3PzL8iLH6LcPa5hfR%2bFh3sv9YXthSA2WllTFdEtdO9x4sSqhJcO/NS1xqylmozVqsyZkvy3ydFMJ7cYf51M7rnO49feW4u9apntd70oKyXtg56MlbKhxnxMbMzW8MDkwM7u%2b7o2h4EPu7OvftR9V3HqhvxdTX1jRKLKO/bsB%2bDfFHACvwzg91WNv8e28RG556RY2MxbqkmZLY0fwoflpgpudtXtSLjaHq91NNnwT8X9dHREM19Rkx6ZHPbxjinxhplAY4tbF8BnMiom%2bZ2evKnsefqS6pmJgUDgyg4enHehexn9/V39mB2I%2bph/B8p76muv4bABC6jF7FDMh19QP2R9/%2bsujd5vZvo%2b1Nrznewkb6YiNtqoI4xosYK4pZaUvf7Sldayna6ajba2neaa5dyE9rDvAkXzIPO6eX5nyp2Mehg/GyPObJMxu1W/pyjrYmQ4OTI8MzaO%2bOH/Tuvv1o7/J/X31VfXVFrYRoeW//dz6H1o8F%2ba4yq2uA9GFhWtiZGjZZEiNsZszUJE1VJMw3MDb4Oe8GS36dbv401rbdXjOfzx5ixbSHv8h8coX2wCbH7UqR982i4HvhDiZPrPC2uON0InFmdnWgH%2bvd/fSjvYvYj02e/fCA%2btoWkF5b3QDqqyrrKstrJITLe8sog%2bhgrfwQqh95AHJr69fVjS81GQw%2bx3u8OHqsMHKiLH6xhb0GAAMlX8Zq/zHXudVfMVqe3JES2ckIqAx9WOp/p9TXIe/ldfLjs/dMcBfVTj%2b9fnF4eHp4eGZgYLL/d%2bx/Db0rtr%2b%2brqWupglTX42qryirlhCKdkUogwhdy8v7FTh83V8H6VpB1H%2bByD54%2bMTK3LQg%2bmkbw4vP8e3JCJptYKzys/cGCt8PFH0cqXo/WLfcWjjGI/fS/FojHtcG3eF5XeU8PedsTbAhSJvhTl%2b2tenpeTM0NN3fB%2bqhd5HRCenv6uzraO9ta%2b3%2bRn1t8773FbWgvry0qqykAgVA1zKKAQURruyBbgTmW4BlrETLexCh2dmVG/Y3ZGXkFHCqNJ/7dWSPGrL764zAwYLI5U7udh9vr7/gLT9rvS1P0Jg9nBUDB7hKv1sFL67QH1gEXtU/rylnhpe10cQdQb9KmZwU9va8QY894t7txUYnFh6IPqq%2bEYw/pL6ypKhcYkm0u4QCLGG/dTtEAnKxdO1f0QUf23r797KyKmVlnKKCkqqmXmtJ7nB2cEnss8pE1%2bZkn9HyxLWevPVXucL2rPnGzJm6jO7U8MrwJ/neNxMf2Phc0r5piDPFy1kR5G0I8vAY%2bfTx4/EJwevXbzD7QT1qfw9qfxe2Z4H9WNd%2bp76ooFRCINyBtQTrAGB/YQwojHihb%2b6urH2sb2q5c/c2/PO3HrrPvxlfqiGOlhBrSe7FUc5l8c/7CuNE/Jz51qyxShao56eGVsW4MFyv%2btub3DHDm6nJm%2bDlz6nJWCifgZ%2bgr6MFWe/rmxCHB%2bxvb3vd2oLkRxyemqoGLPegvrS4AlNfyCvaBxAzLB2UYgllQBoDfYl1CLyzBACr70sqKtMyODpa6m4BpLmFvaUG2tuerLlack96QE3C8/yIx/Usv56COH56UBvDp4Xuw3S76nPD/JaFlrkGzgyvYIU8y0ub4s787chRGWnJnKw8aGXwHnoXDc%2b%2b/U2NHVh4atDwVJbXHva%2bkFfMyyuQWFzaxtQLDi1QLzioydIBAKIefbm8%2bqGqpp6dlkymJDx44t00sDPbUfm2O3XzVdZcDXk4L7yF9iI32JHtfYv64maCm33A3bN3bXQvG6nbaKlYayhZ4eUuqsteVz9jpKogI6984pdjQYFBsAmAbnTywOh83dLc3dyE2d9aW9NUXVVfWYHMHEx9cWFZIa8E1Ofl5EsIAABdGMl3GN/VBAXbXl3/1NDcwU5lpnA54REhYaS81wMr4yXxG/xUUSt7pipxKCekg%2bFZFfckw%2b9WjNNZ14t6T85qO5/VvmeOv6Apf5Ygd01b3o4gaaypYWxpd/z4sWvX7MDsEShCZ39bK%2by7oJ6P2t%2bGqm%2borKirKK8pQ8ODqS/IL8rP5eVm50kIBG/FANgS/B6JEK0J/ClSB%2bFOUWlRKpedmc3lpLOJCTGMnKaGmu7elABBDWmxjjoPm1pp3Agvsj8ruI3qVhTgkOlhR3909sV5rUtaCpc15G7ryl1UlTTS1rn7NOTYseMXLtj6eHsz6GxQ/Kp7CBgaGzrq69qw8FRV1leg4cHUF/FKC/KLMfXZmTkSC4tbC4K3sBYPMSweFGRxaUewf7MNGOD99Nx6bUMjYn86m5udlpaZmsrlUKjxiawsekR4cZhTX7LPeF74dClxpjJppoY0VhjVlx7QFO9S6H/T57LeZW3cdR2F2waK51TP2JhZ%2bsdlHzl23NLSwt3D1cRY38TYIDQkrLK8DlIEGHW1Laj3teVlNaUlmPelqPcQnrycrNysjGyJ%2bcWt%2bQMG8RIc4kFeQmzWPiwKthuauxLIZBqTwmBRGWxaamZKWlZKakZqGjclOib0hZe7m9szTpR3npd9fbgjn%2bbRkxrwKtW/NyOkLy2I53fHyVLbXk/VwUDlngneWunkLfu75MxWANDV1fH197l//66M1CkFeSlrK3M3Nzc6jQXSoYmBoaS4EvG%2bAPO%2bEKKPqc9Iz5SYW9jEGMQLqQa65gXIS6FoTyDcbe/qpzGTw6PDwmPCiYmx6RkpLDYd%2bhhmEZPDgGrExEW99PHy8PKgJDOo5DiKrzPH7Xq%2b17XSkHulYQ%2byvG56nte7a0K4a6J%2bx5jgaK5hJn88LJzELuo5euwEgUAICPILCPS9fPm8vJyUkqKsJkHFyEDX/trV8LCIvJxCmJ4AwMsrQtXzxOq5aVwEAGXYPAwAC24gOaKV9/1DU9ys3KiYqMjYyERKQgKZGBYRkpaRAtKTU5ip3JTkVCY9mUahkzxfenh5v0jmMBgcFjMlmcEgF9Cj6S5XYm4aedioO5mqOJmr3zJSv22icctA5YKmYkXTGDO34%2bjx03iCZkhYUCwxsrKm%2bvad26dOHiOoKRvqaRnp6xgb6dlduRQcEASxKSmqyM1Goo%2bqz%2bKmZaSlpErMzm/AOsBAALAbaNbRcUFeYWlkTBQYT6IkJNESKQwylU4KiwimMEgZ2Wmp3GR2GgsAklMYrBRGVEyEy3NnTiorK5fLSUsGts3t7YGBfleHi/f0ZJ3MVG8b4a/pqt4yVr%2buKf3o6uWhhX%2bGkfN/OSVD0DLy9PYMjQgpKSvhFZecOX1CXl5WU13VUF/LyEAblqGBjv01u7iYuHzUfpCenoqoT2VzJGbm1jEGZC0gVzB%2bfvFtbUMbMSkBfmgCOZ5ETyLREhnJ1GQOHa7xSbGJ5HgWhw51SM1gQ5DoLAokChg8vTxiiFGZOenQ2XQWrbyyrLCs2DcwwFoHb6sqdUFd4ZoO7qa%2bsq3S0Qg//%2bmt/%2bfsFXNaGqdtdPahs3NweGhcfGx334CegY6k5ElVFSVtTTVDPU3AMDHWMzbWMzU1cHrgmMxkZ2fmprIR9SmsZAQAY8CuS8Ldnv5xTjoXAkNMiiNRE6lMMqxEajyNRU5OAQAKmZFEoiZQmSQmh5aRlZqRlQZZojHJEKrI6LCgEH%2bwH%2bpAppJoLJqX70vbc2cv29lZqCufV5W%2bpC5/TlXqmpZMfWNfIKX2%2bsNAvJbJOXvnh0%2bfhUdH%2bgb49g4O3nNyPHb0ryo4eYIaTleLAFky0NcyNdG3tDABkvO2VnExMRAhDpPNZjAlpmfXYE3NrM4tbAFARXVDbGJcFDEqkQqBIZHpiRR6EkiHGxI9kcGmMtlUeAmJpzPJcAOzKD0rlZuVAmCcNBYSsMhgOovKTmUxWJSCkmImJ%2bX2nRvefj4Xz9mYKUraqMpYyx0JdXmYWzdhae9jfe3pldvuj72T7O8%2bCokM8w3ya%2bvo8A8OOvo3CUUFWQJeSQ2P09fTMDDQMjbSNTMzsLIyRW5MDSLDwricVCaVJoGph8y8GVvMyMkF6fFIZkgUVB/YnEghUgCDmYQAJFNZHBoNqQm4S6YjHyAz2TR2CgMsh80BGBKS4pIoCXQ2HSFn0uqa2109nkVEhTk%2beGCqqmCFk7yqLpWdV%2bvgEnvJweXKHfdQcrFfXJaXf4h3gH9weEhZZUVMfPzxo3%2bRk5UiqCqpKCtqQZCgE1AAC3MjU2M9IwMtczNDfx8fDpMlgXnfwR%2bgMulxSXFUJpXKotCTYdJT6CwS%2bEqixiMA9EQqPQleQgVQZYAHH6BgVyryEopDh06A1JGpiVABeCckPKixtTMiOtLP39v5%2bTNrA10jqSMPzls9D6CbnX943z3WLzYrs%2bpNLKskr6CQSCYHhQfn8PKoLOaJX47ISkuqqSiqKMsTCMp6uppGhjpgvIWFkZGhtqGeBrw0NzcKCwyUGJ8UllXWJlKTYMIkoy6y0KAj7jISqQzQCmkhUWgJMIjgfSrkipZIPQBAC0Uh05LAeLgyktH6MCBjUB9qZHQor6iYnc718HR95vbcxtZW7eSR2zYW956G2j8M9orMTCnpKe9coGTU1DU01re0%2b4eGcDO5KRlcydO/wKaGV1ZQUVbA43Ha2upQBGhiSwtj0K2rhTc20DIxM7h43loiPTsTLGenJ6dw2SncZE46C4IOKkmgGOYNhQiiaSwShZFEpiZAbKB9YSJRkAih3jNIGEAcZC8pDjYK%2bAlAmJBETKIkxhCjo%2bNi84pKn7k9dXV3vXbTQVla%2bp7j87vPol0CGMSUutpXoobedTavqa2zc3J2oaiikkwnZ%2bXny8mekT5zCo%2bTx6soqqoqaWkRDAy0TZAKGFtbmRroaepoqsJLCJJEchqTm5OemceFQwE7ncVOY1JZZBiUCaQ4WEkUZPhgC5IDCwYowgD34D0sBuI3YETFhMcSoyKiQulMAKPCywQSEaIfFhFa09Dy9LlzYHDA46dPrjs4PfaK9wxPC6GUcsv7%2beMfmge2uCVtA0PDY1PT0/MLWfl5%2bcUlOJy81JmTqjh5NVUlANDUUtOHYWqib2FpAgDmZgaaBJwh%2bo5ERk56Rh6Xm5OWkZsOFYDJCA1KTIyJjgtPJMclUePBTqRfkfAg9scDGJkIliPeI9KRGygFDNDQ8KDwqJC4%2bGiYqvGJseGRIZA6eL%2bqtvGF9wu48fb1eu7p/9A9Ni6lIS6ltqhpamTxn00Dm7kVHRPTUxMzc7MLizWNja1d3SoqigAAk1Qdj4NBBBUAAGOYpFamMIiAQUdLTVNDFfY4iZyCLG5uelp2alZ%2bBuxKIBTiQaLDFhYUHRcBIwgWEmukUymJ1AQisosRESomCToBblBCSlRshI%2bfF6iEIgAeHChgw4aahEUE1dQ3hkaGh4QFwBnkicuzGw986PmvqNkt1XzB9Np/1x9InTcAAADfSURBVLxaKahqFwgW5hYFEzOzBaXF/N5%2bPF5ZWuoUVEBDTZlAUNHWUcciZGVtBsvGxgyaGK%2bioK2lJpFTmJ2WyeFmp2YXZKWksyDroJKWTCYmRPsH%2bsTFR0H0kVaGCkC0SHFx6DaMRIuBRAhqkoRudmC550v34NAAYID8wGyFYQoMgcG%2bLW3tJDrNzcMlOi7K0/vFrQcenNJBFq%2brZXBjaed/yjoWKxr5omXhkmi5Z2iIV1w48GYMIiQnI6mqrKCprqKpideB/dhI19TM0NrG/KytpTUcxC1N4E9VVRT%2bPzbiUw29GeqqAAAAAElFTkSuQmCC' /%3e%3c/svg%3e"},"path":"/authors/justin-yoo/"}]}},{"node":{"title":"WebSub에서 CloudEvents를 통해 이벤트그리드로 전환하고 다양한 소셜 미디어로 알리기","path":"/posts/2021/02/02/websub-to-eventgrid-via-cloudevents-and-beyond/","image":"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-00-ko.png","image_caption":"유튜브 WebSub에서 CloudEvents를 거쳐 이벤트그리드로 변환하기","description":"이 포스트는 유튜브 채널에 새 비디오가 올라왔을 때, 이 이벤트를 CloudEvents 형식으로 변환해서 애저 이벤트그리드로 발행한 후, 로직 앱을 이용해 다양한 소셜 미디어로 확산시키는 일련의 워크플로우에 대해 다룹니다.","content":"<p>유튜브 채널을 하나 운영하고 있다고 가정하겠습니다. 새 비디오가 하나 업로드 되었을 때, 이를 내가 운영하는 다른 소셜 미디어에 함께 노출 시키고 싶다면 어떻게 하면 좋을까요? 이미 시장에는 이를 위한 다양한 유료 도구들이 많이 나와 있고, 소셜 미디어 마케팅을 전문으로 하는 회사도 많습니다. 게다가 그런 회사의 경우는 자체적인 솔루션도 갖고 있으니, 이를 이용하면 쉽겠죠. 그런데, 만약 여러 가지 이유로 내가 직접 이런 도구들을 만들어서 사용하고 싶다면 어떨까요? 기존의 제품/서비스들이 제공하는 기능이 내 용도와는 다르다면 어떻게 할까요? 이럴 경우에는 한 번 직접 만들어 보는 것도 좋습니다.</p>\n<p>이 포스트에서는 유튜브에 새 비디오가 올라올 때부터 다른 소셜 미디어에 노출 시킬 때 까지의 전체적인 워크플로우를 <a href=\"https://docs.microsoft.com/ko-kr/azure/event-grid/overview?WT.mc_id=devops-dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 이벤트그리드</a>, <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>, <a href=\"https://docs.microsoft.com/ko-kr/azure/logic-apps/logic-apps-overview?WT.mc_id=dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 로직 앱</a> 등의 다양한 애저 서버리스 서비스를 통해 구현해 보기로 하겠습니다.</p>\n<blockquote>\n<p>구현한 솔루션의 소스 코드는 이곳 <a href=\"https://github.com/devrel-kr/youtube-websub-subscription-handler\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">깃헙 리포지토리</a>에서 다운로드 받아 보세요!</p>\n</blockquote>\n<h2 id=\"유튜브-알림-구독\"><a href=\"#%EC%9C%A0%ED%8A%9C%EB%B8%8C-%EC%95%8C%EB%A6%BC-%EA%B5%AC%EB%8F%85\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>유튜브 알림 구독</h2>\n<p>유튜브에서는 <a href=\"https://developers.google.com/youtube/v3/guides/push_notifications\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">웹훅 알림</a>을 위해 <a href=\"https://github.com/pubsubhubbub/PubSubHubbub\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PubSubHubbub</a>이라는 규약을 사용합니다. 이 규약은 현재 <a href=\"https://www.w3.org/TR/websub/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebSub</a>이라는 이름으로 <a href=\"https://www.w3.org/TR/2016/WD-pubsub-20161020/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">2016년에 최초 가안</a>이 나온 이후 2018년에 웹표준으로 지정됐죠.</p>\n<p>유튜브의 모든 채널은 이미 구글이 운영하는 <a href=\"https://pubsubhubbub.appspot.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebSub 허브</a>에 등록이 되어 있으므로, 특정 채널에 대한 비디오 업데이트 알림을 받기 위해서는 이 허브에 <a href=\"https://pubsubhubbub.appspot.com/subscribe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">구독 신청</a>만 하면 됩니다. 아래 그림과 같이 메시지 처리기(Message Handler) URL을 넣고, 유튜브 채널 URL을 입력한 후 <code class=\"language-text\">Do It!</code> 버튼을 클릭하면 등록이 끝납니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-01.png\" alt=\"유튜브 WebSub 구독하기\"></p>\n<p>단, 여기서 주의해야 할 점이 하나 있습니다. 메시지 처리기 URL로 호출하는 애플리케이션은 구독 등록이 끝남과 동시에 <a href=\"https://indieweb.org/How_to_publish_and_consume_WebSub#The_hub_verifies_the_subscription_request\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">유효성 검증</a>을 위한 API 호출을 받게 되는데, 이를 통과해야만 구독 절차가 완전히 끝나게 됩니다. 이 유효성 검증을 통과하지 못하면 아무리 구독을 해도 알림을 받을 수 없습니다.</p>\n<h2 id=\"websub-구독-요청-검증\"><a href=\"#websub-%EA%B5%AC%EB%8F%85-%EC%9A%94%EC%B2%AD-%EA%B2%80%EC%A6%9D\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>WebSub 구독 요청 검증</h2>\n<p>WebSub 구독 요청에 대한 검증을 위해서 메시지 처리기 URL은 검증 요청이 들어왔을 때 아래와 같은 내용을 처리해 줘야 합니다.</p>\n<ul>\n<li>\n<p>검증 요청은 <code class=\"language-text\">GET</code> 메소드로 아래와 같은 쿼리스트링 파라미터를 전송하는데요,</p>\n<ul>\n<li><code class=\"language-text\">hub.mode</code>: <code class=\"language-text\">subscribe</code> 문자열</li>\n<li><code class=\"language-text\">hub.topic</code>: 구독하고자 하는 유튜브 채널 URL</li>\n<li><code class=\"language-text\">hub.challenge</code>: WebSub 허브에서 생성한 임의의 문자열로 구독 요청에 대한 검증에 사용합니다</li>\n<li><code class=\"language-text\">hub.lease_seconds</code>: 구독 요청 유효 기간으로 이 기간 안에 구독 요청에 대한 검증을 통과하지 못하면 이 요청은 자동으로 폐기됩니다</li>\n</ul>\n</li>\n<li>\n<p>검증 요청에 대한 응답으로 응답 개체 본문에 <code class=\"language-text\">hub.challenge</code> 값만 추가해서 200 응답 코드와 함께 반환합니다</p>\n<ul>\n<li>응답 개체 본문에 <code class=\"language-text\">hub.challenge</code> 이외의 다른 값이 들어가면 이 응답은 WebSub 허브에서 유효한 응답으로 처리하지 않습니다</li>\n</ul>\n</li>\n</ul>\n<p>이 구독 요청 검증 로직을 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>으로 구현해 보면 대략 아래와 같습니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107473935\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-01-callback-1-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-01-callback-1-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-01-callback-1-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>CallbackAsync<span class=\"pl-pds\">&quot;</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-callback-1-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-01-callback-1-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">CallbackAsync</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-callback-1-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-01-callback-1-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Function</span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>GET<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>POST<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>callback<span class=\"pl-pds\">&quot;</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-callback-1-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-01-callback-1-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-callback-1-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-01-callback-1-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-callback-1-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-01-callback-1-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">if</span> (<span class=\"pl-smi\">HttpMethods</span>.<span class=\"pl-en\">IsGet</span>(<span class=\"pl-smi\">req</span>.<span class=\"pl-smi\">Method</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-callback-1-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-01-callback-1-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-callback-1-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-01-callback-1-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">string</span> <span class=\"pl-en\">challenge</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">req</span>.<span class=\"pl-smi\">Query</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>hub.challenge<span class=\"pl-pds\">&quot;</span></span>];</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-callback-1-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-01-callback-1-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">result</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">ObjectResult</span>(<span class=\"pl-smi\">challenge</span>) { <span class=\"pl-smi\">StatusCode</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">200</span> };</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-callback-1-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-01-callback-1-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-callback-1-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-01-callback-1-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">return</span> <span class=\"pl-smi\">result</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-01-callback-1-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-01-callback-1-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326/raw/9bf7299cd55c3b2e19f88d82f4aabedebbe5716a/01-callback-1.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326#file-01-callback-1-cs\">01-callback-1.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>위와 같이 메시지 처리를 위한 구독 요청 검증에 성공했다면, WebSub 허브는 앞으로 계속해서 유튜브 채널에 새 비디오가 올라올 때마다 알림 이벤트를 메시지 처리기 쪽으로 보내게 되죠.</p>\n<h2 id=\"websub-알림-피드-변환\"><a href=\"#websub-%EC%95%8C%EB%A6%BC-%ED%94%BC%EB%93%9C-%EB%B3%80%ED%99%98\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>WebSub 알림 피드 변환</h2>\n<p>WebSub 역시도 어디까지나 <a href=\"https://www.enterpriseintegrationpatterns.com/patterns/messaging/PublishSubscribeChannel.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">발행자/구독자(Publisher/Subscriber; Pub/Sub) 패턴</a>을 따르기 때문에 크게 새로울 것은 없습니다. 다만, WebSub으로 주고 받는 데이터는 ATOM 피드 형식을 따르기 때문에 구독자가 ATOM 피드 형식의 XML 문서를 해석해서 처리할 수만 있으면 됩니다. 그런데, 이벤트 구독자 쪽에 ATOM 피트 형태의 XML 데이터를 강제하는 것은 이벤트 발행자와 구독자 사이에 강한 커플링을 유도합니다. 구독자가 어떤 식으로 데이터를 처리할 지 알 수 없는 상황에서 이를 강제하는 것은 바람직하지 않기 때문에, 중간에 표준 데이터 형식 혹은 캐노니컬 데이터 형식으로 바꿔주는 것이 좋습니다.</p>\n<p>따라서, 여기서는 <a href=\"https://cloudevents.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CloudEvents</a> 형식을 이용해서 캐노니컬 데이터 형식으로 변환합니다. 이 포스트에서는 이 캐노니컬 데이터 변환 과정을 두 단계로 나눴는데, 하나씩 설명해 보기로 하겠습니다.</p>\n<h3 id=\"1-websub-알림-피드-️-cloudevents-형식-변환\"><a href=\"#1-websub-%EC%95%8C%EB%A6%BC-%ED%94%BC%EB%93%9C-%EF%B8%8F-cloudevents-%ED%98%95%EC%8B%9D-%EB%B3%80%ED%99%98\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>1. WebSub 알림 피드 ➡️ CloudEvents 형식 변환</h3>\n<p>이 첫번째 단계의 목적은 WebSub에 대한 의존성을 끊어내는 데 있습니다. 따라서, WebSub에서 전달된 ATOM 피드의 XML 데이터를 별다른 변환 없이 그대로 CloudEvents 형식에 담습니다. 유튜브에 새 비디오가 올라왔을 때 WebSub을 통해 받는 알림 피드의 데이터는 대략 아래와 비슷하게 생겼습니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107473935\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-websub-feed-xml\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-xml  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-websub-feed-xml-LC1\" class=\"blob-code blob-code-inner js-file-line\">&lt;<span class=\"pl-ent\">feed</span> <span class=\"pl-e\">xmlns</span><span class=\"pl-e\">:</span><span class=\"pl-e\">yt</span>=<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>http://www.youtube.com/xml/schemas/2015<span class=\"pl-pds\">&quot;</span></span> <span class=\"pl-e\">xmlns</span>=<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>http://www.w3.org/2005/Atom<span class=\"pl-pds\">&quot;</span></span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-02-websub-feed-xml-LC2\" class=\"blob-code blob-code-inner js-file-line\">  &lt;<span class=\"pl-ent\">link</span> <span class=\"pl-e\">rel</span>=<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>hub<span class=\"pl-pds\">&quot;</span></span> <span class=\"pl-e\">href</span>=<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>https://pubsubhubbub.appspot.com<span class=\"pl-pds\">&quot;</span></span>/&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-02-websub-feed-xml-LC3\" class=\"blob-code blob-code-inner js-file-line\">  &lt;<span class=\"pl-ent\">link</span> <span class=\"pl-e\">rel</span>=<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>self<span class=\"pl-pds\">&quot;</span></span> <span class=\"pl-e\">href</span>=<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>https://www.youtube.com/xml/feeds/videos.xml?channel_id=[channel_id]<span class=\"pl-pds\">&quot;</span></span>/&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-02-websub-feed-xml-LC4\" class=\"blob-code blob-code-inner js-file-line\">  &lt;<span class=\"pl-ent\">title</span>&gt;YouTube video feed&lt;/<span class=\"pl-ent\">title</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-02-websub-feed-xml-LC5\" class=\"blob-code blob-code-inner js-file-line\">  &lt;<span class=\"pl-ent\">updated</span>&gt;2021-01-27T07:00:00.123456789+00:00&lt;/<span class=\"pl-ent\">updated</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-02-websub-feed-xml-LC6\" class=\"blob-code blob-code-inner js-file-line\">  &lt;<span class=\"pl-ent\">entry</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-02-websub-feed-xml-LC7\" class=\"blob-code blob-code-inner js-file-line\">    &lt;<span class=\"pl-ent\">id</span>&gt;yt:video:[video_id]&lt;/<span class=\"pl-ent\">id</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-02-websub-feed-xml-LC8\" class=\"blob-code blob-code-inner js-file-line\">    &lt;<span class=\"pl-ent\">yt</span><span class=\"pl-ent\">:</span><span class=\"pl-ent\">videoId</span>&gt;[video_id]&lt;/<span class=\"pl-ent\">yt</span><span class=\"pl-ent\">:</span><span class=\"pl-ent\">videoId</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-02-websub-feed-xml-LC9\" class=\"blob-code blob-code-inner js-file-line\">    &lt;<span class=\"pl-ent\">yt</span><span class=\"pl-ent\">:</span><span class=\"pl-ent\">channelId</span>&gt;[channel_id]&lt;/<span class=\"pl-ent\">yt</span><span class=\"pl-ent\">:</span><span class=\"pl-ent\">channelId</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-02-websub-feed-xml-LC10\" class=\"blob-code blob-code-inner js-file-line\">    &lt;<span class=\"pl-ent\">title</span>&gt;hello world&lt;/<span class=\"pl-ent\">title</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-02-websub-feed-xml-LC11\" class=\"blob-code blob-code-inner js-file-line\">    &lt;<span class=\"pl-ent\">link</span> <span class=\"pl-e\">rel</span>=<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>alternate<span class=\"pl-pds\">&quot;</span></span> <span class=\"pl-e\">href</span>=<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>http://www.youtube.com/watch?v=&lt;video_id&gt;<span class=\"pl-pds\">&quot;</span></span>/&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-02-websub-feed-xml-LC12\" class=\"blob-code blob-code-inner js-file-line\">    &lt;<span class=\"pl-ent\">author</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-02-websub-feed-xml-LC13\" class=\"blob-code blob-code-inner js-file-line\">     &lt;<span class=\"pl-ent\">name</span>&gt;My Channel&lt;/<span class=\"pl-ent\">name</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-02-websub-feed-xml-LC14\" class=\"blob-code blob-code-inner js-file-line\">     &lt;<span class=\"pl-ent\">uri</span>&gt;http://www.youtube.com/channel/[channel_id]&lt;/<span class=\"pl-ent\">uri</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-02-websub-feed-xml-LC15\" class=\"blob-code blob-code-inner js-file-line\">    &lt;/<span class=\"pl-ent\">author</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-02-websub-feed-xml-LC16\" class=\"blob-code blob-code-inner js-file-line\">    &lt;<span class=\"pl-ent\">published</span>&gt;2021-01-27T07:00:00+00:00&lt;/<span class=\"pl-ent\">published</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-02-websub-feed-xml-LC17\" class=\"blob-code blob-code-inner js-file-line\">    &lt;<span class=\"pl-ent\">updated</span>&gt;2021-01-27T07:00:00.123456789+00:00&lt;/<span class=\"pl-ent\">updated</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-02-websub-feed-xml-LC18\" class=\"blob-code blob-code-inner js-file-line\">  &lt;/<span class=\"pl-ent\">entry</span>&gt;</td>\n      </tr>\n      <tr>\n        <td id=\"file-02-websub-feed-xml-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-02-websub-feed-xml-LC19\" class=\"blob-code blob-code-inner js-file-line\">&lt;/<span class=\"pl-ent\">feed</span>&gt;</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326/raw/9bf7299cd55c3b2e19f88d82f4aabedebbe5716a/02-websub-feed.xml\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326#file-02-websub-feed-xml\">02-websub-feed.xml</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>이 요청 데이터를 아래와 같이 단순 문자열로 받아 냅니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107473935\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-03-callback-2-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-03-callback-2-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-03-callback-2-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">payload</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">default</span>(<span class=\"pl-k\">string</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-callback-2-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-03-callback-2-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">using</span> (<span class=\"pl-en\">var</span> <span class=\"pl-en\">reader</span> <span class=\"pl-k\">=</span> <span class=\"pl-en\">new</span> <span class=\"pl-en\">StreamReader</span>(<span class=\"pl-en\">req</span>.<span class=\"pl-en\">Body</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-callback-2-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-03-callback-2-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-callback-2-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-03-callback-2-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-en\">payload</span> <span class=\"pl-k\">=</span> <span class=\"pl-en\">await</span> <span class=\"pl-en\">reader</span>.<span class=\"pl-en\">ReadToEndAsync</span>().<span class=\"pl-en\">ConfigureAwait</span>(<span class=\"pl-en\">false</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-03-callback-2-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-03-callback-2-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326/raw/9bf7299cd55c3b2e19f88d82f4aabedebbe5716a/03-callback-2.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326#file-03-callback-2-cs\">03-callback-2.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>이와 더불어 알림 피드 요청 헤더는 아래와 같은 값을 포함하고 있는데요,</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107473935\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-04-websub-request-header-txt\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-text  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-04-websub-request-header-txt-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-04-websub-request-header-txt-LC1\" class=\"blob-code blob-code-inner js-file-line\">Link: &lt;https://pubsubhubbub.appspot.com&gt;; rel=hub, &lt;https://www.youtube.com/xml/feeds/videos.xml?channel_id=[channel_id]&gt;; rel=self</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326/raw/9bf7299cd55c3b2e19f88d82f4aabedebbe5716a/04-websub-request-header.txt\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326#file-04-websub-request-header-txt\">04-websub-request-header.txt</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>이 헤더 값을 아래와 같이 추출해 냅니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107473935\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-callback-3-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-05-callback-3-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-callback-3-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">headers</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">req</span>.<span class=\"pl-smi\">Headers</span>.<span class=\"pl-en\">ToDictionary</span>(<span class=\"pl-en\">p</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-smi\">p</span>.<span class=\"pl-smi\">Key</span>, <span class=\"pl-en\">p</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-smi\">string</span>.<span class=\"pl-en\">Join</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>|<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-smi\">p</span>.<span class=\"pl-smi\">Value</span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-callback-3-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-callback-3-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">links</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">headers</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Link<span class=\"pl-pds\">&quot;</span></span>]</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-callback-3-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-callback-3-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">                .<span class=\"pl-en\">Split</span>(<span class=\"pl-k\">new</span>[] { <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>,<span class=\"pl-pds\">&quot;</span></span> }, <span class=\"pl-smi\">StringSplitOptions</span>.<span class=\"pl-smi\">RemoveEmptyEntries</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-callback-3-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-05-callback-3-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">                .<span class=\"pl-en\">Select</span>(<span class=\"pl-en\">p</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-smi\">p</span>.<span class=\"pl-en\">Trim</span>().<span class=\"pl-en\">Split</span>(<span class=\"pl-k\">new</span>[] { <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>;<span class=\"pl-pds\">&quot;</span></span> }, <span class=\"pl-smi\">StringSplitOptions</span>.<span class=\"pl-smi\">RemoveEmptyEntries</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-callback-3-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-05-callback-3-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">                .<span class=\"pl-en\">ToDictionary</span>(<span class=\"pl-en\">p</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-smi\">p</span>.<span class=\"pl-en\">Last</span>().<span class=\"pl-en\">Trim</span>(), <span class=\"pl-en\">p</span> <span class=\"pl-k\">=&gt;</span> <span class=\"pl-smi\">p</span>.<span class=\"pl-en\">First</span>().<span class=\"pl-en\">Trim</span>().<span class=\"pl-en\">Replace</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>&lt;<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-smi\">string</span>.<span class=\"pl-smi\">Empty</span>).<span class=\"pl-en\">Replace</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>&gt;<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-smi\">string</span>.<span class=\"pl-smi\">Empty</span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-callback-3-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-05-callback-3-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-callback-3-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-05-callback-3-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">source</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">links</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>rel=self<span class=\"pl-pds\">&quot;</span></span>];</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326/raw/9bf7299cd55c3b2e19f88d82f4aabedebbe5716a/05-callback-3.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326#file-05-callback-3-cs\">05-callback-3.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>그리고 아래와 같이 이벤트 타입과 이벤트 데이터 타입을 설정합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107473935\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-06-callback-4-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-06-callback-4-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-06-callback-4-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">type</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>com.youtube.video.published<span class=\"pl-pds\">&quot;</span></span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-callback-4-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-06-callback-4-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">contentType</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>application/cloudevents+json<span class=\"pl-pds\">&quot;</span></span>;</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326/raw/9bf7299cd55c3b2e19f88d82f4aabedebbe5716a/06-callback-4.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326#file-06-callback-4-cs\">06-callback-4.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p><a href=\"/developerkorea/posts/2021/01/19/cloudevents-for-azure-eventgrid-via-azure-functions/\">지난 포스트</a>에서 언급한 바와 같이 현재 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>의 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-bindings-event-grid?WT.mc_id=dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">이벤트그리드 바인딩</a>은 <a href=\"https://docs.microsoft.com/ko-kr/azure/event-grid/cloudevents-schema?WT.mc_id=devops-dotnet-12869-juyoo&#x26;ocid=AID3027813#use-with-azure-functions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CloudEvents 형식을 아직 지원하지 않기 때문에</a>, 아래와 같이 펑션 코드 안에서 직접 처리를 해 줘야 합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107473935\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-07-callback-5-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-07-callback-5-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-07-callback-5-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">@event</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">CloudEvent</span>(<span class=\"pl-smi\">source</span>, <span class=\"pl-smi\">type</span>, <span class=\"pl-smi\">payload</span>, <span class=\"pl-smi\">contentType</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-callback-5-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-07-callback-5-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">events</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">List</span>&lt;<span class=\"pl-k\">CloudEvent</span>&gt;() { <span class=\"pl-smi\">@event</span> };</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-callback-5-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-07-callback-5-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-callback-5-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-07-callback-5-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">topicEndpoint</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">Uri</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>https://&lt;eventgrid_name&gt;.&lt;location&gt;-&lt;random_number&gt;.eventgrid.azure.net/api/events<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-callback-5-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-07-callback-5-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">credential</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">AzureKeyCredential</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>eventgrid_topic_access_key<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-callback-5-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-07-callback-5-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">publisher</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">EventGridPublisherClient</span>(<span class=\"pl-smi\">topicEndpoint</span>, <span class=\"pl-smi\">credential</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-callback-5-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-07-callback-5-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-callback-5-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-07-callback-5-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">var</span> <span class=\"pl-en\">response</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">await</span> <span class=\"pl-smi\">publisher</span>.<span class=\"pl-en\">SendEventsAsync</span>(<span class=\"pl-smi\">events</span>).<span class=\"pl-en\">ConfigureAwait</span>(<span class=\"pl-c1\">false</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-callback-5-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-07-callback-5-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-callback-5-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-07-callback-5-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">return</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">StatusCodeResult</span>(<span class=\"pl-smi\">response</span>.<span class=\"pl-smi\">Status</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-callback-5-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-07-callback-5-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326/raw/9bf7299cd55c3b2e19f88d82f4aabedebbe5716a/07-callback-5.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326#file-07-callback-5-cs\">07-callback-5.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>여기까지 해서, WebSub에서 받아온 이벤트 데이터를 그대로 CloudEvents를 이용한 캐노니컬 형식으로 변환해서 애저 이벤트그리드로 다시 보냅니다. 이렇게 보내진 CloudEvents 형식 데이터는 아래와 같습니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107473935\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-08-cloudevents-from-websub-json\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-json  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-08-cloudevents-from-websub-json-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-08-cloudevents-from-websub-json-LC1\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-cloudevents-from-websub-json-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-08-cloudevents-from-websub-json-LC2\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>id<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>c2e9b2d1-802c-429d-b772-046230a9261e<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-cloudevents-from-websub-json-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-08-cloudevents-from-websub-json-LC3\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>source<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>https://www.youtube.com/xml/feeds/videos.xml?channel_id=&lt;channel_id&gt;<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-cloudevents-from-websub-json-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-08-cloudevents-from-websub-json-LC4\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>data<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>&lt;websub_xml_data&gt;<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-cloudevents-from-websub-json-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-08-cloudevents-from-websub-json-LC5\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>type<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>com.youtube.video.published<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-cloudevents-from-websub-json-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-08-cloudevents-from-websub-json-LC6\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>time<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>2021-01-27T07:00:00.123456Z<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-cloudevents-from-websub-json-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-08-cloudevents-from-websub-json-LC7\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>specversion<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>1.0<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-cloudevents-from-websub-json-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-08-cloudevents-from-websub-json-LC8\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>datacontenttype<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>application/cloudevents+json<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-cloudevents-from-websub-json-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-08-cloudevents-from-websub-json-LC9\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>traceparent<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>00-37d33dfa0d909047b8215349776d7268-809f0432fbdfd94b-00<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-08-cloudevents-from-websub-json-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-08-cloudevents-from-websub-json-LC10\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326/raw/9bf7299cd55c3b2e19f88d82f4aabedebbe5716a/08-cloudevents-from-websub.json\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326#file-08-cloudevents-from-websub-json\">08-cloudevents-from-websub.json</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>여기까지 해서 아래와 같은 변환 절차가 끝났습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-02-ko.png\" alt=\"유튜브 WebSub에서 애저 이벤트그리드로 변환하기\"></p>\n<p>이제 다음 단계로 넘어가도록 하지요.</p>\n<h3 id=\"2-websub-xml-데이터-가공\"><a href=\"#2-websub-xml-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EA%B0%80%EA%B3%B5\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>2. WebSub XML 데이터 가공</h3>\n<p>두 번째 단계에서는 WebSub XML 데이터를 소셜 미디어 확산을 위해 필요한 데이터 형태로 가공하는 일을 합니다.</p>\n<p>앞서 받아온 WebSub 데이터에는 비디오 ID, 채널 ID 등과 같은 제한적인 정보만 들어있습니다. 따라서, 이를 이용해서 구체적인 정보를 YouTube API를 통해 받아와야 다음 단계의 소셜 미디어 노출에 필요한 데이터를 가공할 수 있습니다. <a href=\"https://docs.microsoft.com/ko-kr/azure/event-grid/overview?WT.mc_id=devops-dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 이벤트그리드</a>에 발행된 이벤트 데이터를 받아 처리하려면 우선 이벤트 처리기를 등록해야 합니다. 이 등록 과정도 앞서 WebSub 구독 등록 절차와 같이 <a href=\"https://docs.microsoft.com/ko-kr/azure/event-grid/security-authentication?WT.mc_id=devops-dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">유효성 검사</a>가 필요합니다. 그런데, 이벤트 처리기로 <a href=\"https://docs.microsoft.com/ko-kr/azure/logic-apps/logic-apps-overview?WT.mc_id=dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 로직 앱</a>을 선택하면 이 유효성 검사 부분을 내부적으로 처리를 해주기 때문에 여기서는 로직 앱을 이용하면 편리합니다.</p>\n<p>로직 앱 이벤트 처리기에서 처음 하는 일은 이벤트그리드에서 받아온 이벤트 데이터가 내가 필요로 하는 데이터인지를 확인하는 것입니다. 내가 필요로 하는 이벤트 데이터라면 채널 정보와 이벤트 타입이 맞아야 합니다. 내가 필요로 하는 데이터가 아니라면 더이상 로직 앱 워크플로우를 실행하지 않고 멈추게 됩니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-03.png\" alt=\"이벤트 데이터 확인하기\"></p>\n<p>내가 처리하고자 하는 이벤트 데이터라면 이를 애저 펑션으로 보내 데이터를 가공합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-04.png\" alt=\"이벤트 데이터 가공하기\"></p>\n<p>애저 펑션에서는 유튜브 API를 이용해서 비디오의 구체적인 정보를 받아와 가공한 후 다시 로직 앱으로 데이터를 반환합니다. 애저 펑션이 반환하는 데이터는 대략 아래와 같이 생겼습니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107473935\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-09-video-details-json\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-json  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-09-video-details-json-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-09-video-details-json-LC1\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-video-details-json-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-09-video-details-json-LC2\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>channelId<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>&lt;channel_id&gt;<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-video-details-json-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-09-video-details-json-LC3\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>videoId<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>&lt;video_id&gt;<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-video-details-json-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-09-video-details-json-LC4\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>title<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>hello world<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-video-details-json-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-09-video-details-json-LC5\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>description<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis malesuada.<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-video-details-json-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-09-video-details-json-LC6\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>link<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>https://www.youtube.com/watch?v=&lt;video_id&gt;<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-video-details-json-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-09-video-details-json-LC7\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>thumbnailLink<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>https://i.ytimg.com/vi/&lt;video_id&gt;/maxresdefault.jpg<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-video-details-json-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-09-video-details-json-LC8\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>datePublished<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>2021-01-27T07:00:00+00:00<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-09-video-details-json-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-09-video-details-json-LC9\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>dateUpdated<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>2021-01-27T07:00:00+00:00<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-09-video-details-json-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-09-video-details-json-LC10\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326/raw/9bf7299cd55c3b2e19f88d82f4aabedebbe5716a/09-video-details.json\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326#file-09-video-details-json\">09-video-details.json</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>여기까지 해서 대략 이벤트 데이터를 가공하는 작업이 끝났습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-05-ko.png\" alt=\"이벤트 데이터 가공하기 다이어그램\"></p>\n<h2 id=\"소셜-미디어-노출\"><a href=\"#%EC%86%8C%EC%85%9C-%EB%AF%B8%EB%94%94%EC%96%B4-%EB%85%B8%EC%B6%9C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>소셜 미디어 노출</h2>\n<p>이 로직 앱이 해야 하는 나머지 일은 다른 소셜 미디어 확산 도구들이 이 데이터를 받아 처리할 수 있게끔 해 주는 것인데요, 여기에는 두 가지 방법이 있습니다.</p>\n<ul>\n<li>이 로직 앱에 직접 다른 소셜 미디어 노출을 위한 API를 연결하는 것</li>\n<li>소셜 미디어에 노출시키기 위한 도구들이 이용할 수 있게끔 이벤트를 던지는 것</li>\n</ul>\n<p>첫 번째 방법은 의존성이 생깁니다. 만약, 새로운 도구가 추가된다거나, 기존 도구를 제거한다거나 하면 이 로직 앱을 반드시 수정해야 합니다. 이는 유지보수 측면에서는 그다지 좋은 방법은 아니죠. 반면에 두 번째 방법은 다시 이벤트를 생성해서 뿌리면, 다른 소셜 미디어 확산 도구들이 각자 알아서 이 이벤트를 받아 처리하면 되기 때문에 의존성을 없앨 수 있습니다. 복잡도가 한 단계 증가하기는 하지만, 유지보수 측면에서는 굉장히 편리합니다. 따라서, 여기서는 두 번째 방법을 선택했습니다.</p>\n<h3 id=\"1-이벤트그리드로-가공된-데이터-발행하기\"><a href=\"#1-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EA%B7%B8%EB%A6%AC%EB%93%9C%EB%A1%9C-%EA%B0%80%EA%B3%B5%EB%90%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B0%9C%ED%96%89%ED%95%98%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>1. 이벤트그리드로 가공된 데이터 발행하기</h3>\n<p>이벤트그리드로 다시 이벤트 데이터를 발행하기 위해서는 우선 CloudEvents 형식으로 데이터를 구성해야 합니다. 앞서 받아온 데이터는 말 그대로 데이터를 가공만 한 것이고, 아래 로직 앱 액션에서 CloudEvents 형식으로 데이터를 가공합니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-06.png\" alt=\"CloudEvents 형식으로 변환하기\"></p>\n<p>마지막으로 이 이벤트 데이터를 애저 이벤트그리드로 보내는 액션을 만들어 보면 아래와 같습니다. 아래 그림에 보면 헤더 영역에 <code class=\"language-text\">ce-</code>로 시작하는 다양한 메타 데이터가 보이는데, 이는 CloudEvents 데이터 전송시 <a href=\"https://github.com/cloudevents/spec/blob/master/http-protocol-binding.md#3-http-message-mapping\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">교차 검증</a>과 관련된 규약 때문입니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-07.png\" alt=\"이벤트그리드로 데이터 보내기\"></p>\n<p>이렇게 이벤트그리드로 데이터를 보내고 나면 개별 소셜 미디어 처리기에서 이 이벤트 데이터를 처리할 준비가 된 셈인데요, 다음에서 개별 소셜 미디어 처리기가 어떻게 대응하는 지 볼 수 있습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-08-ko.png\" alt=\"이벤트그리드로 데이터 보내기 다이어그램\"></p>\n<h3 id=\"2-개별-소셜-미디어-처리기\"><a href=\"#2-%EA%B0%9C%EB%B3%84-%EC%86%8C%EC%85%9C-%EB%AF%B8%EB%94%94%EC%96%B4-%EC%B2%98%EB%A6%AC%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>2. 개별 소셜 미디어 처리기</h3>\n<p>앞서 소셜 미디어에서 처리할 수 있을 정도로 데이터를 가공해서 이벤트그리드로 보냈다면, 개별 소셜 미디어 처리기는 각자 상황에 맞게 이 데이터를 받아 처리하면 됩니다. 이벤트그리드에서 받아온 데이터는 대략 아래와 같이 생겼습니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107473935\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-10-video-details-to-cloudevents-json\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-json  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC1\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC2\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>id<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>4cee6312-6584-462f-a8c0-c3d5d0cbfcb1<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC3\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>specversion<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>1.0<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC4\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>source<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>https://www.youtube.com/xml/feeds/videos.xml?channel_id=&lt;channel_id&gt;<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC5\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>type<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>com.youtube.video.converted<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC6\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>time<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>2021-01-16T05:21:23.9068402Z<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC7\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>datacontenttype<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>application/cloudevents+json<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC8\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>data<span class=\"pl-pds\">&quot;</span></span>: {</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC9\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>channelId<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>&lt;channel_id&gt;<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC10\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>videoId<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>&lt;video_id&gt;<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC11\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>title<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>hello world<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC12\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>description<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis malesuada.<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC13\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>link<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>https://www.youtube.com/watch?v=&lt;video_id&gt;<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC14\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>thumbnailLink<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>https://i.ytimg.com/vi/&lt;video_id&gt;/maxresdefault.jpg<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC15\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>datePublished<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>2021-01-27T07:00:00+00:00<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC16\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>dateUpdated<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>2021-01-27T07:00:00+00:00<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC17\" class=\"blob-code blob-code-inner js-file-line\">  }</td>\n      </tr>\n      <tr>\n        <td id=\"file-10-video-details-to-cloudevents-json-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-10-video-details-to-cloudevents-json-LC18\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326/raw/9bf7299cd55c3b2e19f88d82f4aabedebbe5716a/10-video-details-to-cloudevents.json\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/cb04844306f9a44dcdcaaa70a6a55326#file-10-video-details-to-cloudevents-json\">10-video-details-to-cloudevents.json</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<h4 id=\"트위터\"><a href=\"#%ED%8A%B8%EC%9C%84%ED%84%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>트위터</h4>\n<p>로직 앱은 <a href=\"https://docs.microsoft.com/ko-kr/connectors/twitter/?WT.mc_id=dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">트위터 커넥터</a>를 자체 제공하고 있으므로 별도로 API 호출을 위한 코드를 만들 필요가 없습니다. 따라서, 아래와 같이 간단하게 호출하면 됩니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-09.png\" alt=\"트위터 포스팅하기\"></p>\n<h4 id=\"링크드인\"><a href=\"#%EB%A7%81%ED%81%AC%EB%93%9C%EC%9D%B8\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>링크드인</h4>\n<p>로직 앱은 <a href=\"https://docs.microsoft.com/ko-kr/connectors/linkedinv2/?WT.mc_id=dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">링크드인 커넥터</a>도 자체 제공하고 있으므로 별도로 API 호출을 위한 코드를 만들 필요가 없습니다. 따라서, 아래와 같이 간단하게 호출하면 된다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-10.png\" alt=\"링크드인 포스팅하기\"></p>\n<h4 id=\"페이스북\"><a href=\"#%ED%8E%98%EC%9D%B4%EC%8A%A4%EB%B6%81\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>페이스북</h4>\n<p>반면에 로직 앱의 <a href=\"https://docs.microsoft.com/ko-kr/connectors/facebook/?WT.mc_id=dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">페이스북 커넥터</a>는 더이상 사용할 수 없습니다. 따라서, <a href=\"https://github.com/microsoft/PowerPlatformConnectors/tree/master/custom-connectors/Facebook\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">오픈소스로 풀린 커스텀 커넥터</a>를 이용하거나 다른 방법을 쓰는 수 밖에 없는데, 마침 <a href=\"https://ifttt.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">IFTTT</a>에서 <a href=\"https://ifttt.com/facebook_pages\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">페이스북 페이지로 포스팅</a>하는 커넥터를 사용할 수 있으니, 이를 이용하기로 하겠습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-11.png\" alt=\"IFTTT 페이스북 커넥터\"></p>\n<p>로직 앱 관점에서는 IFTTT 쪽으로 HTTP 요청만 보내면 되기 때문에 별다른 어려움은 없습니다. 다만, <code class=\"language-text\">value1</code>, <code class=\"language-text\">value2</code>, <code class=\"language-text\">value3</code> 어트리뷰트만 사용 가능하다는 점 주의하세요!</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-12.png\" alt=\"페이스북 포스팅하기\"></p>\n<p>실제로 IFTTT 쪽에서 이 요청을 받아 처리한 결과는 아래와 같이 보입니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-14.png\" alt=\"IFTTT에서 페이스북 포스팅하기\"></p>\n<p>이렇게 해서 트위터, 링크드인, 페이스북 등 소셜 미디어로 새 유튜브 비디오가 올라왔을 경우 포스팅하는 방법을 구현해 보았습니다.</p>\n<p><img src=\"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/websub-to-eventgrid-via-cloudevents-and-beyond-13-ko.png\" alt=\"E2E 이벤트 처리 절차\"></p>\n<hr>\n<p>지금까지 <a href=\"https://docs.microsoft.com/ko-kr/azure/event-grid/overview?WT.mc_id=devops-dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 이벤트그리드</a>, <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>, <a href=\"https://docs.microsoft.com/ko-kr/azure/logic-apps/logic-apps-overview?WT.mc_id=dotnet-12869-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 로직 앱</a> 등을 사용해서 특정 유튜브 채널에 새 비디오가 올라왔을 때, 이를 WebSub 이벤트로 받으면, 1) 이를 CloudEvents 형식으로 변환해서 애저 이벤트그리드로 보내고, 2) 필요한 형태로 변환한 후, 3) 원하는 소셜 미디어로 포스팅하는 전체적인 워크플로우를 구현해 보았습니다. 각각의 단계는 모두 디커플링을 시켜놓았기 때문에 유지 보수 차원에서 의존성을 고려할 필요가 없을 뿐더러, 향후 새로운 소셜 미디어 채널로 포스팅을 계획할 경우에도 손쉽게 추가할 수 있는 구조를 만들었습니다.</p>\n<p>만약 이런 온라인 컨텐츠 마케팅을 기획하고 있다면 이와 비슷한 형태로 애플리케이션을 구현해 보는 것도 좋은 시도가 될 것입니다. 또한, 이를 통해 전체적인 클라우드 시스템 아키텍처를 구성하는 방법에 대해서도 고민해 볼 수 있을 것입니다.</p>\n<h2 id=\"더-궁금하다면\"><a href=\"#%EB%8D%94-%EA%B6%81%EA%B8%88%ED%95%98%EB%8B%A4%EB%A9%B4\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>더 궁금하다면...</h2>\n<ul>\n<li>애저 클라우드에 관심이 있으신가요? ➡️ <a href=\"https://azure.microsoft.com/ko-kr/free/?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">무료 애저 계정 생성하기</a></li>\n<li>애저 클라우드 무료 온라인 강의 코스를 들어 보세요! ➡️ <a href=\"https://docs.microsoft.com/ko-kr/learn/?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Learn</a></li>\n<li>마이크로소프트 개발자 유튜브 채널 ➡️ <a href=\"https://www.youtube.com/channel/UCdgR-b2t7Byu_UGrHnu-T0g\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Developer Korea</a></li>\n</ul>\n","humanTime":"02 February 2021","datetime":"Tue Feb 02 2021 12:00:00 UTC+00:00","canonical_url":"https://blog.aliencube.org/ko/2021/01/27/websub-to-eventgrid-via-cloudevents-and-beyond/","timeToRead":19,"tags":[{"id":"azure-eventgrid","title":"azure-eventgrid","path":"/tags/azure-eventgrid/"},{"id":"azure-logicapps","title":"azure-logicapps","path":"/tags/azure-logicapps/"},{"id":"azure-functions","title":"azure-functions","path":"/tags/azure-functions/"},{"id":"cloudevents","title":"cloudevents","path":"/tags/cloudevents/"}],"category":{"id":"Azure","title":"Azure","path":"/categories/azure/","belongsTo":{"totalCount":11,"edges":[{"node":{"title":"애저 Bicep 되짚어보기","path":"/posts/2021/04/27/bicep-refreshed/"}},{"node":{"title":"애저 펑션 프록시 기능을 이용한 Open API 확장 기능 하위 호환성 유지하기","path":"/posts/2021/03/16/openapi-extension-to-support-azure-functions-v1/"}},{"node":{"title":"애저 펑션에 Open API 활성화 시키기","path":"/posts/2021/03/09/enabling-openapi-on-azure-functions/"}},{"node":{"title":"이벤트 기반 애저 키 저장소 시크릿 로테이션 관리","path":"/posts/2021/03/02/event-driven-keyvault-secrets-rotation-management/"}}]}},"author":[{"id":"justin-yoo","name":"유저스틴","image":{"type":"image","mimeType":"image/png","src":"/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png","size":{"width":500,"height":500},"sizes":"(max-width: 500px) 100vw, 500px","srcset":["/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png 500w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 500 500' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-6a0325b746fa0b3948747e4a6f689de9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-6a0325b746fa0b3948747e4a6f689de9)' width='500' height='500' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC%2baJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVRo3pWZd1RT67b2ueccy7YgHQKE0HsvYkdFsaFYEKUI0nsnlPSEhBI6offeISgdpPeQ0JFi3%2bfse84Yt/x3v7%2b/udaCiLq3d9893rH2Soz4/J75zPm%2bK0jMz68sLq4tLa0LhVvLy9srK7tra%2b/Ea339/fr6h0Pr459Za2sfflyrq%2b/R9W5lZW95eVck2hGJtoWwlt4Kl7YEgk3B4oZgYWNxfm1hfm1%2bbmVudnl2RjgzvTQ9JZiaXJwYnx8fmxsbnR59M/VmZHJ4aHxocGyg/43E7KxoYWFtEf6yYFMofLu8vLO6undIPQKwsYGtTxsbH9H1CVugFbv%2bEcNhmAOA9ysr%2bwzLwm0RLATg7ZJga2lxEwVYX5j7HYDJiYWJcQCYAYCR4QkAGBwYRQBmZoTz86sLC%2bvAAADgCgBg0lHR2FWs%2b8NhgMMkf6YO3wCIdpdFCAD8o0tLW8hCAUAJCrA6PwcAIgCYmRYDzI%2bNzmIVAIb9CgDAHHx6HgGAnwIAWIpQ48WW/47oP2L4Qes7uPnxTQRAiKYIAxBsIgCLKMB%2bhEQ/VAADmP4mQtPTwtnZFWCAvwk/CH4cBnBY9%2bbmZ/T6M4ADie/gw7u7v%2b3t/fv29j/evfsn3Ozs/AZgIF0kgujvIgDLSAWQNhAiPXAAsLEIFYAegArMrs7NrmAV%2bBZgDgP4WoHx8YWpKYRhfn4N2kBcASz0IBpdn7HrH6kHcTs7/4C1t/fPmZnVzs7%2bxERaRHhMZERscFB4R0cvqAS58Ke7u/8OACLE%2b10hLAAQHDQx0gAYwCoCMLPyuxWANvimAqOjc5OTSwAAFTgE8B6z/xDA55%2bE5/Pn/%2bofmLK/ftPN1cPh5m0pyVOy0lLysjLSZ87ISksrKSiYGJmctbF95uKal1O4urK3ufVFKNwRLu3nRyhAABaRCiANcNDEfxQhAIA%2bPgAYn1iYmRGB/Yd7AG2Aj/%2bremwKra19rK5uuXL56i/HjkqePIFIl5ORg/9JSkqePi156uSpEyeP/O1vf/nLv0lISMhISz9%2b5NzSzN/Z/vvmxuclGEECFGBxc2FxHRtBUAHU/p/1wFcArInF6rExinUwqv5/wXi3908ul6evoycvI62moqyGV1FTVVFSkMMpKSgpIjVQVJBXUkTupM5ISkvB5fQvx49rENSfI9UogmqA90uo/Wj7rs8jHbyKzlCsAZamJg/vA1gFJr%2bOUdjFBIKv3qObwOH8fDxg%2bHx4YfZDpqOjE1SUFPE4JXW8ihZBTVdLw0BHSwOvoqmmqqmmoq6KwysrAg9ccYoKCvKysIDqxC/Hjx7566kTv2SkZ29ufATFSAMsiNVDBZZnp0UzU1/tB/UHANPYPrBfAWz/Ent/aIB%2bB/ANA0wbaMem5ld6unog10BXRx90q6nqa6pdtja%2bYWty46zR3QtmD%2b0s7cx17cx1zhtpauNxyggJDhjOSJ6CjP1y7Mjtm7dGhqfWoA6Lm0h%2b9gFW5iA/06LpKaE4PBjAQQMgIwgq0N83IoGdIA7UY/vux9%2brwKfD9m9tfREt7121u66BV9XX1jLS0bA21HK5aUv2f5gW4VJAdK2keFWRX1QnuWUF3MsLvMvxvuVlb37ZmKBPUFaSl4UmgTqcPnnizOmTgESMjYdBhPTu/BqqHhpgeWZaiNovENuPqv86Q/cjBOoPjH9/kOyPh8z%2bPjzIgui/%2b1dMTCJeWUlbg2Brqh/j6sAjutaz/GZqSXM1CbPlsbOlMeO80MEMPz7dvTXRpSXBpSz4Dv2JrccVAzMNJVVFOXlZGFGAcPzUyROmJiaTE4uwCczNYvavzCD2L00j6vfTP4ocImZGhsX5QdQjFTh0avi6bf1kwQd2d36LjCTiVZS11NVNdQgcP8e%2bzOCxkti5OspaR8pmV6qonjJTGD6ZHzIMALTnnTRXPtWtOfZR4ctrDCcrzwtaVurymorS8lKSp0%2bdgAUDi0ljra2%2bm5leRuyfXp6ZQgCmJgTi/GD2Q96Gh77ajwAcHNSwufn55wDQuLC58rtHFOTkVJUUYeyEPrwynBW0WJe4wU/b7c//MFLyYaRs61WWsJY0XRA%2bnhPYz3nZx3k5kObbRXWrCXVkP7SKvKb3yAx3QUNWT0laRvIk/Hf0yN9winItzZ2w34F0dP5A%2bpfE9ovH//DQ1y0M1Pf1DiEAm5sf0Ov%2bYeEnAHBY%2bPT5P5nMdGnJU1oa6udNdcuIz0YLI9Y6OO%2bGC98PFX8YKf80Vv32dZ6wjjpdHDmRHzKWGzyaEzTE9eNTXGtD7qU8sk64Zex7XuO%2bsdI1HUVteaQIUlJSsEU43b%2b/ItqZnoThA0v43fA5sH9c3L6wenv2AT4ebFuff74QgE//ERwcKS8jpaul%2beT62epEt4mS%2bJ3%2bvHeDRR9Hyj6%2bqfgwUrnawp3ixUzyIt9kBY7lBI3nhw2kercSHxd5XmU6msc7GEZc03M2V7ljqHSOIIOTkTxzRvKvf/k3C3Mz5PwzvYzaD%2bERHLYf1I8MTw4Nfk1/X%2b9wz%2btBiR%2bPDD9JP3wYpqez83MAMDMy8HS0q6F6CZtT3o%2bUQ3I%2bjVa8Gyxea09bqqdPFccOpgcNpAUOZwSM5YWOZAZ0JroUelxhOprF2utHXtd/bom/a6h4UUNWXf6MtLTU8WPHYK/jd/QIFjYhPOL2PQgPZv/k4IA4PMNg/%2btXAxIHTypfw/Pd/WGAt29/nV/YsLSwUlaUP29t4XHnYh3Lf42fvdtfvDdUujtQsMHPWO/K3uDnLbekjuaE93P8Bzg%2bQ9yACV5kf6pvbdh9jpN1zHV9v4uartZqd4wUoRM0FaRkzpw%2bdeokHDXYTM7K8g54P4XYv392EKsH%2bwf69%2b0H9WIA8Vn/o/jkfHgd7mA4J3e/GlFVweNVcBesLV7cvdyREbHGz1zryhI0ssfLSXMNKW%2bHanfH27aH67f6yuer6RO8qMki4mwlZao0qZvlVxbygP7knNcFbSdTFQd9pfPqMuoKUrCxnT55EtrA7bkbbKkT44tTB/kZfbMPMDQ48aP9r7r7JX58WPmO4TDA%2b/f/amrqxquqahLULE0MA584TFSQ1zvT5moZVWTf3ES/FKI/O9q3hBHekh4z15q3O1Inaslcak6fr%2bc0swJpnne875xzuWjkaK11SRd3RVvhIkFGTfY0jNMzp08DwDNnF9jREO%2bR9kUADoVn/Dv1sLr5fRJ/5mlLfPiB/au%2boVNZSRFmqK6aCsvHca2VtdTArE3yzIv2KGVF8mjBmfFeVazA5rTQN1WsD%2bPNi3XcocyI/uzItID7L25anTfSstAlWOuqWGspWRIULqnL6cufQrZkSQTgsdNDOFBg4Tk8fLDw9Pe9wdRD72L287t6v%2bmBny8YQfB41dk5gFeB85vSbRuDfo7XWkPSXEkMn%2b03Uc0WdBSI2nNmyknD2RHCZs7eUPHOQOlsOb2N%2bKw%2b5klxqGNJ6P02lncT1Yvz4prbeW1rgqytuoINTlLu9C8AAKftB46OS4INUC9u34OdCwP4JjxgPwJwcPj59Geeerff/n1yUmRqbKKqpEBztx9M8elIDapPi%2bFRgkqZoU3ZCUW0QLKXY%2bT9i0muN3lEj4lyyigvttDbnnjLNOK2RaqvYz7RnRv4MOG%2bjaMZ/qy6rA1e9gpBVl/u1LGjR6ECZ62t4IELdgDx9MR6F0s/NjcPq%2b/q7JEQnz3/DABMoZmZFUsrG2sr67iIKJdHD8lkMinUtZbhPt5A6SwnpjKC7lw/63JOn%2bV8sY7sXptHD/d/qa0ko6Uk8%2bCKsf8TO1tTQx2crIOZxh1jVRsNBRtdvJmmsh5OTk9LE4dT1lQndHW8hscAkH5gP5b%2b0R%2b9B/WdHa//DwBooT4vi3Zi3V1unLPKjg%2bK9XMtzM/IjXtcS3rUkh3UWhjdUUSLe37L/5Jh2rPLizXxbEq03w3bR2d1jLXwvi5XWZHOSe73Aq%2bbudho2mvLPjHHXdZSvH/HQVlV%2bemjx1cv2cXFJmC77%2bHhM9A/hs1NsB9T381H1MPqaH%2bFHeY%2b/lmAzS%2bby9vtRN%2bYl8/aqd4zuaEtueT6jLDenMCBwoiZGnIfN6wm4nGe142BrJCewthAt3uThbF1sU/PWxi%2beHCH/sIh2%2btGuutl8j3zoKu6z6zwDgbKMaFBRjrqevD0Iy/d0dwBz2Lf2d/fN9rbsx8eTD2/C9S/7ux41dHevQ8gXoe/4fkRYB15Evj8piCd4vu8Ls59Ni%2b8IyOmkB6w1Zu68TpjujC2j%2bU7xA2eLYl735PZW5CYHeP%2b6wivIc7ZUlP5qZV26mObQp8bPG/7TNdL6c5nI67pP7HWJYYF2hmoEc6ceHDdbnpiYWx0Htt6xer7ekd6Xg%2bJxw6WHPC%2bva27rZUvgX0B%2bLvr9763%2brCx/dvqYF9ugDMv6NFcQbSwMaWCFd5dQBR05k1Xs0aLk0Z48T2ZkV1ZUTBS5%2bqZv46WvKJ5XNaQdzDC5b%2b8Wh/u1BDq1BjxsMTnZuxNk9D7l72fPzqLl9eSOc2IjV0UbMKR880I1rvIzgWjE7P/sHrM%2b/Y2fmtLl4T4S8yfYHzzcvPXLdHGQk16M8V3pjBmqzP9w0jNSHVWRy61jh1ZQfKrogZUkXzqGMHTVWQo1peJqvGccD9bdQcDpYcWmmF3banP7CnOVxMeX/G/ddb5hu0lXeXrBoSzSlLF6dy5%2bfU3w1Ni%2byH9qP374QGAw%2brbWrtamjskfvwG8%2bckG3AmXdnbbM4dSQ%2bf4EWvNjHfD5X818rgfy4Pfhqq3mhOncgMmcqJ2ONnrzeytruz/jHTNF%2baFH/DmHzP4oUZ/pmJckOSVx3Rg%2bd9l/LA9omZqp2GrJ2ump2mcldzx9SUCIn%2b/sFhP/2vX%2b3bjyUH1ENywPvWls7mpvb/A8Chbz8/rtRnD6WFjOVHCuuS3nZnfh5r%2bm2h7%2bObhn6aT4nndVFz5l5vycehmo/Ddf8SdK%2b1pFDvWXrZaDjpyvvZELrInvNlpCGWT5GnvbsV4SJB9rK2spOlwfDA6PjowuHe7et9A%2bnHJg8WHsg9mpxOTH1TY5sE9oXrjwx/TPJhbePLRl/LXAV5gBu4WB632sx611v4abxpoYJR7HFtror%2bZaJxg18yVZM2Us4Z4hGro12czVWvass4GePCLuvme9j3p4b00l%2bmPbZ5ZIw7T5C5gJcJcLwBp%2biDU%2bcEGh5Qj9iPqT/oWsR4SA6mvqG%2bFQDe/QjwY0EO7j%2bsw83W3zdHh%2baLk7rZvnOlUYtVCauN9M2u3PqopwO5sWs9JaKuomV%2b0UIHb6YxvSMlqCzejeNxJdHJOuquBZxDo29bcN2v8Ske7IeWt3TlzqvL2SidDna6PTUjGtrvXSw8I69fDXXzB7DwYDMHNR5R39jQ1tjQWl/XLCH%2bvYN4/QQGWavv1ze/rM4uzZcyu5kvp4oiFmsThXXk2UpySfC9ifqUxbac7aGa3ZH6vdHmrd6q2VLmeD7pFellzvOrjEfnwm4YBdobh9obt5FcYZje0pO3xUvbG2qU5/ImJgSYerAf1IP9r7q/2o/lHrxvakTUN9S3gPq62iaJ1ZX3PzL8iLH6LcPa5hfR%2bFh3sv9YXthSA2WllTFdEtdO9x4sSqhJcO/NS1xqylmozVqsyZkvy3ydFMJ7cYf51M7rnO49feW4u9apntd70oKyXtg56MlbKhxnxMbMzW8MDkwM7u%2b7o2h4EPu7OvftR9V3HqhvxdTX1jRKLKO/bsB%2bDfFHACvwzg91WNv8e28RG556RY2MxbqkmZLY0fwoflpgpudtXtSLjaHq91NNnwT8X9dHREM19Rkx6ZHPbxjinxhplAY4tbF8BnMiom%2bZ2evKnsefqS6pmJgUDgyg4enHehexn9/V39mB2I%2bph/B8p76muv4bABC6jF7FDMh19QP2R9/%2bsujd5vZvo%2b1Nrznewkb6YiNtqoI4xosYK4pZaUvf7Sldayna6ajba2neaa5dyE9rDvAkXzIPO6eX5nyp2Mehg/GyPObJMxu1W/pyjrYmQ4OTI8MzaO%2bOH/Tuvv1o7/J/X31VfXVFrYRoeW//dz6H1o8F%2ba4yq2uA9GFhWtiZGjZZEiNsZszUJE1VJMw3MDb4Oe8GS36dbv401rbdXjOfzx5ixbSHv8h8coX2wCbH7UqR982i4HvhDiZPrPC2uON0InFmdnWgH%2bvd/fSjvYvYj02e/fCA%2btoWkF5b3QDqqyrrKstrJITLe8sog%2bhgrfwQqh95AHJr69fVjS81GQw%2bx3u8OHqsMHKiLH6xhb0GAAMlX8Zq/zHXudVfMVqe3JES2ckIqAx9WOp/p9TXIe/ldfLjs/dMcBfVTj%2b9fnF4eHp4eGZgYLL/d%2bx/Db0rtr%2b%2brqWupglTX42qryirlhCKdkUogwhdy8v7FTh83V8H6VpB1H%2bByD54%2bMTK3LQg%2bmkbw4vP8e3JCJptYKzys/cGCt8PFH0cqXo/WLfcWjjGI/fS/FojHtcG3eF5XeU8PedsTbAhSJvhTl%2b2tenpeTM0NN3fB%2bqhd5HRCenv6uzraO9ta%2b3%2bRn1t8773FbWgvry0qqykAgVA1zKKAQURruyBbgTmW4BlrETLexCh2dmVG/Y3ZGXkFHCqNJ/7dWSPGrL764zAwYLI5U7udh9vr7/gLT9rvS1P0Jg9nBUDB7hKv1sFL67QH1gEXtU/rylnhpe10cQdQb9KmZwU9va8QY894t7txUYnFh6IPqq%2bEYw/pL6ypKhcYkm0u4QCLGG/dTtEAnKxdO1f0QUf23r797KyKmVlnKKCkqqmXmtJ7nB2cEnss8pE1%2bZkn9HyxLWevPVXucL2rPnGzJm6jO7U8MrwJ/neNxMf2Phc0r5piDPFy1kR5G0I8vAY%2bfTx4/EJwevXbzD7QT1qfw9qfxe2Z4H9WNd%2bp76ooFRCINyBtQTrAGB/YQwojHihb%2b6urH2sb2q5c/c2/PO3HrrPvxlfqiGOlhBrSe7FUc5l8c/7CuNE/Jz51qyxShao56eGVsW4MFyv%2btub3DHDm6nJm%2bDlz6nJWCifgZ%2bgr6MFWe/rmxCHB%2bxvb3vd2oLkRxyemqoGLPegvrS4AlNfyCvaBxAzLB2UYgllQBoDfYl1CLyzBACr70sqKtMyODpa6m4BpLmFvaUG2tuerLlack96QE3C8/yIx/Usv56COH56UBvDp4Xuw3S76nPD/JaFlrkGzgyvYIU8y0ub4s787chRGWnJnKw8aGXwHnoXDc%2b%2b/U2NHVh4atDwVJbXHva%2bkFfMyyuQWFzaxtQLDi1QLzioydIBAKIefbm8%2bqGqpp6dlkymJDx44t00sDPbUfm2O3XzVdZcDXk4L7yF9iI32JHtfYv64maCm33A3bN3bXQvG6nbaKlYayhZ4eUuqsteVz9jpKogI6984pdjQYFBsAmAbnTywOh83dLc3dyE2d9aW9NUXVVfWYHMHEx9cWFZIa8E1Ofl5EsIAABdGMl3GN/VBAXbXl3/1NDcwU5lpnA54REhYaS81wMr4yXxG/xUUSt7pipxKCekg%2bFZFfckw%2b9WjNNZ14t6T85qO5/VvmeOv6Apf5Ygd01b3o4gaaypYWxpd/z4sWvX7MDsEShCZ39bK%2by7oJ6P2t%2bGqm%2borKirKK8pQ8ODqS/IL8rP5eVm50kIBG/FANgS/B6JEK0J/ClSB%2bFOUWlRKpedmc3lpLOJCTGMnKaGmu7elABBDWmxjjoPm1pp3Agvsj8ruI3qVhTgkOlhR3909sV5rUtaCpc15G7ryl1UlTTS1rn7NOTYseMXLtj6eHsz6GxQ/Kp7CBgaGzrq69qw8FRV1leg4cHUF/FKC/KLMfXZmTkSC4tbC4K3sBYPMSweFGRxaUewf7MNGOD99Nx6bUMjYn86m5udlpaZmsrlUKjxiawsekR4cZhTX7LPeF74dClxpjJppoY0VhjVlx7QFO9S6H/T57LeZW3cdR2F2waK51TP2JhZ%2bsdlHzl23NLSwt3D1cRY38TYIDQkrLK8DlIEGHW1Laj3teVlNaUlmPelqPcQnrycrNysjGyJ%2bcWt%2bQMG8RIc4kFeQmzWPiwKthuauxLIZBqTwmBRGWxaamZKWlZKakZqGjclOib0hZe7m9szTpR3npd9fbgjn%2bbRkxrwKtW/NyOkLy2I53fHyVLbXk/VwUDlngneWunkLfu75MxWANDV1fH197l//66M1CkFeSlrK3M3Nzc6jQXSoYmBoaS4EvG%2bAPO%2bEKKPqc9Iz5SYW9jEGMQLqQa65gXIS6FoTyDcbe/qpzGTw6PDwmPCiYmx6RkpLDYd%2bhhmEZPDgGrExEW99PHy8PKgJDOo5DiKrzPH7Xq%2b17XSkHulYQ%2byvG56nte7a0K4a6J%2bx5jgaK5hJn88LJzELuo5euwEgUAICPILCPS9fPm8vJyUkqKsJkHFyEDX/trV8LCIvJxCmJ4AwMsrQtXzxOq5aVwEAGXYPAwAC24gOaKV9/1DU9ys3KiYqMjYyERKQgKZGBYRkpaRAtKTU5ip3JTkVCY9mUahkzxfenh5v0jmMBgcFjMlmcEgF9Cj6S5XYm4aedioO5mqOJmr3zJSv22icctA5YKmYkXTGDO34%2bjx03iCZkhYUCwxsrKm%2bvad26dOHiOoKRvqaRnp6xgb6dlduRQcEASxKSmqyM1Goo%2bqz%2bKmZaSlpErMzm/AOsBAALAbaNbRcUFeYWlkTBQYT6IkJNESKQwylU4KiwimMEgZ2Wmp3GR2GgsAklMYrBRGVEyEy3NnTiorK5fLSUsGts3t7YGBfleHi/f0ZJ3MVG8b4a/pqt4yVr%2buKf3o6uWhhX%2bGkfN/OSVD0DLy9PYMjQgpKSvhFZecOX1CXl5WU13VUF/LyEAblqGBjv01u7iYuHzUfpCenoqoT2VzJGbm1jEGZC0gVzB%2bfvFtbUMbMSkBfmgCOZ5ETyLREhnJ1GQOHa7xSbGJ5HgWhw51SM1gQ5DoLAokChg8vTxiiFGZOenQ2XQWrbyyrLCs2DcwwFoHb6sqdUFd4ZoO7qa%2bsq3S0Qg//%2bmt/%2bfsFXNaGqdtdPahs3NweGhcfGx334CegY6k5ElVFSVtTTVDPU3AMDHWMzbWMzU1cHrgmMxkZ2fmprIR9SmsZAQAY8CuS8Ldnv5xTjoXAkNMiiNRE6lMMqxEajyNRU5OAQAKmZFEoiZQmSQmh5aRlZqRlQZZojHJEKrI6LCgEH%2bwH%2bpAppJoLJqX70vbc2cv29lZqCufV5W%2bpC5/TlXqmpZMfWNfIKX2%2bsNAvJbJOXvnh0%2bfhUdH%2bgb49g4O3nNyPHb0ryo4eYIaTleLAFky0NcyNdG3tDABkvO2VnExMRAhDpPNZjAlpmfXYE3NrM4tbAFARXVDbGJcFDEqkQqBIZHpiRR6EkiHGxI9kcGmMtlUeAmJpzPJcAOzKD0rlZuVAmCcNBYSsMhgOovKTmUxWJSCkmImJ%2bX2nRvefj4Xz9mYKUraqMpYyx0JdXmYWzdhae9jfe3pldvuj72T7O8%2bCokM8w3ya%2bvo8A8OOvo3CUUFWQJeSQ2P09fTMDDQMjbSNTMzsLIyRW5MDSLDwricVCaVJoGph8y8GVvMyMkF6fFIZkgUVB/YnEghUgCDmYQAJFNZHBoNqQm4S6YjHyAz2TR2CgMsh80BGBKS4pIoCXQ2HSFn0uqa2109nkVEhTk%2beGCqqmCFk7yqLpWdV%2bvgEnvJweXKHfdQcrFfXJaXf4h3gH9weEhZZUVMfPzxo3%2bRk5UiqCqpKCtqQZCgE1AAC3MjU2M9IwMtczNDfx8fDpMlgXnfwR%2bgMulxSXFUJpXKotCTYdJT6CwS%2bEqixiMA9EQqPQleQgVQZYAHH6BgVyryEopDh06A1JGpiVABeCckPKixtTMiOtLP39v5%2bTNrA10jqSMPzls9D6CbnX943z3WLzYrs%2bpNLKskr6CQSCYHhQfn8PKoLOaJX47ISkuqqSiqKMsTCMp6uppGhjpgvIWFkZGhtqGeBrw0NzcKCwyUGJ8UllXWJlKTYMIkoy6y0KAj7jISqQzQCmkhUWgJMIjgfSrkipZIPQBAC0Uh05LAeLgyktH6MCBjUB9qZHQor6iYnc718HR95vbcxtZW7eSR2zYW956G2j8M9orMTCnpKe9coGTU1DU01re0%2b4eGcDO5KRlcydO/wKaGV1ZQUVbA43Ha2upQBGhiSwtj0K2rhTc20DIxM7h43loiPTsTLGenJ6dw2SncZE46C4IOKkmgGOYNhQiiaSwShZFEpiZAbKB9YSJRkAih3jNIGEAcZC8pDjYK%2bAlAmJBETKIkxhCjo%2bNi84pKn7k9dXV3vXbTQVla%2bp7j87vPol0CGMSUutpXoobedTavqa2zc3J2oaiikkwnZ%2bXny8mekT5zCo%2bTx6soqqoqaWkRDAy0TZAKGFtbmRroaepoqsJLCJJEchqTm5OemceFQwE7ncVOY1JZZBiUCaQ4WEkUZPhgC5IDCwYowgD34D0sBuI3YETFhMcSoyKiQulMAKPCywQSEaIfFhFa09Dy9LlzYHDA46dPrjs4PfaK9wxPC6GUcsv7%2beMfmge2uCVtA0PDY1PT0/MLWfl5%2bcUlOJy81JmTqjh5NVUlANDUUtOHYWqib2FpAgDmZgaaBJwh%2bo5ERk56Rh6Xm5OWkZsOFYDJCA1KTIyJjgtPJMclUePBTqRfkfAg9scDGJkIliPeI9KRGygFDNDQ8KDwqJC4%2bGiYqvGJseGRIZA6eL%2bqtvGF9wu48fb1eu7p/9A9Ni6lIS6ltqhpamTxn00Dm7kVHRPTUxMzc7MLizWNja1d3SoqigAAk1Qdj4NBBBUAAGOYpFamMIiAQUdLTVNDFfY4iZyCLG5uelp2alZ%2bBuxKIBTiQaLDFhYUHRcBIwgWEmukUymJ1AQisosRESomCToBblBCSlRshI%2bfF6iEIgAeHChgw4aahEUE1dQ3hkaGh4QFwBnkicuzGw986PmvqNkt1XzB9Np/1x9InTcAAADfSURBVLxaKahqFwgW5hYFEzOzBaXF/N5%2bPF5ZWuoUVEBDTZlAUNHWUcciZGVtBsvGxgyaGK%2bioK2lJpFTmJ2WyeFmp2YXZKWksyDroJKWTCYmRPsH%2bsTFR0H0kVaGCkC0SHFx6DaMRIuBRAhqkoRudmC550v34NAAYID8wGyFYQoMgcG%2bLW3tJDrNzcMlOi7K0/vFrQcenNJBFq%2brZXBjaed/yjoWKxr5omXhkmi5Z2iIV1w48GYMIiQnI6mqrKCprqKpideB/dhI19TM0NrG/KytpTUcxC1N4E9VVRT%2bPzbiUw29GeqqAAAAAElFTkSuQmCC' /%3e%3c/svg%3e"},"path":"/authors/justin-yoo/"}]}},{"node":{"title":"애저 펑션과 애저 이벤트그리드간 CloudEvents 형식 이벤트 데이터 주고받기","path":"/posts/2021/01/19/cloudevents-for-azure-eventgrid-via-azure-functions/","image":"https://sa0blogs.blob.core.windows.net/aliencube/2021/01/dealing-cloudevents-with-azure-functions-for-azure-eventgrid-00.png","image_caption":"애저 펑션에서 이벤트 그리드로, 다시 애저 펑션으로 클라우드 이벤트 형식 데이터 이동","description":"이 포스트에서는 애저 펑션의 이벤트그리드 바인딩이 아직 지원하지 않는 CloudEvents 형식의 이벤트 데이터를 다루는 방법에 대해 알아봅니다.","content":"<p><a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>은 자체적으로 <a href=\"https://docs.microsoft.com/ko-kr/azure/event-grid/overview?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 이벤트그리드</a>에 대한 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-bindings-event-grid?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">바인딩 확장 기능</a>을 제공하고 있어서 이벤트그리드로 이벤트 데이터를 아주 손쉽게 주고 받을 수 있습니다. 하지만, 현재 바인딩 확장 기능은 아직 정식으로 <a href=\"https://cloudevents.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CloudEvents</a> 형식을 지원하지 않는데, 그 이유는 <a href=\"https://www.nuget.org/packages/Microsoft.Azure.EventGrid/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">현재 버전의 SDK</a>가 아직 CloudEvents 형식을 지원하지 않기 때문입니다. 아마도 <a href=\"https://www.nuget.org/packages/Azure.Messaging.EventGrid/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">새 버전의 SDK</a>가 GA되는 시점이 되면 애저 펑션 확장 기능에서도 이를 지원하지 않을까 예상하는데요, 따라서, 그 때 까지는 CloudEvents 형식을 사용해서 이벤트그리드에 데이터를 주고 받기 위해서 별도의 작업을 해 줘야 합니다. 이 포스트에서는 그 방법에 대해 간단히 정리해 보도록 하겠습니다.</p>\n<blockquote>\n<p>이 포스트에서는 <a href=\"https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/eventgrid/Azure.Messaging.EventGrid\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.NET SDK</a>를 대상으로 기술합니다. 다른 언어로도 SDK를 지원하고 있으니, 아래 링크를 클릭해서 새 SDK를 확인해 보세요!</p>\n<ul>\n<li><a href=\"https://github.com/Azure/azure-sdk-for-js/tree/master/sdk/eventgrid/eventgrid\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">JavaScript</a></li>\n<li><a href=\"https://github.com/Azure/azure-sdk-for-python/tree/master/sdk/eventgrid/azure-eventgrid\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Python</a></li>\n<li><a href=\"https://github.com/Azure/azure-sdk-for-java/tree/master/sdk/eventgrid/azure-messaging-eventgrid\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Java</a></li>\n</ul>\n</blockquote>\n<h2 id=\"애저-이벤트그리드-sdk-프리뷰-버전-설치\"><a href=\"#%EC%95%A0%EC%A0%80-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EA%B7%B8%EB%A6%AC%EB%93%9C-sdk-%ED%94%84%EB%A6%AC%EB%B7%B0-%EB%B2%84%EC%A0%84-%EC%84%A4%EC%B9%98\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>애저 이벤트그리드 SDK 프리뷰 버전 설치</h2>\n<p>이 글을 쓰는 현재 새 버전의 애저 이벤트그리드 SDK 버전은 <a href=\"https://www.nuget.org/packages/Azure.Messaging.EventGrid/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">4.0.0-beta.4</code></a>로, 아직 프리뷰 상태입니다. 이 프리뷰 버전의 SDK를 사용하면 CloudEvents 형식의 이벤트 데이터를 활용할 수 있죠. 먼저 아래 명령어를 통해 프리뷰 버전의 SDK를 설치합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107311606\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-01-dotnet-add-package-sh\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-shell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-01-dotnet-add-package-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-01-dotnet-add-package-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\">dotnet add package Azure.Messaging.EventGrid --version 4.0.0-beta.4</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470/raw/33d50576a9beb45d73ac1ce6983bf633b9316921/01-dotnet-add-package.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470#file-01-dotnet-add-package-sh\">01-dotnet-add-package.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>이제 본격적으로 이벤트그리드 데이터를 작업해 보도록 하겠습니다!</p>\n<h2 id=\"cloudevents-형식으로-이벤트-데이터-보내기\"><a href=\"#cloudevents-%ED%98%95%EC%8B%9D%EC%9C%BC%EB%A1%9C-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B3%B4%EB%82%B4%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>CloudEvents 형식으로 이벤트 데이터 보내기</h2>\n<p>애저 CLI에서 이벤트그리드 명령어를 사용하기 위해서는 먼저 아래와 같이 <a href=\"https://docs.microsoft.com/ko-kr/cli/azure/azure-cli-extensions-list?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">확장 기능</a>을 설치해야 합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107311606\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-02-az-extension-add-sh\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-shell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-02-az-extension-add-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-02-az-extension-add-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\">az extension add -n eventgrid</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470/raw/33d50576a9beb45d73ac1ce6983bf633b9316921/02-az-extension-add.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470#file-02-az-extension-add-sh\">02-az-extension-add.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>확장 기능을 설치하고 나면, 아래 <a href=\"https://docs.microsoft.com/ko-kr/cli/azure/what-is-azure-cli?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 CLI</a> 명령어를 통해 이벤트그리드 커스텀 토픽의 엔드포인트를 확인합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107311606\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-03-get-endpoint-sh\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-shell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-03-get-endpoint-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-03-get-endpoint-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\">endpoint=<span class=\"pl-s\"><span class=\"pl-pds\">$(</span>az eventgrid topic show \\</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-03-get-endpoint-sh-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-03-get-endpoint-sh-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-s\">    -g <span class=\"pl-k\">&lt;</span>resource_group_name<span class=\"pl-k\">&gt;</span> \\</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-03-get-endpoint-sh-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-03-get-endpoint-sh-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-s\">    -n <span class=\"pl-k\">&lt;</span>eventgrid_topic_name<span class=\"pl-k\">&gt;</span> \\</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-03-get-endpoint-sh-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-03-get-endpoint-sh-LC4\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-s\">    --query <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>endpoint<span class=\"pl-pds\">&quot;</span></span> -o tsv<span class=\"pl-pds\">)</span></span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470/raw/33d50576a9beb45d73ac1ce6983bf633b9316921/03-get-endpoint.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470#file-03-get-endpoint-sh\">03-get-endpoint.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>그리고, 접속 키는 아래 명령어를 이용해서 확인합니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107311606\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-04-get-access-key-sh\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-shell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-04-get-access-key-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-04-get-access-key-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\">id=<span class=\"pl-s\"><span class=\"pl-pds\">$(</span>az eventgrid topic show \\</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-04-get-access-key-sh-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-04-get-access-key-sh-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-s\">    -g <span class=\"pl-k\">&lt;</span>resource_group_name<span class=\"pl-k\">&gt;</span> \\</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-04-get-access-key-sh-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-04-get-access-key-sh-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-s\">    -n <span class=\"pl-k\">&lt;</span>eventgrid_topic_name<span class=\"pl-k\">&gt;</span> \\</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-04-get-access-key-sh-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-04-get-access-key-sh-LC4\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-s\">    --query <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>id<span class=\"pl-pds\">&quot;</span></span> -o tsv<span class=\"pl-pds\">)</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-04-get-access-key-sh-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-04-get-access-key-sh-LC5\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-04-get-access-key-sh-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-04-get-access-key-sh-LC6\" class=\"blob-code blob-code-inner js-file-line\">key=<span class=\"pl-s\"><span class=\"pl-pds\">$(</span>az rest \\</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-04-get-access-key-sh-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-04-get-access-key-sh-LC7\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-s\">    -m POST \\</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-04-get-access-key-sh-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-04-get-access-key-sh-LC8\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-s\">    -u <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>https://management.azure.com<span class=\"pl-smi\">$id</span>/listKeys?api-version=2020-06-01<span class=\"pl-pds\">&quot;</span></span> \\</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-04-get-access-key-sh-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-04-get-access-key-sh-LC9\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-s\">    --query <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>key1<span class=\"pl-pds\">&quot;</span></span> -o tsv<span class=\"pl-pds\">)</span></span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470/raw/33d50576a9beb45d73ac1ce6983bf633b9316921/04-get-access-key.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470#file-04-get-access-key-sh\">04-get-access-key.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>위에서 확인한 엔드포인트와 접속 키를 이용해서 아래와 같이 애저 펑션 안에 이벤트그리드용 데이터 퍼블리셔 인스턴스를 만듭니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107311606\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-05-create-publisher-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-05-create-publisher-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-05-create-publisher-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> <span class=\"pl-en\">topicEndpoint</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">Uri</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>&lt;endpoint&gt;<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-create-publisher-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-05-create-publisher-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> <span class=\"pl-en\">credential</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">AzureKeyCredential</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>&lt;key&gt;<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-05-create-publisher-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-05-create-publisher-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> <span class=\"pl-en\">publisher</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">EventGridPublisherClient</span>(<span class=\"pl-smi\">topicEndpoint</span>, <span class=\"pl-smi\">credential</span>);</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470/raw/33d50576a9beb45d73ac1ce6983bf633b9316921/05-create-publisher.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470#file-05-create-publisher-cs\">05-create-publisher.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>CloudEvents 형식의 데이터를 보내기 위해서는 이벤트 데이터 뿐만 아니라 몇 가지 다른 메타 데이터 정보가 필요합니다.</p>\n<ul>\n<li><code class=\"language-text\">source</code>: 이벤트 발생자. 보통 URL 형식으로 작성합니다.</li>\n<li><code class=\"language-text\">type</code>: 이벤트 타입. 이 값을 이용해서 이벤트를 구분합니다. 형식은 <code class=\"language-text\">com.example.someevent</code>와 비슷한 형태가 됩니다.</li>\n<li><code class=\"language-text\">datacontenttype</code>: 항상 <code class=\"language-text\">application/cloudevents+json</code> 값으로 지정해 주면 됩니다.</li>\n</ul>\n<p>이외에도 다른 메타 데이터 정보가 필요하지만, 나머지는 SDK에서 자동으로 처리해주니 여기서는 크게 상관하지 않습니다.</p>\n<blockquote>\n<p>CloudEvents 데이터 형식에 대한 내용을 좀 더 확인하고 싶다면, <a href=\"https://github.com/cloudevents/spec/blob/v1.0/json-format.md#23-examples\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">이 링크</a>를 읽어보세요!</p>\n</blockquote>\n<p>위 메타 데이터 정보를 이용해 아래와 같이 CloudEvents 데이터를 작성한 후 이벤트그리드로 보내면 됩니다.</p>\n<div class=\"gist-embed\">\n    <div id=\"gist107311606\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-06-publish-event-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-06-publish-event-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-06-publish-event-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> <span class=\"pl-en\">source</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>&lt;source&gt;<span class=\"pl-pds\">&quot;</span></span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-publish-event-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-06-publish-event-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> <span class=\"pl-en\">type</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>&lt;type&gt;<span class=\"pl-pds\">&quot;</span></span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-publish-event-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-06-publish-event-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> <span class=\"pl-en\">dataContentType</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>application/cloudevents+json<span class=\"pl-pds\">&quot;</span></span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-publish-event-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-06-publish-event-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-publish-event-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-06-publish-event-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> <span class=\"pl-en\">data</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">MyData</span>() { <span class=\"pl-smi\">Hello</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>World<span class=\"pl-pds\">&quot;</span></span> };</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-publish-event-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-06-publish-event-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-publish-event-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-06-publish-event-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> <span class=\"pl-en\">@event</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">CloudEvent</span>(<span class=\"pl-smi\">source</span>, <span class=\"pl-smi\">type</span>, <span class=\"pl-smi\">data</span>, <span class=\"pl-smi\">dataContentType</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-publish-event-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-06-publish-event-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> <span class=\"pl-en\">events</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">List</span>&lt;<span class=\"pl-k\">CloudEvent</span>&gt;() { <span class=\"pl-smi\">@event</span> };</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-publish-event-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-06-publish-event-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-06-publish-event-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-06-publish-event-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">await</span> <span class=\"pl-smi\">publisher</span>.<span class=\"pl-en\">SendEventsAsync</span>(<span class=\"pl-smi\">events</span>).<span class=\"pl-en\">ConfigureAwait</span>(<span class=\"pl-c1\">false</span>);</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470/raw/33d50576a9beb45d73ac1ce6983bf633b9316921/06-publish-event.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470#file-06-publish-event-cs\">06-publish-event.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</div>\n<p>위의 방법을 통해 CloudEvents 형식의 이벤트 데이터를 이벤트그리드 커스텀 토픽으로 보낼 수 있게 됐습니다.</p>\n<h2 id=\"cloudevents-형식으로-이벤트-데이터-받기\"><a href=\"#cloudevents-%ED%98%95%EC%8B%9D%EC%9C%BC%EB%A1%9C-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B0%9B%EA%B8%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>CloudEvents 형식으로 이벤트 데이터 받기</h2>\n<p>앞서 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>에서는 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-bindings-event-grid?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">이벤트그리드 바인딩 확장 기능의 제약</a>이 있다고 했습니다. 때문에 CloudEvents 형식의 데이터를 받아 처리하기 위해서는 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-bindings-http-webhook-trigger?tabs=csharp&#x26;WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">HTTP 트리거</a>를 이용해야 하는데요, 이 트리거는 두 가지 요청을 동시에 처리해야 합니다.</p>\n<ul>\n<li>이벤트 핸들러 엔드포인트 검증 요청</li>\n<li>이벤트 데이터 처리</li>\n</ul>\n<h3 id=\"이벤트-핸들러-엔드포인트-검증-요청\"><a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%ED%95%B8%EB%93%A4%EB%9F%AC-%EC%97%94%EB%93%9C%ED%8F%AC%EC%9D%B8%ED%8A%B8-%EA%B2%80%EC%A6%9D-%EC%9A%94%EC%B2%AD\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>이벤트 핸들러 엔드포인트 검증 요청</h3>\n<p><a href=\"https://github.com/cloudevents/spec/blob/v1.0/http-webhook.md#4-abuse-protection\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CloudEvents의 웹훅 스펙</a>에 따르면 검증 요청은 <code class=\"language-text\">OPTIONS</code> 메소드를 이용하고 요청 헤더에 반드시 <code class=\"language-text\">WebHook-Request-Origin</code>를 포함합니다 (line #8). 따라서 이 검증 요청에 응답하기 위해서는 이 요청 헤더 값을 응답 헤더의 <code class=\"language-text\">WebHook-Allowed-Origin</code> 값에 실어 보내야 합니다 (line #9).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist107311606\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-07-validate-request-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-07-validate-request-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-07-validate-request-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>HttpTrigger<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-07-validate-request-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">Run</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-07-validate-request-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Anonymous</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>POST<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>OPTIONS<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>handler<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-07-validate-request-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-07-validate-request-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-07-validate-request-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">if</span> (<span class=\"pl-smi\">HttpMethods</span>.<span class=\"pl-en\">IsOptions</span>(<span class=\"pl-smi\">req</span>.<span class=\"pl-smi\">Method</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-07-validate-request-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-07-validate-request-cs-LC8\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-k\">string</span> <span class=\"pl-en\">header</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">req</span>.<span class=\"pl-smi\">Headers</span>[<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>WebHook-Request-Origin<span class=\"pl-pds\">\"</span></span>];</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-07-validate-request-cs-LC9\" class=\"blob-code blob-code-inner js-file-line highlighted\">        <span class=\"pl-smi\">req</span>.<span class=\"pl-smi\">HttpContext</span>.<span class=\"pl-smi\">Response</span>.<span class=\"pl-smi\">Headers</span>.<span class=\"pl-en\">Add</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Webhook-Allowed-Origin<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">header</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-07-validate-request-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-07-validate-request-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">return</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">OkResult</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-07-validate-request-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-07-validate-request-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-07-validate-request-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">    ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-07-validate-request-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-07-validate-request-cs-LC15\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470/raw/33d50576a9beb45d73ac1ce6983bf633b9316921/07-validate-request.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470#file-07-validate-request-cs\">07-validate-request.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<h3 id=\"이벤트-데이터-처리\"><a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B2%98%EB%A6%AC\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>이벤트 데이터 처리</h3>\n<p>위와 같이 이벤트 핸들러로서 애저 펑션 엔드포인트 검증에 성공했다면, 애저 이벤트그리드는 앞으로 이벤트 데이터를 계속해서 동일한 엔드포인트로 <code class=\"language-text\">POST</code> 메소드를 이용해 보냅니다. 이 때, CloudEvents 이벤트 데이터 전체를 사용하고 싶다면 아래 코드의 <code class=\"language-text\">@event</code> 인스턴스를 이용하면 되고 (line #18), <code class=\"language-text\">data</code> 부분만 사용하려면 아래 코드와 같이 비직렬화해서 사용합니다 (line #19).</p>\n<div class=\"gist-embed\">\n    <html><head></head><body><div id=\"gist107311606\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-08-handle-event-cs\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n      <tbody><tr>\n        <td id=\"file-08-handle-event-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-08-handle-event-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\">[<span class=\"pl-k\">FunctionName</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>HttpTrigger<span class=\"pl-pds\">\"</span></span>)]</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-08-handle-event-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">async</span> <span class=\"pl-k\">Task</span>&lt;<span class=\"pl-k\">IActionResult</span>&gt; <span class=\"pl-en\">Run</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-08-handle-event-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-k\">HttpTrigger</span>(<span class=\"pl-smi\">AuthorizationLevel</span>.<span class=\"pl-smi\">Anonymous</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>POST<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>OPTIONS<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-en\">Route</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>handler<span class=\"pl-pds\">\"</span></span>)] <span class=\"pl-k\">HttpRequest</span> <span class=\"pl-en\">req</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-08-handle-event-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">ILogger</span> <span class=\"pl-en\">log</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-08-handle-event-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-08-handle-event-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">if</span> (<span class=\"pl-smi\">HttpMethods</span>.<span class=\"pl-en\">IsOptions</span>(<span class=\"pl-smi\">req</span>.<span class=\"pl-smi\">Method</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-08-handle-event-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-08-handle-event-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">        ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-08-handle-event-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-08-handle-event-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-08-handle-event-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">using</span> (<span class=\"pl-k\">var</span> <span class=\"pl-en\">reader</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">StreamReader</span>(<span class=\"pl-smi\">req</span>.<span class=\"pl-smi\">Body</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-08-handle-event-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-08-handle-event-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">payload</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">await</span> <span class=\"pl-smi\">reader</span>.<span class=\"pl-en\">ReadToEndAsync</span>().<span class=\"pl-en\">ConfigureAwait</span>(<span class=\"pl-c1\">false</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-08-handle-event-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">var</span> <span class=\"pl-en\">events</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">CloudEvent</span>.<span class=\"pl-en\">Parse</span>(<span class=\"pl-smi\">payload</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-08-handle-event-cs-LC15\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-08-handle-event-cs-LC16\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">foreach</span> (<span class=\"pl-k\">var</span> <span class=\"pl-en\">@event</span> <span class=\"pl-k\">in</span> <span class=\"pl-smi\">events</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-08-handle-event-cs-LC17\" class=\"blob-code blob-code-inner js-file-line\">        {</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-08-handle-event-cs-LC18\" class=\"blob-code blob-code-inner js-file-line highlighted\">            <span class=\"pl-k\">var</span> <span class=\"pl-en\">timestamp</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">@event</span>.<span class=\"pl-smi\">Time</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-08-handle-event-cs-LC19\" class=\"blob-code blob-code-inner js-file-line highlighted\">            <span class=\"pl-k\">var</span> <span class=\"pl-en\">data</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">await</span> <span class=\"pl-smi\">@event</span>.<span class=\"pl-en\">GetDataAsync</span>&lt;<span class=\"pl-k\">MyData</span>&gt;().<span class=\"pl-en\">ConfigureAwait</span>(<span class=\"pl-c1\">false</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-08-handle-event-cs-LC20\" class=\"blob-code blob-code-inner js-file-line\">            ...</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-08-handle-event-cs-LC21\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-08-handle-event-cs-LC22\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-08-handle-event-cs-LC23\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-08-handle-event-cs-LC24\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">return</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">OkResult</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-08-handle-event-cs-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-08-handle-event-cs-LC25\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470/raw/33d50576a9beb45d73ac1ce6983bf633b9316921/08-handle-event.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/justinyoo/8282de7244bccca562cd508e64d89470#file-08-handle-event-cs\">08-handle-event.cs</a>\n        hosted with ❤ by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html>\n</div>\n<p>위와 같이 CloudEvents 형식의 이벤트 데이터를 이벤트 토픽에서 애저 펑션으로 받아 처리할 수 있게 됐습니다.</p>\n<hr>\n<p>지금까지 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-overview?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 펑션</a>에서 <a href=\"https://docs.microsoft.com/ko-kr/azure/event-grid/overview?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">애저 이벤트그리드</a>로 <a href=\"https://cloudevents.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CloudEvents</a> 형식의 이벤트 데이터를 보내고 받는 방법에 대해 알아 보았습니다. 이 방법은 포스트 안에서 계속 언급했다시피, 현재 <a href=\"https://docs.microsoft.com/ko-kr/azure/azure-functions/functions-bindings-event-grid?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">바인딩 확장 기능</a>은 아직 CloudEvents 형식을 지원하지 않기 때문에, 일종의 임시방편으로 사용하는 방법입니다. 조만간 새 버전의 확장 기능이 릴리즈 되기를 기대합니다.</p>\n<h2 id=\"더-궁금하다면\"><a href=\"#%EB%8D%94-%EA%B6%81%EA%B8%88%ED%95%98%EB%8B%A4%EB%A9%B4\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>더 궁금하다면...</h2>\n<ul>\n<li>애저 클라우드에 관심이 있으신가요? ➡️ <a href=\"https://azure.microsoft.com/ko-kr/free/?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">무료 애저 계정 생성하기</a></li>\n<li>애저 클라우드 무료 온라인 강의 코스를 들어 보세요! ➡️ <a href=\"https://docs.microsoft.com/ko-kr/learn/?WT.mc_id=dotnet-12565-juyoo&#x26;ocid=AID3027813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Learn</a></li>\n<li>마이크로소프트 개발자 유튜브 채널 ➡️ <a href=\"https://www.youtube.com/channel/UCdgR-b2t7Byu_UGrHnu-T0g\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Microsoft Developer Korea</a></li>\n</ul>\n","humanTime":"19 January 2021","datetime":"Tue Jan 19 2021 12:00:00 UTC+00:00","canonical_url":"https://blog.aliencube.org/ko/2021/01/13/dealing-cloudevents-with-azure-functions-for-azure-eventgrid/","timeToRead":8,"tags":[{"id":"azure-functions","title":"azure-functions","path":"/tags/azure-functions/"},{"id":"azure-eventgrid","title":"azure-eventgrid","path":"/tags/azure-eventgrid/"},{"id":"cloudevents","title":"cloudevents","path":"/tags/cloudevents/"},{"id":"azure-sdk","title":"azure-sdk","path":"/tags/azure-sdk/"}],"category":{"id":"Azure","title":"Azure","path":"/categories/azure/","belongsTo":{"totalCount":11,"edges":[{"node":{"title":"애저 Bicep 되짚어보기","path":"/posts/2021/04/27/bicep-refreshed/"}},{"node":{"title":"애저 펑션 프록시 기능을 이용한 Open API 확장 기능 하위 호환성 유지하기","path":"/posts/2021/03/16/openapi-extension-to-support-azure-functions-v1/"}},{"node":{"title":"애저 펑션에 Open API 활성화 시키기","path":"/posts/2021/03/09/enabling-openapi-on-azure-functions/"}},{"node":{"title":"이벤트 기반 애저 키 저장소 시크릿 로테이션 관리","path":"/posts/2021/03/02/event-driven-keyvault-secrets-rotation-management/"}}]}},"author":[{"id":"justin-yoo","name":"유저스틴","image":{"type":"image","mimeType":"image/png","src":"/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png","size":{"width":500,"height":500},"sizes":"(max-width: 500px) 100vw, 500px","srcset":["/developerkorea/assets/static/justin-yoo.0d7bb5f.d8fcc9687c70820fe6d9bd3801483455.png 500w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 500 500' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-6a0325b746fa0b3948747e4a6f689de9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-6a0325b746fa0b3948747e4a6f689de9)' width='500' height='500' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC%2baJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVRo3pWZd1RT67b2ueccy7YgHQKE0HsvYkdFsaFYEKUI0nsnlPSEhBI6offeISgdpPeQ0JFi3%2bfse84Yt/x3v7%2b/udaCiLq3d9893rH2Soz4/J75zPm%2bK0jMz68sLq4tLa0LhVvLy9srK7tra%2b/Ea339/fr6h0Pr459Za2sfflyrq%2b/R9W5lZW95eVck2hGJtoWwlt4Kl7YEgk3B4oZgYWNxfm1hfm1%2bbmVudnl2RjgzvTQ9JZiaXJwYnx8fmxsbnR59M/VmZHJ4aHxocGyg/43E7KxoYWFtEf6yYFMofLu8vLO6undIPQKwsYGtTxsbH9H1CVugFbv%2bEcNhmAOA9ysr%2bwzLwm0RLATg7ZJga2lxEwVYX5j7HYDJiYWJcQCYAYCR4QkAGBwYRQBmZoTz86sLC%2bvAAADgCgBg0lHR2FWs%2b8NhgMMkf6YO3wCIdpdFCAD8o0tLW8hCAUAJCrA6PwcAIgCYmRYDzI%2bNzmIVAIb9CgDAHHx6HgGAnwIAWIpQ48WW/47oP2L4Qes7uPnxTQRAiKYIAxBsIgCLKMB%2bhEQ/VAADmP4mQtPTwtnZFWCAvwk/CH4cBnBY9%2bbmZ/T6M4ADie/gw7u7v%2b3t/fv29j/evfsn3Ozs/AZgIF0kgujvIgDLSAWQNhAiPXAAsLEIFYAegArMrs7NrmAV%2bBZgDgP4WoHx8YWpKYRhfn4N2kBcASz0IBpdn7HrH6kHcTs7/4C1t/fPmZnVzs7%2bxERaRHhMZERscFB4R0cvqAS58Ke7u/8OACLE%2b10hLAAQHDQx0gAYwCoCMLPyuxWANvimAqOjc5OTSwAAFTgE8B6z/xDA55%2bE5/Pn/%2bofmLK/ftPN1cPh5m0pyVOy0lLysjLSZ87ISksrKSiYGJmctbF95uKal1O4urK3ufVFKNwRLu3nRyhAABaRCiANcNDEfxQhAIA%2bPgAYn1iYmRGB/Yd7AG2Aj/%2bremwKra19rK5uuXL56i/HjkqePIFIl5ORg/9JSkqePi156uSpEyeP/O1vf/nLv0lISMhISz9%2b5NzSzN/Z/vvmxuclGEECFGBxc2FxHRtBUAHU/p/1wFcArInF6rExinUwqv5/wXi3908ul6evoycvI62moqyGV1FTVVFSkMMpKSgpIjVQVJBXUkTupM5ISkvB5fQvx49rENSfI9UogmqA90uo/Wj7rs8jHbyKzlCsAZamJg/vA1gFJr%2bOUdjFBIKv3qObwOH8fDxg%2bHx4YfZDpqOjE1SUFPE4JXW8ihZBTVdLw0BHSwOvoqmmqqmmoq6KwysrAg9ccYoKCvKysIDqxC/Hjx7566kTv2SkZ29ufATFSAMsiNVDBZZnp0UzU1/tB/UHANPYPrBfAWz/Ent/aIB%2bB/ANA0wbaMem5ld6unog10BXRx90q6nqa6pdtja%2bYWty46zR3QtmD%2b0s7cx17cx1zhtpauNxyggJDhjOSJ6CjP1y7Mjtm7dGhqfWoA6Lm0h%2b9gFW5iA/06LpKaE4PBjAQQMgIwgq0N83IoGdIA7UY/vux9%2brwKfD9m9tfREt7121u66BV9XX1jLS0bA21HK5aUv2f5gW4VJAdK2keFWRX1QnuWUF3MsLvMvxvuVlb37ZmKBPUFaSl4UmgTqcPnnizOmTgESMjYdBhPTu/BqqHhpgeWZaiNovENuPqv86Q/cjBOoPjH9/kOyPh8z%2bPjzIgui/%2b1dMTCJeWUlbg2Brqh/j6sAjutaz/GZqSXM1CbPlsbOlMeO80MEMPz7dvTXRpSXBpSz4Dv2JrccVAzMNJVVFOXlZGFGAcPzUyROmJiaTE4uwCczNYvavzCD2L00j6vfTP4ocImZGhsX5QdQjFTh0avi6bf1kwQd2d36LjCTiVZS11NVNdQgcP8e%2bzOCxkti5OspaR8pmV6qonjJTGD6ZHzIMALTnnTRXPtWtOfZR4ctrDCcrzwtaVurymorS8lKSp0%2bdgAUDi0ljra2%2bm5leRuyfXp6ZQgCmJgTi/GD2Q96Gh77ajwAcHNSwufn55wDQuLC58rtHFOTkVJUUYeyEPrwynBW0WJe4wU/b7c//MFLyYaRs61WWsJY0XRA%2bnhPYz3nZx3k5kObbRXWrCXVkP7SKvKb3yAx3QUNWT0laRvIk/Hf0yN9winItzZ2w34F0dP5A%2bpfE9ovH//DQ1y0M1Pf1DiEAm5sf0Ov%2bYeEnAHBY%2bPT5P5nMdGnJU1oa6udNdcuIz0YLI9Y6OO%2bGC98PFX8YKf80Vv32dZ6wjjpdHDmRHzKWGzyaEzTE9eNTXGtD7qU8sk64Zex7XuO%2bsdI1HUVteaQIUlJSsEU43b%2b/ItqZnoThA0v43fA5sH9c3L6wenv2AT4ebFuff74QgE//ERwcKS8jpaul%2beT62epEt4mS%2bJ3%2bvHeDRR9Hyj6%2bqfgwUrnawp3ixUzyIt9kBY7lBI3nhw2kercSHxd5XmU6msc7GEZc03M2V7ljqHSOIIOTkTxzRvKvf/k3C3Mz5PwzvYzaD%2bERHLYf1I8MTw4Nfk1/X%2b9wz%2btBiR%2bPDD9JP3wYpqez83MAMDMy8HS0q6F6CZtT3o%2bUQ3I%2bjVa8Gyxea09bqqdPFccOpgcNpAUOZwSM5YWOZAZ0JroUelxhOprF2utHXtd/bom/a6h4UUNWXf6MtLTU8WPHYK/jd/QIFjYhPOL2PQgPZv/k4IA4PMNg/%2btXAxIHTypfw/Pd/WGAt29/nV/YsLSwUlaUP29t4XHnYh3Lf42fvdtfvDdUujtQsMHPWO/K3uDnLbekjuaE93P8Bzg%2bQ9yACV5kf6pvbdh9jpN1zHV9v4uartZqd4wUoRM0FaRkzpw%2bdeokHDXYTM7K8g54P4XYv392EKsH%2bwf69%2b0H9WIA8Vn/o/jkfHgd7mA4J3e/GlFVweNVcBesLV7cvdyREbHGz1zryhI0ssfLSXMNKW%2bHanfH27aH67f6yuer6RO8qMki4mwlZao0qZvlVxbygP7knNcFbSdTFQd9pfPqMuoKUrCxnT55EtrA7bkbbKkT44tTB/kZfbMPMDQ48aP9r7r7JX58WPmO4TDA%2b/f/amrqxquqahLULE0MA584TFSQ1zvT5moZVWTf3ES/FKI/O9q3hBHekh4z15q3O1Inaslcak6fr%2bc0swJpnne875xzuWjkaK11SRd3RVvhIkFGTfY0jNMzp08DwDNnF9jREO%2bR9kUADoVn/Dv1sLr5fRJ/5mlLfPiB/au%2boVNZSRFmqK6aCsvHca2VtdTArE3yzIv2KGVF8mjBmfFeVazA5rTQN1WsD%2bPNi3XcocyI/uzItID7L25anTfSstAlWOuqWGspWRIULqnL6cufQrZkSQTgsdNDOFBg4Tk8fLDw9Pe9wdRD72L287t6v%2bmBny8YQfB41dk5gFeB85vSbRuDfo7XWkPSXEkMn%2b03Uc0WdBSI2nNmyknD2RHCZs7eUPHOQOlsOb2N%2bKw%2b5klxqGNJ6P02lncT1Yvz4prbeW1rgqytuoINTlLu9C8AAKftB46OS4INUC9u34OdCwP4JjxgPwJwcPj59Geeerff/n1yUmRqbKKqpEBztx9M8elIDapPi%2bFRgkqZoU3ZCUW0QLKXY%2bT9i0muN3lEj4lyyigvttDbnnjLNOK2RaqvYz7RnRv4MOG%2bjaMZ/qy6rA1e9gpBVl/u1LGjR6ECZ62t4IELdgDx9MR6F0s/NjcPq%2b/q7JEQnz3/DABMoZmZFUsrG2sr67iIKJdHD8lkMinUtZbhPt5A6SwnpjKC7lw/63JOn%2bV8sY7sXptHD/d/qa0ko6Uk8%2bCKsf8TO1tTQx2crIOZxh1jVRsNBRtdvJmmsh5OTk9LE4dT1lQndHW8hscAkH5gP5b%2b0R%2b9B/WdHa//DwBooT4vi3Zi3V1unLPKjg%2bK9XMtzM/IjXtcS3rUkh3UWhjdUUSLe37L/5Jh2rPLizXxbEq03w3bR2d1jLXwvi5XWZHOSe73Aq%2bbudho2mvLPjHHXdZSvH/HQVlV%2bemjx1cv2cXFJmC77%2bHhM9A/hs1NsB9T381H1MPqaH%2bFHeY%2b/lmAzS%2bby9vtRN%2bYl8/aqd4zuaEtueT6jLDenMCBwoiZGnIfN6wm4nGe142BrJCewthAt3uThbF1sU/PWxi%2beHCH/sIh2%2btGuutl8j3zoKu6z6zwDgbKMaFBRjrqevD0Iy/d0dwBz2Lf2d/fN9rbsx8eTD2/C9S/7ux41dHevQ8gXoe/4fkRYB15Evj8piCd4vu8Ls59Ni%2b8IyOmkB6w1Zu68TpjujC2j%2bU7xA2eLYl735PZW5CYHeP%2b6wivIc7ZUlP5qZV26mObQp8bPG/7TNdL6c5nI67pP7HWJYYF2hmoEc6ceHDdbnpiYWx0Htt6xer7ekd6Xg%2bJxw6WHPC%2bva27rZUvgX0B%2bLvr9763%2brCx/dvqYF9ugDMv6NFcQbSwMaWCFd5dQBR05k1Xs0aLk0Z48T2ZkV1ZUTBS5%2bqZv46WvKJ5XNaQdzDC5b%2b8Wh/u1BDq1BjxsMTnZuxNk9D7l72fPzqLl9eSOc2IjV0UbMKR880I1rvIzgWjE7P/sHrM%2b/Y2fmtLl4T4S8yfYHzzcvPXLdHGQk16M8V3pjBmqzP9w0jNSHVWRy61jh1ZQfKrogZUkXzqGMHTVWQo1peJqvGccD9bdQcDpYcWmmF3banP7CnOVxMeX/G/ddb5hu0lXeXrBoSzSlLF6dy5%2bfU3w1Ni%2byH9qP374QGAw%2brbWrtamjskfvwG8%2bckG3AmXdnbbM4dSQ%2bf4EWvNjHfD5X818rgfy4Pfhqq3mhOncgMmcqJ2ONnrzeytruz/jHTNF%2baFH/DmHzP4oUZ/pmJckOSVx3Rg%2bd9l/LA9omZqp2GrJ2ump2mcldzx9SUCIn%2b/sFhP/2vX%2b3bjyUH1ENywPvWls7mpvb/A8Chbz8/rtRnD6WFjOVHCuuS3nZnfh5r%2bm2h7%2bObhn6aT4nndVFz5l5vycehmo/Ddf8SdK%2b1pFDvWXrZaDjpyvvZELrInvNlpCGWT5GnvbsV4SJB9rK2spOlwfDA6PjowuHe7et9A%2bnHJg8WHsg9mpxOTH1TY5sE9oXrjwx/TPJhbePLRl/LXAV5gBu4WB632sx611v4abxpoYJR7HFtror%2bZaJxg18yVZM2Us4Z4hGro12czVWvass4GePCLuvme9j3p4b00l%2bmPbZ5ZIw7T5C5gJcJcLwBp%2biDU%2bcEGh5Qj9iPqT/oWsR4SA6mvqG%2bFQDe/QjwY0EO7j%2bsw83W3zdHh%2baLk7rZvnOlUYtVCauN9M2u3PqopwO5sWs9JaKuomV%2b0UIHb6YxvSMlqCzejeNxJdHJOuquBZxDo29bcN2v8Ske7IeWt3TlzqvL2SidDna6PTUjGtrvXSw8I69fDXXzB7DwYDMHNR5R39jQ1tjQWl/XLCH%2bvYN4/QQGWavv1ze/rM4uzZcyu5kvp4oiFmsThXXk2UpySfC9ifqUxbac7aGa3ZH6vdHmrd6q2VLmeD7pFellzvOrjEfnwm4YBdobh9obt5FcYZje0pO3xUvbG2qU5/ImJgSYerAf1IP9r7q/2o/lHrxvakTUN9S3gPq62iaJ1ZX3PzL8iLH6LcPa5hfR%2bFh3sv9YXthSA2WllTFdEtdO9x4sSqhJcO/NS1xqylmozVqsyZkvy3ydFMJ7cYf51M7rnO49feW4u9apntd70oKyXtg56MlbKhxnxMbMzW8MDkwM7u%2b7o2h4EPu7OvftR9V3HqhvxdTX1jRKLKO/bsB%2bDfFHACvwzg91WNv8e28RG556RY2MxbqkmZLY0fwoflpgpudtXtSLjaHq91NNnwT8X9dHREM19Rkx6ZHPbxjinxhplAY4tbF8BnMiom%2bZ2evKnsefqS6pmJgUDgyg4enHehexn9/V39mB2I%2bph/B8p76muv4bABC6jF7FDMh19QP2R9/%2bsujd5vZvo%2b1Nrznewkb6YiNtqoI4xosYK4pZaUvf7Sldayna6ajba2neaa5dyE9rDvAkXzIPO6eX5nyp2Mehg/GyPObJMxu1W/pyjrYmQ4OTI8MzaO%2bOH/Tuvv1o7/J/X31VfXVFrYRoeW//dz6H1o8F%2ba4yq2uA9GFhWtiZGjZZEiNsZszUJE1VJMw3MDb4Oe8GS36dbv401rbdXjOfzx5ixbSHv8h8coX2wCbH7UqR982i4HvhDiZPrPC2uON0InFmdnWgH%2bvd/fSjvYvYj02e/fCA%2btoWkF5b3QDqqyrrKstrJITLe8sog%2bhgrfwQqh95AHJr69fVjS81GQw%2bx3u8OHqsMHKiLH6xhb0GAAMlX8Zq/zHXudVfMVqe3JES2ckIqAx9WOp/p9TXIe/ldfLjs/dMcBfVTj%2b9fnF4eHp4eGZgYLL/d%2bx/Db0rtr%2b%2brqWupglTX42qryirlhCKdkUogwhdy8v7FTh83V8H6VpB1H%2bByD54%2bMTK3LQg%2bmkbw4vP8e3JCJptYKzys/cGCt8PFH0cqXo/WLfcWjjGI/fS/FojHtcG3eF5XeU8PedsTbAhSJvhTl%2b2tenpeTM0NN3fB%2bqhd5HRCenv6uzraO9ta%2b3%2bRn1t8773FbWgvry0qqykAgVA1zKKAQURruyBbgTmW4BlrETLexCh2dmVG/Y3ZGXkFHCqNJ/7dWSPGrL764zAwYLI5U7udh9vr7/gLT9rvS1P0Jg9nBUDB7hKv1sFL67QH1gEXtU/rylnhpe10cQdQb9KmZwU9va8QY894t7txUYnFh6IPqq%2bEYw/pL6ypKhcYkm0u4QCLGG/dTtEAnKxdO1f0QUf23r797KyKmVlnKKCkqqmXmtJ7nB2cEnss8pE1%2bZkn9HyxLWevPVXucL2rPnGzJm6jO7U8MrwJ/neNxMf2Phc0r5piDPFy1kR5G0I8vAY%2bfTx4/EJwevXbzD7QT1qfw9qfxe2Z4H9WNd%2bp76ooFRCINyBtQTrAGB/YQwojHihb%2b6urH2sb2q5c/c2/PO3HrrPvxlfqiGOlhBrSe7FUc5l8c/7CuNE/Jz51qyxShao56eGVsW4MFyv%2btub3DHDm6nJm%2bDlz6nJWCifgZ%2bgr6MFWe/rmxCHB%2bxvb3vd2oLkRxyemqoGLPegvrS4AlNfyCvaBxAzLB2UYgllQBoDfYl1CLyzBACr70sqKtMyODpa6m4BpLmFvaUG2tuerLlack96QE3C8/yIx/Usv56COH56UBvDp4Xuw3S76nPD/JaFlrkGzgyvYIU8y0ub4s787chRGWnJnKw8aGXwHnoXDc%2b%2b/U2NHVh4atDwVJbXHva%2bkFfMyyuQWFzaxtQLDi1QLzioydIBAKIefbm8%2bqGqpp6dlkymJDx44t00sDPbUfm2O3XzVdZcDXk4L7yF9iI32JHtfYv64maCm33A3bN3bXQvG6nbaKlYayhZ4eUuqsteVz9jpKogI6984pdjQYFBsAmAbnTywOh83dLc3dyE2d9aW9NUXVVfWYHMHEx9cWFZIa8E1Ofl5EsIAABdGMl3GN/VBAXbXl3/1NDcwU5lpnA54REhYaS81wMr4yXxG/xUUSt7pipxKCekg%2bFZFfckw%2b9WjNNZ14t6T85qO5/VvmeOv6Apf5Ygd01b3o4gaaypYWxpd/z4sWvX7MDsEShCZ39bK%2by7oJ6P2t%2bGqm%2borKirKK8pQ8ODqS/IL8rP5eVm50kIBG/FANgS/B6JEK0J/ClSB%2bFOUWlRKpedmc3lpLOJCTGMnKaGmu7elABBDWmxjjoPm1pp3Agvsj8ruI3qVhTgkOlhR3909sV5rUtaCpc15G7ryl1UlTTS1rn7NOTYseMXLtj6eHsz6GxQ/Kp7CBgaGzrq69qw8FRV1leg4cHUF/FKC/KLMfXZmTkSC4tbC4K3sBYPMSweFGRxaUewf7MNGOD99Nx6bUMjYn86m5udlpaZmsrlUKjxiawsekR4cZhTX7LPeF74dClxpjJppoY0VhjVlx7QFO9S6H/T57LeZW3cdR2F2waK51TP2JhZ%2bsdlHzl23NLSwt3D1cRY38TYIDQkrLK8DlIEGHW1Laj3teVlNaUlmPelqPcQnrycrNysjGyJ%2bcWt%2bQMG8RIc4kFeQmzWPiwKthuauxLIZBqTwmBRGWxaamZKWlZKakZqGjclOib0hZe7m9szTpR3npd9fbgjn%2bbRkxrwKtW/NyOkLy2I53fHyVLbXk/VwUDlngneWunkLfu75MxWANDV1fH197l//66M1CkFeSlrK3M3Nzc6jQXSoYmBoaS4EvG%2bAPO%2bEKKPqc9Iz5SYW9jEGMQLqQa65gXIS6FoTyDcbe/qpzGTw6PDwmPCiYmx6RkpLDYd%2bhhmEZPDgGrExEW99PHy8PKgJDOo5DiKrzPH7Xq%2b17XSkHulYQ%2byvG56nte7a0K4a6J%2bx5jgaK5hJn88LJzELuo5euwEgUAICPILCPS9fPm8vJyUkqKsJkHFyEDX/trV8LCIvJxCmJ4AwMsrQtXzxOq5aVwEAGXYPAwAC24gOaKV9/1DU9ys3KiYqMjYyERKQgKZGBYRkpaRAtKTU5ip3JTkVCY9mUahkzxfenh5v0jmMBgcFjMlmcEgF9Cj6S5XYm4aedioO5mqOJmr3zJSv22icctA5YKmYkXTGDO34%2bjx03iCZkhYUCwxsrKm%2bvad26dOHiOoKRvqaRnp6xgb6dlduRQcEASxKSmqyM1Goo%2bqz%2bKmZaSlpErMzm/AOsBAALAbaNbRcUFeYWlkTBQYT6IkJNESKQwylU4KiwimMEgZ2Wmp3GR2GgsAklMYrBRGVEyEy3NnTiorK5fLSUsGts3t7YGBfleHi/f0ZJ3MVG8b4a/pqt4yVr%2buKf3o6uWhhX%2bGkfN/OSVD0DLy9PYMjQgpKSvhFZecOX1CXl5WU13VUF/LyEAblqGBjv01u7iYuHzUfpCenoqoT2VzJGbm1jEGZC0gVzB%2bfvFtbUMbMSkBfmgCOZ5ETyLREhnJ1GQOHa7xSbGJ5HgWhw51SM1gQ5DoLAokChg8vTxiiFGZOenQ2XQWrbyyrLCs2DcwwFoHb6sqdUFd4ZoO7qa%2bsq3S0Qg//%2bmt/%2bfsFXNaGqdtdPahs3NweGhcfGx334CegY6k5ElVFSVtTTVDPU3AMDHWMzbWMzU1cHrgmMxkZ2fmprIR9SmsZAQAY8CuS8Ldnv5xTjoXAkNMiiNRE6lMMqxEajyNRU5OAQAKmZFEoiZQmSQmh5aRlZqRlQZZojHJEKrI6LCgEH%2bwH%2bpAppJoLJqX70vbc2cv29lZqCufV5W%2bpC5/TlXqmpZMfWNfIKX2%2bsNAvJbJOXvnh0%2bfhUdH%2bgb49g4O3nNyPHb0ryo4eYIaTleLAFky0NcyNdG3tDABkvO2VnExMRAhDpPNZjAlpmfXYE3NrM4tbAFARXVDbGJcFDEqkQqBIZHpiRR6EkiHGxI9kcGmMtlUeAmJpzPJcAOzKD0rlZuVAmCcNBYSsMhgOovKTmUxWJSCkmImJ%2bX2nRvefj4Xz9mYKUraqMpYyx0JdXmYWzdhae9jfe3pldvuj72T7O8%2bCokM8w3ya%2bvo8A8OOvo3CUUFWQJeSQ2P09fTMDDQMjbSNTMzsLIyRW5MDSLDwricVCaVJoGph8y8GVvMyMkF6fFIZkgUVB/YnEghUgCDmYQAJFNZHBoNqQm4S6YjHyAz2TR2CgMsh80BGBKS4pIoCXQ2HSFn0uqa2109nkVEhTk%2beGCqqmCFk7yqLpWdV%2bvgEnvJweXKHfdQcrFfXJaXf4h3gH9weEhZZUVMfPzxo3%2bRk5UiqCqpKCtqQZCgE1AAC3MjU2M9IwMtczNDfx8fDpMlgXnfwR%2bgMulxSXFUJpXKotCTYdJT6CwS%2bEqixiMA9EQqPQleQgVQZYAHH6BgVyryEopDh06A1JGpiVABeCckPKixtTMiOtLP39v5%2bTNrA10jqSMPzls9D6CbnX943z3WLzYrs%2bpNLKskr6CQSCYHhQfn8PKoLOaJX47ISkuqqSiqKMsTCMp6uppGhjpgvIWFkZGhtqGeBrw0NzcKCwyUGJ8UllXWJlKTYMIkoy6y0KAj7jISqQzQCmkhUWgJMIjgfSrkipZIPQBAC0Uh05LAeLgyktH6MCBjUB9qZHQor6iYnc718HR95vbcxtZW7eSR2zYW956G2j8M9orMTCnpKe9coGTU1DU01re0%2b4eGcDO5KRlcydO/wKaGV1ZQUVbA43Ha2upQBGhiSwtj0K2rhTc20DIxM7h43loiPTsTLGenJ6dw2SncZE46C4IOKkmgGOYNhQiiaSwShZFEpiZAbKB9YSJRkAih3jNIGEAcZC8pDjYK%2bAlAmJBETKIkxhCjo%2bNi84pKn7k9dXV3vXbTQVla%2bp7j87vPol0CGMSUutpXoobedTavqa2zc3J2oaiikkwnZ%2bXny8mekT5zCo%2bTx6soqqoqaWkRDAy0TZAKGFtbmRroaepoqsJLCJJEchqTm5OemceFQwE7ncVOY1JZZBiUCaQ4WEkUZPhgC5IDCwYowgD34D0sBuI3YETFhMcSoyKiQulMAKPCywQSEaIfFhFa09Dy9LlzYHDA46dPrjs4PfaK9wxPC6GUcsv7%2beMfmge2uCVtA0PDY1PT0/MLWfl5%2bcUlOJy81JmTqjh5NVUlANDUUtOHYWqib2FpAgDmZgaaBJwh%2bo5ERk56Rh6Xm5OWkZsOFYDJCA1KTIyJjgtPJMclUePBTqRfkfAg9scDGJkIliPeI9KRGygFDNDQ8KDwqJC4%2bGiYqvGJseGRIZA6eL%2bqtvGF9wu48fb1eu7p/9A9Ni6lIS6ltqhpamTxn00Dm7kVHRPTUxMzc7MLizWNja1d3SoqigAAk1Qdj4NBBBUAAGOYpFamMIiAQUdLTVNDFfY4iZyCLG5uelp2alZ%2bBuxKIBTiQaLDFhYUHRcBIwgWEmukUymJ1AQisosRESomCToBblBCSlRshI%2bfF6iEIgAeHChgw4aahEUE1dQ3hkaGh4QFwBnkicuzGw986PmvqNkt1XzB9Np/1x9InTcAAADfSURBVLxaKahqFwgW5hYFEzOzBaXF/N5%2bPF5ZWuoUVEBDTZlAUNHWUcciZGVtBsvGxgyaGK%2bioK2lJpFTmJ2WyeFmp2YXZKWksyDroJKWTCYmRPsH%2bsTFR0H0kVaGCkC0SHFx6DaMRIuBRAhqkoRudmC550v34NAAYID8wGyFYQoMgcG%2bLW3tJDrNzcMlOi7K0/vFrQcenNJBFq%2brZXBjaed/yjoWKxr5omXhkmi5Z2iIV1w48GYMIiQnI6mqrKCprqKpideB/dhI19TM0NrG/KytpTUcxC1N4E9VVRT%2bPzbiUw29GeqqAAAAAElFTkSuQmCC' /%3e%3c/svg%3e"},"path":"/authors/justin-yoo/"}]}}]}},"context":{"recordId":"c2a1207d65bf8c3d10c6868a0ad39f13","tags":["azure-functions","azure-functions-proxy","openapi","backward-compatibility"]}}